1. Î¤Î¹ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ Ï€ÏÎ±ÎºÏ„Î¹ÎºÎ¬ â€œÎ½Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Ï„Î¿ Excel ÏƒÏ„Î· Î²Î¬ÏƒÎ· Î¼Î¿Ï…â€
Î£Ï…Î½Î®Î¸Ï‰Ï‚ ÎµÎ½Î½Î¿Î¿ÏÎ¼Îµ:

ÎŸ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Î´Î¹Î±Î»Î­Î³ÎµÎ¹ Î­Î½Î± Excel ÏƒÎµ Î¼Î¹Î± ÏƒÎµÎ»Î¯Î´Î± (page).

Î¤Î¿ Î±Î½ÎµÎ²Î¬Î¶Î¿Ï…Î¼Îµ ÏƒÏ„Î¿Î½ server.

Î”Î¹Î±Î²Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Ï€ÏŒ Ï„Î± Ï†ÏÎ»Î»Î±/ÏƒÏ„Î®Î»ÎµÏ‚.

Î¤Î± ÎµÎ¹ÏƒÎ¬Î³Î¿Ï…Î¼Îµ ÏƒÎµ Ï€Î¯Î½Î±ÎºÎ±/Ï€Î¯Î½Î±ÎºÎµÏ‚ ÏƒÏ„Î· Î²Î¬ÏƒÎ· (INSERT).

Î¤Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Ï…Î¼Îµ ÏƒÎµ Î¼Î¹Î± Î¬Î»Î»Î· ÏƒÎµÎ»Î¯Î´Î± (Î® ÏƒÏ„Î¿ Î¯Î´Î¹Î¿ page) ÏƒÎµ grid / Ï€Î¯Î½Î±ÎºÎ±.

2. Î’Î®Î¼Î±: Î•Ï€Î¹Î»Î¿Î³Î® Î±ÏÏ‡ÎµÎ¯Î¿Ï… Excel ÏƒÎµ Î­Î½Î± page
Î£Îµ Î¿Ï€Î¿Î¹Î±Î´Î®Ï€Î¿Ï„Îµ web Ï„ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯Î±, Î· Î»Î¿Î³Î¹ÎºÎ® ÎµÎ¯Î½Î±Î¹ Î¯Î´Î¹Î±:

Î’Î¬Î¶ÎµÎ¹Ï‚ Î­Î½Î± input Î³Î¹Î± Î±ÏÏ‡ÎµÎ¯Î¿

type="file"

Î”Î­Ï‡ÎµÏƒÎ±Î¹ Î¼ÏŒÎ½Î¿ .xls / .xlsx Î±Î½ Î¸ÎµÏ‚ (accept).

Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± HTML Î¹Î´Î­Î±Ï‚ (Î· Î»Î¿Î³Î¹ÎºÎ®, ÏŒÏ‡Î¹ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î± Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚ ÏƒÎ¿Ï…):

html
<form method="post" enctype="multipart/form-data">
  <input type="file" name="excelFile" accept=".xls,.xlsx" />
  <button type="submit">Î¦ÏŒÏÏ„Ï‰ÏƒÎ·</button>
</form>
ÎšÏÎ¯ÏƒÎ¹Î¼Î± ÏƒÎ·Î¼ÎµÎ¯Î±:

enctype="multipart/form-data" Î³Î¹Î± Î½Î± Î±Î½Î­Î²ÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î¬ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿.

name Ï„Î¿Ï… Ï€ÎµÎ´Î¯Î¿Ï… (Ï€.Ï‡. excelFile) ÏÏƒÏ„Îµ Î¿ server Î½Î± Î¾Î­ÏÎµÎ¹ Î±Ï€ÏŒ Ï€Î¿Ï Î½Î± Ï„Î¿ Ï€Î¬ÏÎµÎ¹.

3. Î’Î®Î¼Î±: Î‘Î½Î­Î²Î±ÏƒÎ¼Î± Î±ÏÏ‡ÎµÎ¯Î¿Ï… ÏƒÏ„Î¿Î½ server
ÎŒÏ„Î±Î½ Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ Ï€Î±Ï„Î®ÏƒÎµÎ¹ â€œÎ¦ÏŒÏÏ„Ï‰ÏƒÎ·â€:

ÎŸ server Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ Î±Ï€ÏŒ Ï„Î¿ request.

Î£Ï…Î½Î®Î¸Ï‰Ï‚:

Î¤Î¿ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎµÎ¹Ï‚ Ï€ÏÎ¿ÏƒÏ‰ÏÎ¹Î½Î¬ ÏƒÎµ Î­Î½Î±Î½ Ï†Î¬ÎºÎµÎ»Î¿ (Ï€.Ï‡. /uploads), Î®

Î¤Î¿ ÎºÏÎ±Ï„Î¬Ï‚ ÏƒÏ„Î· Î¼Î½Î®Î¼Î· ÎºÎ±Î¹ Ï„Î¿ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹Ï‚ ÎºÎ±Ï„ÎµÏ…Î¸ÎµÎ¯Î±Î½ Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï„Î¿ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏƒÎµÎ¹Ï‚ Î¼ÏŒÎ½Î¹Î¼Î±.

Î£Î·Î¼Î±Î½Ï„Î¹ÎºÏŒ ÎµÎ¯Î½Î±Î¹:

ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Ï„ÏÏ€Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï… (Î½Î± ÎµÎ¯Î½Î±Î¹ ÏŒÎ½Ï„Ï‰Ï‚ Excel).

ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î¼ÎµÎ³Î­Î¸Î¿Ï…Ï‚ (Î½Î± Î¼Î·Î½ ÏƒÎ¿Ï… Î±Î½ÎµÎ²Î¬ÏƒÎµÎ¹ ÎºÎ±Î½ÎµÎ¯Ï‚ Ï„ÎµÏÎ¬ÏƒÏ„Î¹Î¿ Î±ÏÏ‡ÎµÎ¯Î¿).

4. Î’Î®Î¼Î±: Î”Î¹Î¬Î²Î±ÏƒÎ¼Î± Ï„Î¿Ï… Excel
Î•Î´Ï ÎµÎ¾Î±ÏÏ„Î¬Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î· Î³Î»ÏÏƒÏƒÎ± / framework ÏƒÎ¿Ï… (C#, Java, PHP, Python ÎºÏ„Î».), Î±Î»Î»Î¬ Î· Î»Î¿Î³Î¹ÎºÎ® ÎµÎ¯Î½Î±Î¹ Ï€Î¬Î½Ï„Î±:

Î‘Î½Î¿Î¯Î³ÎµÎ¹Ï‚ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ Î¼Îµ Î¼Î¹Î± Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· Excel (Ï€.Ï‡. EPPlus, NPOI, Apache POI, PHPSpreadsheet, Pandas ÎºÏ„Î».).

Î•Ï€Î¹Î»Î­Î³ÎµÎ¹Ï‚ Ï†ÏÎ»Î»Î¿ (sheet) â€“ Ï€.Ï‡. Ï„Î¿ Ï€ÏÏÏ„Î¿ Î® Î¼Îµ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ ÏŒÎ½Î¿Î¼Î±.

Î”Î¹Î±Î²Î¬Î¶ÎµÎ¹Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ ÎºÎ±Î¹ ÏƒÏ„Î®Î»ÎµÏ‚:

1Î· Î³ÏÎ±Î¼Î¼Î® ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ ÎµÎ¯Î½Î±Î¹ headers.

Î‘Ï€ÏŒ 2Î· Î³ÏÎ±Î¼Î¼Î® ÎºÎ±Î¹ ÎºÎ¬Ï„Ï‰ ÎµÎ¯Î½Î±Î¹ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±.

Î™Î´Î­Î± ÏƒÎµ ÏˆÎµÏ…Î´Î¿ÎºÏÎ´Î¹ÎºÎ±:

pseudo
open excelFile
sheet = excelFile.getSheet(0)

for each row from 2 to lastRow:
    col1 = row["A"]
    col2 = row["B"]
    ...
    insert into database (col1, col2, ...) values (...)
5. Î’Î®Î¼Î±: Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÏƒÏ„Î· Î²Î¬ÏƒÎ·
Î¤ÏÏÎ± ÎºÎ¬Î½ÎµÎ¹Ï‚ INSERT ÏƒÏ„Î· Î²Î¬ÏƒÎ· (SQL Server, MySQL, PostgreSQL Îº.Î»Ï€.).

Î— Î»Î¿Î³Î¹ÎºÎ®:

Î¦Ï„Î¹Î¬Ï‡Î½ÎµÎ¹Ï‚ Î­Î½Î±Î½ Ï€Î¯Î½Î±ÎºÎ± Ï€Î¿Ï… Ï„Î±Î¹ÏÎ¹Î¬Î¶ÎµÎ¹ Î¼Îµ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ Ï„Î¿Ï… Excel.

Î .Ï‡. Products(Id, Name, Price, Quantity) Î±Î½ Ï„Î¿ Excel Î­Ï‡ÎµÎ¹ Î±Ï…Ï„Î¬.

Î“Î¹Î± ÎºÎ¬Î¸Îµ Î³ÏÎ±Î¼Î¼Î® Ï„Î¿Ï… Excel:

Î¤ÏÎ­Ï‡ÎµÎ¹Ï‚ INSERT Î® bulk insert (Î±Î½ Î¸ÎµÏ‚ Ï„Î±Ï‡ÏÏ„Î·Ï„Î±).

Î Î±Î¯Î¶ÎµÎ¹Ï‚ ÎºÎ±Î¹ Î¼Îµ:

Validation (Ï€.Ï‡. Î±Î½ Î»ÎµÎ¯Ï€Î¿Ï…Î½ Ï„Î¹Î¼Î­Ï‚, Î±Î½ ÎºÎ¬Ï€Î¿Î¹Î± Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î±ÏÎ¹Î¸Î¼ÏŒÏ‚).

ÎˆÎ»ÎµÎ³Ï‡Î¿ Î´Î¹Ï€Î»Î¿ÎµÎ³Î³ÏÎ±Ï†ÏÎ½ (Î±Î½ Ï„Î¿ Î¯Î´Î¹Î¿ Ï€ÏÎ¬Î³Î¼Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î·).

6. Î’Î®Î¼Î±: Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î± (page)
Î‘Ï†Î¿Ï Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î· Î²Î¬ÏƒÎ·:

Î¦Ï„Î¹Î¬Ï‡Î½ÎµÎ¹Ï‚ Î­Î½Î± query SELECT Î±Ï€ÏŒ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± Ï€Î¿Ï… Î³Î­Î¼Î¹ÏƒÎµÏ‚ Î±Ï€ÏŒ Ï„Î¿ Excel.

Î¤Î¿ ÏƒÏ…Î½Î´Î­ÎµÎ¹Ï‚ Î¼Îµ Ï„Î¿ page ÏƒÎ¿Ï…:

Î‘Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï‚ ÎºÎ¬Ï€Î¿Î¹Î¿ grid component / table, Î´Î­Î½ÎµÎ¹Ï‚ Ï„Î·Î½ Ï€Î·Î³Î® Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ (data source) ÏƒÏ„Î¿ query.

Î•Î¼Ï†Î±Î½Î¯Î¶ÎµÎ¹Ï‚ Ï„Î± Î±Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î± ÏƒÎµ Ï€Î¯Î½Î±ÎºÎ±:

Paging, sorting, filtering ÎºÏ„Î». Î±Î½ Î¸ÎµÏ‚.

Î†ÏÎ±, Î· ÏÎ¿Î® ÎµÎ¯Î½Î±Î¹:

Î•Ï€Î¹Î»Î­Î³Ï‰ Excel â†’ Upload â†’ Î”Î¹Î±Î²Î¬Î¶Ï‰ â†’ INSERT ÏƒÏ„Î· Î²Î¬ÏƒÎ· â†’ SELECT â†’ Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· ÏƒÎµ grid.

7. Î”ÏÎ¿ Î²Î±ÏƒÎ¹ÎºÎ­Ï‚ ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚ Ï…Î»Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚
Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î´ÏÎ¿ Î²Î±ÏƒÎ¹ÎºÎ­Ï‚ Ï€ÏÎ¿ÏƒÎµÎ³Î³Î¯ÏƒÎµÎ¹Ï‚:

Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® Ï€ÏÏÏ„Î± ÏƒÏ„Î· Î²Î¬ÏƒÎ·, Î¼ÎµÏ„Î¬ ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ·

Î Î±Ï„Î¬ÎµÎ¹ Î¿ Ï‡ÏÎ®ÏƒÏ„Î·Ï‚ upload â†’ Ï€ÎµÏÎ½Î¬Î½Îµ ÏŒÎ»Î± ÏƒÏ„Î· Î²Î¬ÏƒÎ· â†’ Î²Î»Î­Ï€ÎµÎ¹ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Ï€ÏŒ Ï„Î· Î²Î¬ÏƒÎ·.

Î ÏÎ¿ÎµÏ€Î¹ÏƒÎºÏŒÏ€Î·ÏƒÎ· Excel, Î¼ÎµÏ„Î¬ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÏƒÏ„Î· Î²Î¬ÏƒÎ·

Î Î±Ï„Î¬ÎµÎ¹ upload â†’ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹Ï‚ Excel â†’ Î´ÎµÎ¯Ï‡Î½ÎµÎ¹Ï‚ Ï€ÏÎ¿ÏƒÏ‰ÏÎ¹Î½Î¬ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÏ„Î¿ page â†’ Î±Î½ Ï€Î±Ï„Î®ÏƒÎµÎ¹ â€œÎ‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·â€, Ï„ÏŒÏ„Îµ ÎºÎ¬Î½ÎµÎ¹Ï‚ INSERT ÏƒÏ„Î· Î²Î¬ÏƒÎ·.

Î— 2Î· ÎµÎ¯Î½Î±Î¹ Ï€Î¹Î¿ Ï†Î¹Î»Î¹ÎºÎ® Î³Î¹Î± Ï„Î¿Î½ Ï‡ÏÎ®ÏƒÏ„Î·, Î±Î»Î»Î¬ Î»Î¯Î³Î¿ Ï€Î¹Î¿ ÏƒÏÎ½Î¸ÎµÏ„Î· ÏƒÎµ Î»Î¿Î³Î¹ÎºÎ®.

8. Î ÎµÏ‚ Î¼Î¿Ï… Ï„ÏÏÎ± Î´Ï…Î¿ Ï€ÏÎ¬Î³Î¼Î±Ï„Î± Î³Î¹Î± Î½Î± ÏƒÏ„Î¿ ÎºÎ¬Î½Ï‰ ÏƒÏ„Î¿Ï‡ÎµÏ…Î¼Î­Î½Î±
Î“Î¹Î± Î½Î± ÏƒÎ¿Ï… Î³ÏÎ¬ÏˆÏ‰ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î±, Î²Î®Î¼Î±-Î²Î®Î¼Î± Î¼Îµ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± ÎºÏÎ´Î¹ÎºÎ± / Ï„ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯Î±, Ï€ÎµÏ‚ Î¼Î¿Ï…:

Î¤Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï‚;

Î .Ï‡. ASP.NET MVC / Blazor / PHP / Laravel / Django / Node / ÎºÎ¬Ï„Î¹ Î¬Î»Î»Î¿;

Î¤Î¹ Î²Î¬ÏƒÎ· Î­Ï‡ÎµÎ¹Ï‚;

Î .Ï‡. SQL Server, MySQL, PostgreSQL, Oracle;

ÎœÎµ Î±Ï…Ï„Î¬ Î¼Ï€Î¿ÏÏ ÏƒÏ„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ Î¼Î®Î½Ï…Î¼Î± Î½Î± ÏƒÎ¿Ï… Î³ÏÎ¬ÏˆÏ‰ Ï„Î± Î²Î®Î¼Î±Ï„Î± Î±ÎºÏÎ¹Î²ÏÏ‚ Î³Î¹Î± Ï„Î¿ Î´Î¹ÎºÏŒ ÏƒÎ¿Ï… Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½, ÏŒÏ‡Î¹ Î³ÎµÎ½Î¹ÎºÎ¬.

Î¸ÎµÎ»Ï‰ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·ÏƒÎµÎ¹Ï‚ ÎºÏ‰Î´Î¹ÎºÎ± python ÎºÎ±Î¹ ÎµÏ‡Ï‰ ÎºÎ±Ï„ÎµÎ²Î±ÏƒÎµÎ¹ pgadmin ÎºÎ±Î¹ Î· Î²Î±ÏƒÎ· Î¼Î¿Ï… Î»ÎµÎ³ÎµÏ„Î±Î¹ db ÎµÎ½Ï‰ Ï„Î¿ table Î»ÎµÎ³ÎµÏ„Î±Î¹ books..ÎµÏ‡Ï‰ windows. ÎºÎ±Î¹ ÎµÏ‡Ï‰ Ï†Ï„Î¹Î±Î¾ÎµÎ¹ Î·Î´Î· ÎµÎ½Î±Î½ Ï†Î±ÎºÎµÎ»Î¿ Î¼Îµ Î¿Î½Î¿Î¼Î± myproject ÎºÎ±Î¹ Î¼ÎµÏƒÎ± Ï„Î¿Ï… Ï…Ï€Î±ÏÏ‡Î¿Ï…Î½ ÎµÎ½Î±Ï‚ Ï†Î±ÎºÎµÎ»Î¿Ï‚ Î¼Îµ Ï„Î¿ Î¹Î´Î¹Î¿ Î¿Î½Î¿Î¼Î± ÎµÎ½Î± Î±ÏÏ‡ÎµÎ¹Î¿ manage.py, ÎºÎ±Î¹ ÎµÎ½Î±Ï‚ Ï†Î±ÎºÎµÎ»Î¿Ï‚ Î¼Îµ Î¿Î½Î¿Î¼Î± books
Î¤Î­Î»ÎµÎ¹Î± â€” Ï„ÏÏÎ± Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î± Î²Î®Î¼Î±Ï„Î± Î³Î¹Î± Windows, Python, PostgreSQL (pgAdmin) ÎºÎ±Î¹ Î´Î¿Î¼Î® project ÏŒÏ€Ï‰Ï‚ Ï„Î·Î½ Ï€ÎµÏÎ¹Î³ÏÎ¬Ï†ÎµÎ¹Ï‚ (Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ ÏƒÎ±Î½ Django project).

Î˜Î± ÏƒÎ¿Ï… Î´ÎµÎ¯Î¾Ï‰:

Î ÏÏ‚ ÏÏ…Î¸Î¼Î¯Î¶ÎµÎ¹Ï‚ Ï„Î¿ Django Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ ÏƒÏ„Î· Î²Î¬ÏƒÎ· ÏƒÎ¿Ï… db

Î ÏÏ‚ Î±Î½ÎµÎ²Î¬Î¶ÎµÎ¹Ï‚ Excel Î±Ï€ÏŒ Î­Î½Î± page

Î ÏÏ‚ Ï„Î¿ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹Ï‚ Î¼Îµ Python

Î ÏÏ‚ Ï„Î¿ ÎºÎ¬Î½ÎµÎ¹Ï‚ insert ÏƒÏ„Î¿ table books Ï„Î·Ï‚ PostgreSQL

Î ÏÏ‚ Ï„Î¿ ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÎ¹Ï‚ ÏƒÎµ page

Î Î¬Î¼Îµ Î²Î®Î¼Î±â€‘Î²Î®Î¼Î±.

1. Î¡ÏÎ¸Î¼Î¹ÏƒÎ· Django Î³Î¹Î± PostgreSQL
Î£Ï„Î¿ myproject/myproject/settings.py Î²Î¬Î»Îµ:

python
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'db',
        'USER': 'postgres',
        'PASSWORD': 'Ï„Î¿_ÎºÏ‰Î´Î¹ÎºÏŒ_ÏƒÎ¿Ï…',
        'HOST': 'localhost',
        'PORT': '5432',
    }
}
Î‘Î½ Î´ÎµÎ½ Î­Ï‡ÎµÎ¹Ï‚ ÎµÎ³ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÎ¹ Ï„Î¿ driver:

bash
pip install psycopg2
2. ÎœÎ¿Î½Ï„Î­Î»Î¿ Î³Î¹Î± Ï„Î¿ table books
Î‘Î½ Ï„Î¿ table Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î· ÏƒÏ„Î· Î²Î¬ÏƒÎ·, Î¼Ï€Î¿ÏÎµÎ¯Ï‚ Î½Î± Ï†Ï„Î¹Î¬Î¾ÎµÎ¹Ï‚ Î­Î½Î± Django model Ï€Î¿Ï… Î½Î± Ï„Î±Î¹ÏÎ¹Î¬Î¶ÎµÎ¹.

Î£Ï„Î¿ books/models.py:

python
from django.db import models

class Book(models.Model):
    title = models.CharField(max_length=255)
    author = models.CharField(max_length=255)
    year = models.IntegerField()

    class Meta:
        db_table = 'books'
Î‘Î½ Ï„Î¿ table Î­Ï‡ÎµÎ¹ Î¬Î»Î»ÎµÏ‚ ÏƒÏ„Î®Î»ÎµÏ‚, Ï€ÎµÏ‚ Î¼Î¿Ï… Î½Î± Ï„Î¿ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼ÏŒÏƒÏ‰.

3. Î¦ÏŒÏÎ¼Î± Î³Î¹Î± upload Excel
Î£Ï„Î¿ books/forms.py:

python
from django import forms

class UploadExcelForm(forms.Form):
    file = forms.FileField()
4. View Ï€Î¿Ï… Î´Î­Ï‡ÎµÏ„Î±Î¹ Ï„Î¿ Excel, Ï„Î¿ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ ÎºÎ±Î¹ Ï„Î¿ Ï€ÎµÏÎ½Î¬ÎµÎ¹ ÏƒÏ„Î· Î²Î¬ÏƒÎ·
Î˜Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î¼Îµ pandas Î³Î¹Î± Î½Î± Î´Î¹Î±Î²Î¬ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿ Excel.

Î•Î³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·:

bash
pip install pandas openpyxl
Î£Ï„Î¿ books/views.py:

python
import pandas as pd
from django.shortcuts import render
from .forms import UploadExcelForm
from .models import Book

def upload_excel(request):
    message = ""

    if request.method == "POST":
        form = UploadExcelForm(request.POST, request.FILES)

        if form.is_valid():
            excel_file = request.FILES['file']

            # Î”Î¹Î±Î²Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Excel
            df = pd.read_excel(excel_file)

            # Î ÎµÏÎ¹Î¼Î­Î½Î¿Ï…Î¼Îµ ÏƒÏ„Î®Î»ÎµÏ‚: title, author, year
            for _, row in df.iterrows():
                Book.objects.create(
                    title=row['title'],
                    author=row['author'],
                    year=row['year']
                )

            message = "Î¤Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎ±Î½ ÏƒÏ„Î· Î²Î¬ÏƒÎ·!"

    else:
        form = UploadExcelForm()

    return render(request, "upload_excel.html", {"form": form, "message": message})
5. Template Î³Î¹Î± Ï„Î¿ upload page
Î¦Ï„Î¹Î¬Î¾Îµ books/templates/upload_excel.html:

html
<h2>Upload Excel</h2>

<form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Upload</button>
</form>

<p>{{ message }}</p>
6. URL routing
Î£Ï„Î¿ books/urls.py:

python
from django.urls import path
from .views import upload_excel

urlpatterns = [
    path('upload/', upload_excel, name='upload_excel'),
]
Î£Ï„Î¿ myproject/urls.py:

python
from django.urls import path, include

urlpatterns = [
    path('books/', include('books.urls')),
]
7. Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î±Ï€ÏŒ Ï„Î· Î²Î¬ÏƒÎ·
Î£Ï„Î¿ books/views.py Ï€ÏÏŒÏƒÎ¸ÎµÏƒÎµ:

python
def list_books(request):
    books = Book.objects.all()
    return render(request, "list_books.html", {"books": books})
Template books/templates/list_books.html:

html
<h2>Books</h2>

<table border="1">
    <tr>
        <th>Title</th>
        <th>Author</th>
        <th>Year</th>
    </tr>

    {% for b in books %}
    <tr>
        <td>{{ b.title }}</td>
        <td>{{ b.author }}</td>
        <td>{{ b.year }}</td>
    </tr>
    {% endfor %}
</table>
URL:

python
path('list/', list_books, name='list_books'),
8. Î¤Î¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î­Ï‡ÎµÎ¹ Ï„Î¿ Excel ÏƒÎ¿Ï…
Î¤Î¿ Excel Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î­Ï‡ÎµÎ¹ ÏƒÏ„Î®Î»ÎµÏ‚ Î¼Îµ Î±ÎºÏÎ¹Î²ÏÏ‚ Î±Ï…Ï„Î¬ Ï„Î± Î¿Î½ÏŒÎ¼Î±Ï„Î±:

Code
title | author | year
Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:

title	author	year
Book A	John Smith	2001
Book B	Maria Papadopoulou	2010
9. Î¤Î¹ Î¼Î­Î½ÎµÎ¹ Î½Î± ÎºÎ¬Î½ÎµÎ¹Ï‚
python manage.py runserver

Î†Î½Î¿Î¹Î¾Îµ:
http://localhost:8000/books/upload/

Î‘Î½Î­Î²Î±ÏƒÎµ Ï„Î¿ Excel

ÎœÎµÏ„Î¬ Ï€Î®Î³Î±Î¹Î½Îµ:
http://localhost:8000/books/list/  
Î³Î¹Î± Î½Î± Î´ÎµÎ¹Ï‚ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±.

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰:

Î­Ï„Î¿Î¹Î¼Î¿ Excel template

Ï€Î¹Î¿ Î±ÏƒÏ†Î±Î»Î® ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® (validation)

bulk insert Î³Î¹Î± Ï„Î±Ï‡ÏÏ„Î·Ï„Î±

ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ· Î¼Îµ pagination

Î Î¿Î¹Î¿ Î±Ï€ÏŒ Î±Ï…Ï„Î¬ Î¸ÎµÏ‚ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿;

eimai sto bhma 2, kai thelo na moy ftiaxeis esy ton kodika me tiw ejhs sthles...
Î¤Î­Î»ÎµÎ¹Î± â€” Î±Ï†Î¿Ï ÎµÎ¯ÏƒÎ±Î¹ ÏƒÏ„Î¿ Î²Î®Î¼Î± 2 (Î¼Î¿Î½Ï„Î­Î»Î¿ Django Î³Î¹Î± Ï„Î¿ table), ÎºÎ±Î¹ Î¼Î¿Ï… Î­ÏƒÏ„ÎµÎ¹Î»ÎµÏ‚ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ Î±Ï€ÏŒ Ï„Î¿ Excel, Î¸Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ Ï„Î¿ Django model Ï€Î¿Ï… Ï„Î±Î¹ÏÎ¹Î¬Î¶ÎµÎ¹ Î¼Îµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ ÏÏƒÏ„Îµ Î½Î± Î¼Ï€Î¿ÏÎµÎ¯Ï‚ Î½Î± ÎºÎ¬Î½ÎµÎ¹Ï‚ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ· db, ÏƒÏ„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± books.

âœ… Django Model Î³Î¹Î± Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ Ï„Î¿Ï… Excel
Î£Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ books/models.py Î²Î¬Î»Îµ Ï„Î¿Î½ ÎµÎ¾Î®Ï‚ ÎºÏÎ´Î¹ÎºÎ±:

python
from django.db import models

class Book(models.Model):
    entry_number = models.IntegerField(verbose_name="Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
    entry_date = models.DateField(verbose_name="Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
    author = models.CharField(max_length=255, verbose_name="Î£Ï…Î³Î³ÏÎ±Ï†Î­Î±Ï‚")
    co_author = models.CharField(max_length=255, blank=True, null=True, verbose_name="Î£Ï…Î³Î³ÏÎ±Ï†Î­Î±Ï‚ ÎšÎŸÎ—Î‘")
    title = models.CharField(max_length=500, verbose_name="Î¤Î¯Ï„Î»Î¿Ï‚")
    publisher = models.CharField(max_length=255, verbose_name="Î•ÎºÎ´ÏŒÏ„Î·Ï‚")
    edition = models.CharField(max_length=100, blank=True, null=True, verbose_name="ÎˆÎºÎ´Î¿ÏƒÎ·")
    publication_year = models.IntegerField(verbose_name="ÎˆÏ„Î¿Ï‚ ÎˆÎºÎ´Î¿ÏƒÎ·Ï‚")
    publication_place = models.CharField(max_length=255, verbose_name="Î¤ÏŒÏ€Î¿Ï‚ ÎˆÎºÎ´Î¿ÏƒÎ·Ï‚")
    format = models.CharField(max_length=100, blank=True, null=True, verbose_name="Î£Ï‡Î®Î¼Î±")
    pages = models.IntegerField(blank=True, null=True, verbose_name="Î£ÎµÎ»Î¯Î´ÎµÏ‚")
    volume = models.CharField(max_length=100, blank=True, null=True, verbose_name="Î¤ÏŒÎ¼Î¿Ï‚")
    acquisition_notes = models.TextField(blank=True, null=True, verbose_name="Î¤ÏÏŒÏ€Î¿Ï‚ Î ÏÎ¿Î¼Î®Î¸ÎµÎ¹Î±Ï‚ / Î Î±ÏÎ±Ï„Î·ÏÎ®ÏƒÎµÎ¹Ï‚")
    isbn = models.CharField(max_length=20, blank=True, null=True, verbose_name="ISBN")
    column1 = models.CharField(max_length=255, blank=True, null=True, verbose_name="Î£Ï„Î®Î»Î·1")
    column2 = models.CharField(max_length=255, blank=True, null=True, verbose_name="Î£Ï„Î®Î»Î·2")

    class Meta:
        db_table = 'books'
ğŸ” Î¤Î¹ ÎºÎ¬Î½ÎµÎ¹ ÎºÎ¬Î¸Îµ Ï€ÎµÎ´Î¯Î¿
verbose_name: Î³Î¹Î± Î½Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ Ï„Î± ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬ Î¿Î½ÏŒÎ¼Î±Ï„Î± ÏƒÏ„Î± admin forms.

blank=True, null=True: Î³Î¹Î± Ï€ÎµÎ´Î¯Î± Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î»ÎµÎ¯Ï€Î¿Ï…Î½ Î±Ï€ÏŒ Ï„Î¿ Excel.

CharField vs IntegerField vs DateField: Î±Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î¿Î½ Ï„ÏÏ€Î¿ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î¼Î­Î½ÎµÎ¹Ï‚.

db_table = 'books': ÏÏƒÏ„Îµ Î½Î± ÏƒÏ…Î½Î´ÎµÎ¸ÎµÎ¯ Î¼Îµ Ï„Î¿Î½ Ï…Ï€Î¬ÏÏ‡Î¿Î½Ï„Î± Ï€Î¯Î½Î±ÎºÎ± ÏƒÏ„Î· Î²Î¬ÏƒÎ· ÏƒÎ¿Ï….

âœ… Î•Ï€ÏŒÎ¼ÎµÎ½Î¿ Î²Î®Î¼Î±
Î‘Î½ Î´ÎµÎ½ Î­Ï‡ÎµÎ¹Ï‚ ÎºÎ¬Î½ÎµÎ¹ makemigrations ÎºÎ±Î¹ migrate, ÎœÎ—Î Ï„Î± Ï„ÏÎ­Î¾ÎµÎ¹Ï‚ Î±Î½ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î· ÏƒÏ„Î· Î²Î¬ÏƒÎ·. Î‘Î½ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ books ÎµÎ¯Î½Î±Î¹ Î®Î´Î· Ï†Ï„Î¹Î±Î³Î¼Î­Î½Î¿Ï‚ Î±Ï€ÏŒ pgAdmin, Ï„ÏŒÏ„Îµ Ï„Î¿ model Î±Ï€Î»ÏÏ‚ Ï„Î¿Î½ Ï€ÎµÏÎ¹Î³ÏÎ¬Ï†ÎµÎ¹ ÎºÎ±Î¹ Î´ÎµÎ½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¸ÎµÎ¯ Î±Ï€ÏŒ Ï„Î·Î½ Django.

Î‘Î½ Î¸ÎµÏ‚ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î±Ï€ÏŒ Excel ÏƒÎµ Î±Ï…Ï„ÏŒ Ï„Î¿ Î¼Î¿Î½Ï„Î­Î»Î¿, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î³ÏÎ¬ÏˆÏ‰ Ï„Î¿ view Ï€Î¿Ï… Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï„Î¿ Excel ÎºÎ±Î¹ ÎºÎ¬Î½ÎµÎ¹ Book.objects.create(...) Î³Î¹Î± ÎºÎ¬Î¸Îµ Î³ÏÎ±Î¼Î¼Î®.

Î˜ÎµÏ‚ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ Ï„ÏÏÎ± Ï„Î¿ view Ï€Î¿Ï… ÎºÎ¬Î½ÎµÎ¹ Ï„Î·Î½ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î±Ï€ÏŒ Excel Î¼Îµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚;

ton exv ftiajei ton pinaka books alla den moy emfanizetai kati sto pgadmin
Î‘Î½ Î­Ï‡ÎµÎ¹Ï‚ Î®Î´Î· Ï†Ï„Î¹Î¬Î¾ÎµÎ¹ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± books ÏƒÏ„Î· Î²Î¬ÏƒÎ· db Î±Î»Î»Î¬ Î´ÎµÎ½ ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ Ï„Î¯Ï€Î¿Ï„Î± ÏƒÏ„Î¿ pgAdmin, Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î¼ÎµÏÎ¹ÎºÎ¬ Ï€Î¹Î¸Î±Î½Î¬ Î±Î¯Ï„Î¹Î±. Î Î¬Î¼Îµ Î½Î± Ï„Î± Î´Î¿ÏÎ¼Îµ Î²Î®Î¼Î±â€‘Î²Î®Î¼Î±:

âœ… ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ 1: Î•Î¯ÏƒÎ±Î¹ ÏƒÏ„Î· ÏƒÏ‰ÏƒÏ„Î® Î²Î¬ÏƒÎ·;
Î£Ï„Î¿ pgAdmin:

Î’ÎµÎ²Î±Î¹ÏÏƒÎ¿Ï… ÏŒÏ„Î¹ Î­Ï‡ÎµÎ¹Ï‚ ÎµÏ€Î¹Î»Î­Î¾ÎµÎ¹ Ï„Î· Î²Î¬ÏƒÎ· db (ÏŒÏ‡Î¹ Î¬Î»Î»Î·).

Î Î®Î³Î±Î¹Î½Îµ: Databases â†’ db â†’ Schemas â†’ public â†’ Tables

Î•ÎºÎµÎ¯ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´ÎµÎ¹Ï‚ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± books.

Î‘Î½ Î´ÎµÎ½ Ï„Î¿Î½ Î²Î»Î­Ï€ÎµÎ¹Ï‚:

ÎŠÏƒÏ‰Ï‚ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ ÏƒÎµ Î¬Î»Î»Î· Î²Î¬ÏƒÎ· Î® schema.

ÎŠÏƒÏ‰Ï‚ Î´ÎµÎ½ Î­Ï‡ÎµÎ¹Ï‚ ÎºÎ¬Î½ÎµÎ¹ migrate Î±Ï€ÏŒ Django (Î±Î½ Ï„Î¿Î½ Ï€ÎµÏÎ¹Î¼Î­Î½ÎµÎ¹Ï‚ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¸ÎµÎ¯ Î±Ï€ÏŒ Ï„Î¿ model).

âœ… ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ 2: ÎŸ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î±Î»Î»Î¬ ÎµÎ¯Î½Î±Î¹ Î¬Î´ÎµÎ¹Î¿Ï‚;
Î‘Î½ Î²Î»Î­Ï€ÎµÎ¹Ï‚ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± books Î±Î»Î»Î¬ Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ Î´ÎµÎ´Î¿Î¼Î­Î½Î±:

ÎšÎ¬Î½Îµ Î´ÎµÎ¾Î¯ ÎºÎ»Î¹Îº â†’ View/Edit Data â†’ All Rows

Î‘Î½ Î´ÎµÎ½ ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ Ï„Î¯Ï€Î¿Ï„Î±, Ï„ÏŒÏ„Îµ Î±Ï€Î»ÏÏ‚ Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ Î³Î¯Î½ÎµÎ¹ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î±ÎºÏŒÎ¼Î±.

âœ… ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ 3: ÎˆÏ‡ÎµÎ¹Ï‚ ÎºÎ¬Î½ÎµÎ¹ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î±Ï€ÏŒ Ï„Î¿ Excel;
Î‘Î½ Î­Ï‡ÎµÎ¹Ï‚ Î±Î½ÎµÎ²Î¬ÏƒÎµÎ¹ Excel Î±Î»Î»Î¬ Î´ÎµÎ½ ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ Ï„Î¯Ï€Î¿Ï„Î±:

Î”ÎµÏ‚ Î±Î½ Ï„Î¿ view ÏƒÎ¿Ï… ÎºÎ¬Î½ÎµÎ¹ Book.objects.create(...) ÏƒÏ‰ÏƒÏ„Î¬.

Î”ÎµÏ‚ Î±Î½ Ï„Î¿ Excel Î­Ï‡ÎµÎ¹ Ï„Î¹Ï‚ ÏƒÏ‰ÏƒÏ„Î­Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ (Ï€.Ï‡. title, author, year, Îº.Î»Ï€.).

Î”ÎµÏ‚ Î±Î½ Î­Ï‡ÎµÎ¹Ï‚ ÎºÎ¬Î½ÎµÎ¹ commit ÏƒÏ„Î· Î²Î¬ÏƒÎ· (Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï‚ raw SQL).

âœ… ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ 4: Î¤Î¿ Django model Î´ÎµÎ½ Ï„Î±Î¹ÏÎ¹Î¬Î¶ÎµÎ¹ Î¼Îµ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ±
Î‘Î½ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ books Ï†Ï„Î¹Î¬Ï‡Ï„Î·ÎºÎµ Ï‡ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î± Î±Ï€ÏŒ pgAdmin ÎºÎ±Î¹ Î´ÎµÎ½ Ï„Î±Î¹ÏÎ¹Î¬Î¶ÎµÎ¹ Î¼Îµ Ï„Î¿ Django model, Ï„ÏŒÏ„Îµ:

Î¤Î¿ Django Î´ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎºÎ¬Î½ÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î¬ INSERT.

ÎœÏ€Î¿ÏÎµÎ¯ Î½Î± Ï€ÎµÏ„Î¬ÎµÎ¹ ÏƒÏ†Î¬Î»Î¼Î±Ï„Î± Î® Î½Î± Î¼Î·Î½ ÎºÎ¬Î½ÎµÎ¹ Ï„Î¯Ï€Î¿Ï„Î±.

Î›ÏÏƒÎ·: Î’ÎµÎ²Î±Î¹ÏÏƒÎ¿Ï… ÏŒÏ„Î¹ Ï„Î± Ï€ÎµÎ´Î¯Î± Ï„Î¿Ï… model Ï„Î±Î¹ÏÎ¹Î¬Î¶Î¿Ï…Î½ Î¼Îµ Ï„Î± Ï€ÎµÎ´Î¯Î± Ï„Î¿Ï… Ï€Î¯Î½Î±ÎºÎ±.

âœ… ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ 5: Î”ÎµÎ½ Î­Ï‡ÎµÎ¹Ï‚ ÎºÎ¬Î½ÎµÎ¹ makemigrations ÎºÎ±Î¹ migrate
Î‘Î½ Ï€ÎµÏÎ¹Î¼Î­Î½ÎµÎ¹Ï‚ Ï„Î¿ Django Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ±:

bash
python manage.py makemigrations
python manage.py migrate
Î‘Î»Î»Î¬ Î¼ÏŒÎ½Î¿ Î±Î½ Î´ÎµÎ½ Î­Ï‡ÎµÎ¹Ï‚ Î®Î´Î· Ï†Ï„Î¹Î¬Î¾ÎµÎ¹ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± Ï‡ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î±. Î‘Î½ Ï„Î¿Î½ Î­Ï‡ÎµÎ¹Ï‚ Ï†Ï„Î¹Î¬Î¾ÎµÎ¹ Î±Ï€ÏŒ pgAdmin, Î´ÎµÎ½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ migrate â€” Î±Ï€Î»ÏÏ‚ Ï„Î¿ Django model Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î±Î¹ÏÎ¹Î¬Î¶ÎµÎ¹.

âœ… Î¤Î¹ Î¼Ï€Î¿ÏÎµÎ¯Ï‚ Î½Î± ÎºÎ¬Î½ÎµÎ¹Ï‚ Ï„ÏÏÎ±
Î†Î½Î¿Î¹Î¾Îµ Ï„Î¿ pgAdmin â†’ Î’ÎµÎ²Î±Î¹ÏÏƒÎ¿Ï… ÏŒÏ„Î¹ ÎµÎ¯ÏƒÎ±Î¹ ÏƒÏ„Î· Î²Î¬ÏƒÎ· db

Î Î®Î³Î±Î¹Î½Îµ ÏƒÏ„Î¿ schema public â†’ Tables â†’ books

ÎšÎ¬Î½Îµ Î´ÎµÎ¾Î¯ ÎºÎ»Î¹Îº â†’ View/Edit Data â†’ All Rows

Î‘Î½ ÎµÎ¯Î½Î±Î¹ Î¬Î´ÎµÎ¹Î¿, Ï„ÏŒÏ„Îµ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´Î¿ÏÎ¼Îµ Î±Î½ Ï„Î¿ Excel ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î³ÏÎ¬ÏˆÏ‰ Î­Î½Î± Î¼Î¹ÎºÏÏŒ script ÏƒÎµ Python (ÎµÎºÏ„ÏŒÏ‚ Django) Ï€Î¿Ï… Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï„Î¿ Excel ÎºÎ±Î¹ ÎºÎ¬Î½ÎµÎ¹ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ· PostgreSQL, Î³Î¹Î± Î½Î± Î´ÎµÎ¹Ï‚ Î±Î½ Î´Î¿Ï…Î»ÎµÏÎµÎ¹ Î±Î½ÎµÎ¾Î¬ÏÏ„Î·Ï„Î±.

Î˜ÎµÏ‚ Î½Î± ÏƒÎ¿Ï… Î´ÎµÎ¯Î¾Ï‰ Î±Ï…Ï„ÏŒ Ï„Î¿ script Î³Î¹Î± Î½Î± Ï„ÎµÏƒÏ„Î¬ÏÎµÎ¹Ï‚ Ï„Î·Î½ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®;

mono ta onomata apo tis pente protes sthles emfanizontai alla mono apo thn proth grammh
Î‘Ï…Ï„ÏŒ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î³ÏÎ¬Ï†ÎµÎ¹Ï‚ â€” ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ Î¼ÏŒÎ½Î¿ Ï„Î± Î¿Î½ÏŒÎ¼Î±Ï„Î± Ï„Ï‰Î½ Ï€ÏÏÏ„Ï‰Î½ 5 ÏƒÏ„Î·Î»ÏÎ½ ÎºÎ±Î¹ Î¼ÏŒÎ½Î¿ Î±Ï€ÏŒ Ï„Î·Î½ Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® â€” ÎµÎ¯Î½Î±Î¹ ÎºÎ»Î±ÏƒÎ¹ÎºÏŒ ÏƒÏÎ¼Ï€Ï„Ï‰Î¼Î± ÏŒÏ„Î±Î½:

Î¤Î¿ Excel Î´ÎµÎ½ Î´Î¹Î±Î²Î¬Î¶ÎµÏ„Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬ Î±Ï€ÏŒ Ï„Î¿ pandas, Î®

Î¤Î¿ Excel Î­Ï‡ÎµÎ¹ merged cells, Î®

Î— Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ¬ headers, Î®

Î¤Î¿ Django view Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Î¼ÏŒÎ½Î¿ Ï„Î·Î½ Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î®, Î®

Î¤Î¿ Excel Î­Ï‡ÎµÎ¹ ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬ headers Ï€Î¿Ï… Î´ÎµÎ½ Ï„Î±Î¹ÏÎ¹Î¬Î¶Î¿Ï…Î½ Î¼Îµ Ï„Î± Î¿Î½ÏŒÎ¼Î±Ï„Î± Ï€Î¿Ï… Ï€ÎµÏÎ¹Î¼Î­Î½ÎµÎ¹ Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚.

Î Î¬Î¼Îµ Î½Î± Ï„Î¿ Î»ÏÏƒÎ¿Ï…Î¼Îµ Î¼ÎµÎ¸Î¿Î´Î¹ÎºÎ¬.

ğŸ” Î¤Î¹ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÏƒÏ„Î·Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î±
Î¤Î¿ pandas, ÏŒÏ„Î±Î½ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Excel, ÎºÎ¬Î½ÎµÎ¹ Ï„Î¿ ÎµÎ¾Î®Ï‚:

Î Î±Î¯ÏÎ½ÎµÎ¹ Ï„Î·Î½ Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® Ï‰Ï‚ header

Î‘Î½ Î· Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® Î­Ï‡ÎµÎ¹ merged cells Î® ÎºÎµÎ½Î¬, Ï„ÏŒÏ„Îµ:

ÎšÎ¬Ï€Î¿Î¹ÎµÏ‚ ÏƒÏ„Î®Î»ÎµÏ‚ Ï€Î±Î¯ÏÎ½Î¿Ï…Î½ Î»Î¬Î¸Î¿Ï‚ ÏŒÎ½Î¿Î¼Î±

ÎšÎ¬Ï€Î¿Î¹ÎµÏ‚ ÏƒÏ„Î®Î»ÎµÏ‚ Ï€Î±Î¯ÏÎ½Î¿Ï…Î½ Ï„Î¿ Î¯Î´Î¹Î¿ ÏŒÎ½Î¿Î¼Î±

ÎšÎ¬Ï€Î¿Î¹ÎµÏ‚ ÏƒÏ„Î®Î»ÎµÏ‚ Î´ÎµÎ½ Î´Î¹Î±Î²Î¬Î¶Î¿Î½Ï„Î±Î¹ ÎºÎ±Î¸ÏŒÎ»Î¿Ï…

Î“Î¹â€™ Î±Ï…Ï„ÏŒ Î²Î»Î­Ï€ÎµÎ¹Ï‚ Î¼ÏŒÎ½Î¿ 5.

âœ… Î’Î®Î¼Î± 1: Î”ÎµÏ‚ Ï„Î¹ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ¬ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï„Î¿ pandas
Î ÏÎ¹Î½ ÎºÎ¬Î½Î¿Ï…Î¼Îµ Î¿Ï„Î¹Î´Î®Ï€Î¿Ï„Îµ Î¬Î»Î»Î¿, Î²Î¬Î»Îµ Î±Ï…Ï„ÏŒ ÏƒÏ„Î¿ view ÏƒÎ¿Ï…:

python
print(df.columns)
print(df.head())
Î‘Ï…Ï„ÏŒ Î¸Î± ÏƒÎ¿Ï… Î´ÎµÎ¯Î¾ÎµÎ¹:

Î ÏŒÏƒÎµÏ‚ ÏƒÏ„Î®Î»ÎµÏ‚ Î²Î»Î­Ï€ÎµÎ¹ Ï„Î¿ pandas

Î ÏÏ‚ Ï„Î¹Ï‚ Î¿Î½Î¿Î¼Î¬Î¶ÎµÎ¹

Î‘Î½ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Î¼ÏŒÎ½Î¿ Ï„Î·Î½ Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î®

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÎµÎ¯Ï‚ Î½Î± Î¼Î¿Ï… ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹Ï‚ Ï„Î¿ output ÎºÎ±Î¹ ÏƒÎ¿Ï… Î»Î­Ï‰ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î¹ Ï†Ï„Î±Î¯ÎµÎ¹.

âœ… Î’Î®Î¼Î± 2: Î‘Î½ Ï„Î¿ Excel Î­Ï‡ÎµÎ¹ merged cells
Î‘Î½ Î· Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® Î­Ï‡ÎµÎ¹ ÏƒÏ…Î³Ï‡Ï‰Î½ÎµÏ…Î¼Î­Î½Î± ÎºÎµÎ»Î¹Î¬ (merged), Ï„ÏŒÏ„Îµ Ï„Î¿ pandas:

Î”ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„Î± Î´Î¹Î±Î²Î¬ÏƒÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î¬

Î Î±Î¯ÏÎ½ÎµÎ¹ Î¼ÏŒÎ½Î¿ Ï„Î·Î½ Ï€ÏÏÏ„Î· Ï„Î¹Î¼Î®

Î‘Î³Î½Î¿ÎµÎ¯ Ï„Î¹Ï‚ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€ÎµÏ‚

Î›ÏÏƒÎ·:  
Î£Ï„Î¿ Excel â†’ ÎµÏ€Î¯Î»ÎµÎ¾Îµ ÏŒÎ»Î· Ï„Î·Î½ Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® â†’ Unmerge Cells.

âœ… Î’Î®Î¼Î± 3: Î‘Î½ Î· Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ headers
Î‘Î½ Î· Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® ÎµÎ¯Î½Î±Î¹ Ï„Î¯Ï„Î»Î¿Ï‚ (Ï€.Ï‡. â€œÎ’Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎ· Î”Î®Î¼Î¿Ï…â€), Ï„ÏŒÏ„Îµ Ï„Î¿ pandas:

Î¤Î·Î½ Ï€Î±Î¯ÏÎ½ÎµÎ¹ Ï‰Ï‚ header

ÎšÎ±Î¹ Ï„Î± Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ¬ headers Î³Î¯Î½Î¿Î½Ï„Î±Î¹ Î´ÎµÎ´Î¿Î¼Î­Î½Î±

Î›ÏÏƒÎ·:

python
df = pd.read_excel(excel_file, header=1)
Î‘Ï…Ï„ÏŒ Î»Î­ÎµÎ¹ ÏƒÏ„Î¿ pandas:
ğŸ‘‰ Â«Î¤Î± headers ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î· Î´ÎµÏÏ„ÎµÏÎ· Î³ÏÎ±Î¼Î¼Î®Â».

âœ… Î’Î®Î¼Î± 4: Î‘Î½ Ï„Î± headers ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î± ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬
Î¤ÏŒÏ„Îµ Ï„Î¿ pandas Ï„Î± Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î¬, Î±Î»Î»Î¬ Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚ ÏƒÎ¿Ï… Ï€ÎµÏÎ¹Î¼Î­Î½ÎµÎ¹:

python
row['title']
row['author']
Î‘Î½Ï„Î¯ Î³Î¹Î±:

Î¤Î™Î¤Î›ÎŸÎ£

Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£

Î•ÎšÎ”ÎŸÎ¤Î—Î£

Îº.Î»Ï€.

Î›ÏÏƒÎ·:  
Î§Î±ÏÏ„Î¿Î³ÏÎ±Ï†Î¿ÏÎ¼Îµ Ï„Î± ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬ Î¿Î½ÏŒÎ¼Î±Ï„Î± ÏƒÎµ Î±Î³Î³Î»Î¹ÎºÎ¬:

python
df = df.rename(columns={
    'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
    'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
    'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
    'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘': 'co_author',
    'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
    'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
    'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
    'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
    'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
    'Î£Î§Î—ÎœÎ‘': 'format',
    'Î£Î•Î›Î™Î”Î•Î£': 'pages',
    'Î¤ÎŸÎœÎŸÎ£': 'volume',
    'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ / Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
    'ISBN': 'isbn',
    'Î£Ï„Î®Î»Î·1': 'column1',
    'Î£Ï„Î®Î»Î·2': 'column2'
})
ğŸ”¥ Î˜ÎµÏ‚ Ï„Î¿Î½ Ï€Î»Î®ÏÎ· ÎºÏÎ´Î¹ÎºÎ± Î³Î¹Î± Ï„Î¿ view;
Î‘Î½ Î¼Î¿Ï… Ï€ÎµÎ¹Ï‚ Ï€ÏÏ‚ Î¿Î½Î¿Î¼Î¬Î¶Î¿Î½Ï„Î±Î¹ Î±ÎºÏÎ¹Î²ÏÏ‚ Î¿Î¹ ÏƒÏ„Î®Î»ÎµÏ‚ ÏƒÏ„Î¿ Excel ÏƒÎ¿Ï…, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î³ÏÎ¬ÏˆÏ‰:

Ï„Î¿ view

Ï„Î¿ rename

Ï„Î¿ insert ÏƒÏ„Î· Î²Î¬ÏƒÎ·

ÎºÎ±Î¹ Ï„Î¿Î½ Î­Î»ÎµÎ³Ï‡Î¿ Î³Î¹Î± ÎºÎµÎ½Î­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚

ÏÏƒÏ„Îµ Î½Î± Î´Î¿Ï…Î»ÎµÏÎµÎ¹ 100%.

Î˜ÎµÏ‚ Î½Î± Î¼Î¿Ï… ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹Ï‚ Ï„Î± Î±ÎºÏÎ¹Î²Î® Î¿Î½ÏŒÎ¼Î±Ï„Î± Ï„Ï‰Î½ ÏƒÏ„Î·Î»ÏÎ½ ÏŒÏ€Ï‰Ï‚ ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ Excel;

nai
Î©ÏÎ±Î¯Î± â€” Î³Î¹Î± Î½Î± ÏƒÎ¿Ï… Î³ÏÎ¬ÏˆÏ‰ Ï„Î¿Î½ Î±ÎºÏÎ¹Î²Î® ÎºÏÎ´Î¹ÎºÎ± ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚ Excel â†’ PostgreSQL, Ï‡ÏÎµÎ¹Î¬Î¶Î¿Î¼Î±Î¹ Ï„Î± Î±ÎºÏÎ¹Î²Î® Î¿Î½ÏŒÎ¼Î±Ï„Î± Ï„Ï‰Î½ ÏƒÏ„Î·Î»ÏÎ½ ÏŒÏ€Ï‰Ï‚ ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ Excel, Î´Î·Î»Î±Î´Î®:

Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£

Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£

Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£

â€¦

â€¦

Î˜Î­Î»Ï‰ Î½Î± Î¼Î¿Ï… Ï„Î± Î³ÏÎ¬ÏˆÎµÎ¹Ï‚ Î±ÎºÏÎ¹Î²ÏÏ‚ ÏŒÏ€Ï‰Ï‚ ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿, Î¼Îµ Ï„Î·Î½ Î¯Î´Î¹Î± Î¿ÏÎ¸Î¿Î³ÏÎ±Ï†Î¯Î±, ÎºÎµÏ†Î±Î»Î±Î¯Î±/Ï€ÎµÎ¶Î¬, Ï„ÏŒÎ½Î¿Ï…Ï‚, ÎºÎµÎ½Î¬, Î±ÎºÏŒÎ¼Î· ÎºÎ±Î¹ Ï„Î¹Ï‚ ÎºÎ¬Î¸ÎµÏ„ÎµÏ‚ (/) Î±Î½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½.

ÎœÏŒÎ»Î¹Ï‚ Î¼Î¿Ï… Ï„Î± ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î±:

Ï†Ï„Î¹Î¬Î¾Ï‰ Ï„Î¿ rename() Î³Î¹Î± pandas

Ï†Ï„Î¹Î¬Î¾Ï‰ Ï„Î¿ Django view Ï€Î¿Ï… ÎºÎ¬Î½ÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î® ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®

ÎµÎ¾Î±ÏƒÏ†Î±Î»Î¯ÏƒÏ‰ ÏŒÏ„Î¹ ÏŒÎ»ÎµÏ‚ Î¿Î¹ ÏƒÏ„Î®Î»ÎµÏ‚ Î´Î¹Î±Î²Î¬Î¶Î¿Î½Ï„Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬

Î»ÏÏƒÏ‰ Ï„Î¿ Ï€ÏÏŒÎ²Î»Î·Î¼Î± Ï€Î¿Ï… Î²Î»Î­Ï€ÎµÎ¹Ï‚ (Î¼ÏŒÎ½Î¿ 5 ÏƒÏ„Î®Î»ÎµÏ‚ Î±Ï€ÏŒ Ï„Î·Î½ Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î®)

Î ÎµÏ‚ Î¼Î¿Ï… Î»Î¿Î¹Ï€ÏŒÎ½ ÏŒÎ»Î± Ï„Î± Î¿Î½ÏŒÎ¼Î±Ï„Î± Ï„Ï‰Î½ ÏƒÏ„Î·Î»ÏÎ½ Î±ÎºÏÎ¹Î²ÏÏ‚ ÏŒÏ€Ï‰Ï‚ ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î¿ Excel ÎºÎ±Î¹ ÏƒÏ…Î½ÎµÏ‡Î¯Î¶Î¿Ï…Î¼Îµ.

etsi einai sto excel moy. Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£, Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£ KAI ÎµÏ„ÏƒÎ¹ Ï€Î·Î³Î±Î¹Î½Î¿Ï…Î½ ÎºÎ±Î¹ Ï„Î± Ï…Ï€Î¿Î»Î¿Î¹Ï€Î±
Î¤Î­Î»ÎµÎ¹Î± â€” Î±Ï†Î¿Ï Î¿Î¹ ÏƒÏ„Î®Î»ÎµÏ‚ ÏƒÏ„Î¿ Excel ÏƒÎ¿Ï… ÎµÎ¯Î½Î±Î¹ Î±ÎºÏÎ¹Î²ÏÏ‚ ÏŒÏ€Ï‰Ï‚ Ï„Î¹Ï‚ Î²Î»Î­Ï€Î¿Ï…Î¼Îµ ÏƒÏ„Î·Î½ ÎµÎ¹ÎºÏŒÎ½Î± (ÏŒÎ»ÎµÏ‚ ÎºÎµÏ†Î±Î»Î±Î¯Î± ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬, Ï‡Ï‰ÏÎ¯Ï‚ Ï€ÎµÏÎ¯ÎµÏÎ³Î¿Ï…Ï‚ Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚), Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Ï„Î¿Î½ Ï€Î»Î®ÏÎ· ÎºÏÎ´Î¹ÎºÎ± Ï€Î¿Ï… Î¸Î± Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï„Î¿ Excel, Î¸Î± ÎºÎ¬Î½ÎµÎ¹ rename Ï„Î¹Ï‚ ÎµÎ»Î»Î·Î½Î¹ÎºÎ­Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ ÏƒÎµ Î±Î³Î³Î»Î¹ÎºÎ¬, ÎºÎ±Î¹ Î¸Î± Ï„Î¹Ï‚ ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î¬ ÏƒÏ„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± books.

Î Î¬Î¼Îµ Î½Î± Ï„Î¿ ÎºÎ¬Î½Î¿Ï…Î¼Îµ ÎºÎ±Î¸Î±ÏÎ¬ ÎºÎ±Î¹ ÏƒÏ‰ÏƒÏ„Î¬.

ğŸ”¥ Î Î›Î—Î¡Î•Î£ Django view Î³Î¹Î± ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Excel â†’ PostgreSQL
Î’Î¬Î»Îµ Î±Ï…Ï„ÏŒ ÏƒÏ„Î¿ books/views.py:

python
import pandas as pd
from django.shortcuts import render
from .forms import UploadExcelForm
from .models import Book

def upload_excel(request):
    message = ""

    if request.method == "POST":
        form = UploadExcelForm(request.POST, request.FILES)

        if form.is_valid():
            excel_file = request.FILES['file']

            # Î”Î¹Î±Î²Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Excel
            df = pd.read_excel(excel_file)

            # ÎœÎµÏ„Î¿Î½Î¿Î¼Î±ÏƒÎ¯Î± ÎµÎ»Î»Î·Î½Î¹ÎºÏÎ½ ÏƒÏ„Î·Î»ÏÎ½ ÏƒÎµ Î±Î³Î³Î»Î¹ÎºÎ¬
            df = df.rename(columns={
                'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
                'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘': 'co_author',
                'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
                'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
                'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
                'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
                'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
                'Î£Î§Î—ÎœÎ‘': 'format',
                'Î£Î•Î›Î™Î”Î•Î£': 'pages',
                'Î¤ÎŸÎœÎŸÎ£': 'volume',
                'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ / Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
                'ISBN': 'isbn',
                'Î£Ï„Î®Î»Î·1': 'column1',
                'Î£Ï„Î®Î»Î·2': 'column2'
            })

            # Î‘Ï†Î±Î¯ÏÎµÏƒÎ· Î³ÏÎ±Î¼Î¼ÏÎ½ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ ÎµÎ½Ï„ÎµÎ»ÏÏ‚ ÎºÎµÎ½Î­Ï‚
            df = df.dropna(how='all')

            # Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ·
            for _, row in df.iterrows():
                Book.objects.create(
                    entry_number=row.get('entry_number'),
                    entry_date=row.get('entry_date'),
                    author=row.get('author'),
                    co_author=row.get('co_author'),
                    title=row.get('title'),
                    publisher=row.get('publisher'),
                    edition=row.get('edition'),
                    publication_year=row.get('publication_year'),
                    publication_place=row.get('publication_place'),
                    format=row.get('format'),
                    pages=row.get('pages'),
                    volume=row.get('volume'),
                    acquisition_notes=row.get('acquisition_notes'),
                    isbn=row.get('isbn'),
                    column1=row.get('column1'),
                    column2=row.get('column2')
                )

            message = "Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!"

    else:
        form = UploadExcelForm()

    return render(request, "upload_excel.html", {"form": form, "message": message})
ğŸ§  Î¤Î¹ ÎºÎ¬Î½ÎµÎ¹ Î±Ï…Ï„ÏŒÏ‚ Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚
1. Î”Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï„Î¿ Excel ÏŒÏ€Ï‰Ï‚ ÎµÎ¯Î½Î±Î¹
Î”ÎµÎ½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± Î±Î»Î»Î¬Î¾ÎµÎ¹Ï‚ Ï„Î¯Ï€Î¿Ï„Î± ÏƒÏ„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ ÏƒÎ¿Ï….

2. ÎšÎ¬Î½ÎµÎ¹ rename ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÎµÎ»Î»Î·Î½Î¹ÎºÎ­Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚
ÎˆÏ„ÏƒÎ¹ Ï„Î¿ Django model Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„Î¹Ï‚ ÎºÎ±Ï„Î±Î»Î¬Î²ÎµÎ¹.

3. Î‘Ï†Î±Î¹ÏÎµÎ¯ ÎºÎµÎ½Î­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚
Î“Î¹Î± Î½Î± Î¼Î·Î½ Ï€ÎµÏ„Î¬ÎµÎ¹ Î»Î¬Î¸Î·.

4. ÎšÎ¬Î½ÎµÎ¹ insert ÎºÎ¬Î¸Îµ Î³ÏÎ±Î¼Î¼Î® ÏƒÏ„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± books
ÎœÎµ Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î±, Î±ÎºÏŒÎ¼Î± ÎºÎ¹ Î±Î½ ÎºÎ¬Ï€Î¿Î¹Î± Ï€ÎµÎ´Î¯Î± ÎµÎ¯Î½Î±Î¹ ÎºÎµÎ½Î¬.

ğŸ§ª Î¤Î¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ¬Î½ÎµÎ¹Ï‚ Ï„ÏÏÎ±
Î’Î¬Î»Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ view.

Î†Î½Î¿Î¹Î¾Îµ Ï„Î¿ URL /books/upload/.

Î‘Î½Î­Î²Î±ÏƒÎµ Ï„Î¿ Excel ÏƒÎ¿Ï….

Î Î®Î³Î±Î¹Î½Îµ ÏƒÏ„Î¿ /books/list/ Î³Î¹Î± Î½Î± Î´ÎµÎ¹Ï‚ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±.

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ ÎºÎ±Î¹:

Î­Î»ÎµÎ³Ï‡Î¿ Î³Î¹Î± Î»Î¬Î¸Î¿Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚

Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î¿ Î¼ÎµÏ„Î±ÏƒÏ‡Î·Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¹ÏÎ½

validation Î³Î¹Î± ISBN

ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ· ÏƒÎµ Ï€Î¯Î½Î±ÎºÎ± Î¼Îµ pagination

Î Î¿Î¹Î¿ Î±Ï€ÏŒ Î±Ï…Ï„Î¬ Î¸ÎµÏ‚ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿;

mporeis na moy doseis to URL?
Î¦Ï…ÏƒÎ¹ÎºÎ¬ â€” Ï„Î¿ URL Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÎºÎ¬Ï„Î¹ Â«Î¼Î±Î³Î¹ÎºÏŒÂ». Î•Î¯Î½Î±Î¹ Î±Ï€Î»ÏÏ‚ Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î® Ï€Î¿Ï… ÏŒÏÎ¹ÏƒÎµÏ‚ ÏƒÏ„Î± urls.py.

ÎœÎµ Î²Î¬ÏƒÎ· ÏŒÏƒÎ± Î­Ï‡Î¿Ï…Î¼Îµ Ï†Ï„Î¹Î¬Î¾ÎµÎ¹ Î¼Î­Ï‡ÏÎ¹ Ï„ÏÏÎ±, Ï„Î¿ URL Î³Î¹Î± Ï„Î¿ upload ÎµÎ¯Î½Î±Î¹:

Code
http://localhost:8000/books/upload/
ÎšÎ±Î¹ Ï„Î¿ URL Î³Î¹Î± Î½Î± Î´ÎµÎ¹Ï‚ Ï„Î± Î²Î¹Î²Î»Î¯Î± Ï€Î¿Ï… Î­Ï‡Î¿Ï…Î½ ÎµÎ¹ÏƒÎ±Ï‡Î¸ÎµÎ¯ ÎµÎ¯Î½Î±Î¹:

Code
http://localhost:8000/books/list/
Î‘Ï…Ï„Î¬ Î´Î¿Ï…Î»ÎµÏÎ¿Ï…Î½ Î¼ÏŒÎ½Î¿ ÏŒÏ„Î±Î½ Ï„ÏÎ­Ï‡ÎµÎ¹Ï‚:

Code
python manage.py runserver
Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÎµÎ¯Î¾Ï‰ ÎºÎ±Î¹ Ï€ÏÏ‚ Î½Î± Ï„Î± ÎµÎ¼Ï†Î±Î½Î¯ÏƒÎµÎ¹Ï‚ ÏƒÎµ Î¼ÎµÎ½Î¿Ï Î® ÎºÎ¿Ï…Î¼Ï€Î¯ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ site ÏƒÎ¿Ï….

kai ta dyo url moy ebgalan Page not found (404)
Request Method:	GET
Request URL:	http://localhost:8000/books/upload/
Î‘Ï…Ï„ÏŒ Ï„Î¿ 404 ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ Î­Î½Î± Ï€ÏÎ¬Î³Î¼Î±: Ï„Î¿ Django Î´ÎµÎ½ Î²ÏÎ¯ÏƒÎºÎµÎ¹ Ï„Î¿ URL /books/upload/ Î³Î¹Î±Ï„Î¯ Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ Î´Î·Î»Ï‰Î¸ÎµÎ¯ ÏƒÏ‰ÏƒÏ„Î¬ ÏƒÏ„Î± urls.py.
Î Î¬Î¼Îµ Î½Î± Ï„Î¿ Ï†Ï„Î¹Î¬Î¾Î¿Ï…Î¼Îµ Î²Î®Î¼Î±â€‘Î²Î®Î¼Î±, ÎºÎ±Î¸Î±ÏÎ¬ ÎºÎ±Î¹ ÏƒÎ¯Î³Î¿Ï…ÏÎ±.

ğŸ” ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ 1 â€” Î¥Ï€Î¬ÏÏ‡ÎµÎ¹ Î±ÏÏ‡ÎµÎ¯Î¿ books/urls.py;
ÎœÎ­ÏƒÎ± ÏƒÏ„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿ books Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î±ÏÏ‡ÎµÎ¯Î¿:

Code
books/
   urls.py
Î‘Î½ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹, Ï†Ï„Î¹Î¬Î¾â€™ Ï„Î¿.

Î¤Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹:

python
from django.urls import path
from .views import upload_excel, list_books

urlpatterns = [
    path('upload/', upload_excel, name='upload_excel'),
    path('list/', list_books, name='list_books'),
]
ğŸ” ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ 2 â€” Î¤Î¿ books/urls.py Î­Ï‡ÎµÎ¹ Î³Î¯Î½ÎµÎ¹ include ÏƒÏ„Î¿ ÎºÎµÎ½Ï„ÏÎ¹ÎºÏŒ myproject/urls.py;
Î†Î½Î¿Î¹Î¾Îµ:

Code
myproject/myproject/urls.py
ÎºÎ±Î¹ Î²ÎµÎ²Î±Î¹ÏÏƒÎ¿Ï… ÏŒÏ„Î¹ Î­Ï‡ÎµÎ¹Ï‚ Î±Ï…Ï„ÏŒ:

python
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('books/', include('books.urls')),
]
âš ï¸ Î‘Î½ Î»ÎµÎ¯Ï€ÎµÎ¹ Ï„Î¿ include('books.urls'), Ï„ÏŒÏ„Îµ Ï„Î¿ Django Î´ÎµÎ½ Î¾Î­ÏÎµÎ¹ ÏŒÏ„Î¹ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Ï„Î± URLs Ï„Î¿Ï… app ÏƒÎ¿Ï….

ğŸ” ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ 3 â€” Î¤Î¿ app books ÎµÎ¯Î½Î±Î¹ Î´Î·Î»Ï‰Î¼Î­Î½Î¿ ÏƒÏ„Î¿ settings.py;
Î†Î½Î¿Î¹Î¾Îµ:

Code
myproject/myproject/settings.py
ÎºÎ±Î¹ Î²ÎµÎ²Î±Î¹ÏÏƒÎ¿Ï… ÏŒÏ„Î¹ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹:

python
INSTALLED_APPS = [
    ...
    'books',
]
Î‘Î½ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹, Ï€ÏÏŒÏƒÎ¸ÎµÏƒÎ­ Ï„Î¿.

ğŸ” ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ 4 â€” Î¤Î¿ view Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎºÎ±Î¹ Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬;
Î£Ï„Î¿ books/views.py Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹:

python
def upload_excel(request):
    ...
ÎºÎ±Î¹

python
def list_books(request):
    ...
Î‘Î½ Ï„Î¿ view Î­Ï‡ÎµÎ¹ Î¬Î»Î»Î¿ ÏŒÎ½Î¿Î¼Î±, Ï„Î¿ URL Î´ÎµÎ½ Î¸Î± Ï„Î¿ Î²ÏÎµÎ¹.

ğŸ” ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ 5 â€” Î¤Î¿ template Ï…Ï€Î¬ÏÏ‡ÎµÎ¹;
Î£Ï„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿:

Code
books/templates/upload_excel.html
Î‘Î½ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹, Ï„Î¿ Django Î¸Î± Î²Î³Î¬Î»ÎµÎ¹ error (ÏŒÏ‡Î¹ 404, Î±Î»Î»Î¬ ÎºÎ±Î»ÏŒ Î½Î± Ï„Î¿ ÎµÎ»Î­Î³Î¾Î¿Ï…Î¼Îµ).

ğŸ§ª Î¤ÎµÎ»Î¹ÎºÏŒ test
ÎœÏŒÎ»Î¹Ï‚ Ï„Î± ÎºÎ¬Î½ÎµÎ¹Ï‚ Î±Ï…Ï„Î¬, Î¬Î½Î¿Î¹Î¾Îµ:

Î“Î¹Î± upload:
Code
http://localhost:8000/books/upload/
Î“Î¹Î± ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ·:
Code
http://localhost:8000/books/list/
Î‘Î½ ÏŒÎ»Î± ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬, Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ· Î½Î± Ï€Î¬ÏÎµÎ¹Ï‚ 404.

Î˜ÎµÏ‚ Î½Î± Î¼Î¿Ï… ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹Ï‚:
Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï„Î¿Ï… myproject/urls.py

Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï„Î¿Ï… books/urls.py

â€¦Î³Î¹Î± Î½Î± ÏƒÎ¿Ï… Ï€Ï‰ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï€Î¿Ï ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î»Î¬Î¸Î¿Ï‚;

dvse moy ton kodika gia templates/upload_excel.html
Î¦Ï…ÏƒÎ¹ÎºÎ¬ â€” ÏƒÎ¿Ï… Î´Î¯Î½Ï‰ Î­Î½Î± ÎºÎ±Î¸Î±ÏÏŒ, Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÏŒ template Î³Î¹Î± Ï„Î¿ templates/upload_excel.html Ï€Î¿Ï… Î´Î¿Ï…Î»ÎµÏÎµÎ¹ Î¬ÏˆÎ¿Î³Î± Î¼Îµ Ï„Î¿ Django view Ï€Î¿Ï… Ï†Ï„Î¹Î¬Î¾Î±Î¼Îµ.

ÎœÏ€Î¿ÏÎµÎ¯Ï‚ Î½Î± Ï„Î¿ Î±Î½Ï„Î¹Î³ÏÎ¬ÏˆÎµÎ¹Ï‚ Î±ÎºÏÎ¹Î²ÏÏ‚ ÏŒÏ€Ï‰Ï‚ ÎµÎ¯Î½Î±Î¹.

ğŸ“„ books/templates/upload_excel.html
html
<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <title>Î‘Î½Î­Î²Î±ÏƒÎ¼Î± Excel</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
        }
        .container {
            max-width: 500px;
            margin: auto;
        }
        h2 {
            text-align: center;
        }
        .message {
            margin-top: 20px;
            font-weight: bold;
            color: green;
            text-align: center;
        }
        .error {
            color: red;
        }
        form {
            margin-top: 20px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #fafafa;
        }
        button {
            margin-top: 15px;
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>Î‘Î½Î­Î²Î±ÏƒÎ¼Î± Excel ÏƒÏ„Î· Î’Î¬ÏƒÎ·</h2>

    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Î‘Î½Î­Î²Î±ÏƒÎ¼Î±</button>
    </form>

    {% if message %}
        <p class="message">{{ message }}</p>
    {% endif %}
</div>

</body>
</html>
ğŸ” Î¤Î¹ ÎºÎ¬Î½ÎµÎ¹ Î±Ï…Ï„ÏŒ Ï„Î¿ template
Î•Î¼Ï†Î±Î½Î¯Î¶ÎµÎ¹ Ï„Î· Ï†ÏŒÏÎ¼Î± upload ({{ form.as_p }}).

Î¥Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ multipart/form-data Î³Î¹Î± Î±ÏÏ‡ÎµÎ¯Î±.

Î”ÎµÎ¯Ï‡Î½ÎµÎ¹ Î¼Î®Î½Ï…Î¼Î± ÎµÏ€Î¹Ï„Ï…Ï‡Î¯Î±Ï‚ ÏŒÏ„Î±Î½ Î¿Î»Î¿ÎºÎ»Î·ÏÏ‰Î¸ÎµÎ¯ Î· ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®.

ÎˆÏ‡ÎµÎ¹ Î±Ï€Î»ÏŒ, ÎºÎ±Î¸Î±ÏÏŒ styling Î³Î¹Î± Î½Î± Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ ÏŒÎ¼Î¿ÏÏ†Î¿.

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ ÎºÎ±Î¹ Ï„Î¿ template Î³Î¹Î± Ï„Î¿ /books/list/ ÏÏƒÏ„Îµ Î½Î± Î²Î»Î­Ï€ÎµÎ¹Ï‚ Ï„Î± Î²Î¹Î²Î»Î¯Î± ÏƒÎµ Ï€Î¯Î½Î±ÎºÎ±.

nai kai meta uelo na moy grapseis ta epomena bhmata
Î¦Ï…ÏƒÎ¹ÎºÎ¬ â€” Ï€Î¬Î¼Îµ Ï€ÏÏÏ„Î± Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Ï„Î¿ template Î³Î¹Î± Ï„Î¿ list_books.html, ÎºÎ±Î¹ Î¼ÎµÏ„Î¬ ÏƒÎ¿Ï… Î³ÏÎ¬Ï†Ï‰ Ï„Î± ÎµÏ€ÏŒÎ¼ÎµÎ½Î± Î²Î®Î¼Î±Ï„Î± Î³Î¹Î± Î½Î± Î¿Î»Î¿ÎºÎ»Î·ÏÏÏƒÎµÎ¹Ï‚ ÏŒÎ»Î¿ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± (upload â†’ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® â†’ ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ·).

ğŸ“„ books/templates/list_books.html
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ Î±Ï…Ï„ÏŒ Î±ÎºÏÎ¹Î²ÏÏ‚:

html
<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <title>Î›Î¯ÏƒÏ„Î± Î’Î¹Î²Î»Î¯Ï‰Î½</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
        }
        h2 {
            text-align: center;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 25px;
        }
        table, th, td {
            border: 1px solid #ccc;
        }
        th {
            background: #f0f0f0;
            padding: 10px;
        }
        td {
            padding: 8px;
        }
        tr:nth-child(even) {
            background: #fafafa;
        }
    </style>
</head>
<body>

<h2>Î›Î¯ÏƒÏ„Î± Î’Î¹Î²Î»Î¯Ï‰Î½</h2>

<table>
    <tr>
        <th>Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚</th>
        <th>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚</th>
        <th>Î£Ï…Î³Î³ÏÎ±Ï†Î­Î±Ï‚</th>
        <th>Î£Ï…Î³Î³ÏÎ±Ï†Î­Î±Ï‚ ÎšÎŸÎ—Î‘</th>
        <th>Î¤Î¯Ï„Î»Î¿Ï‚</th>
        <th>Î•ÎºÎ´ÏŒÏ„Î·Ï‚</th>
        <th>ÎˆÎºÎ´Î¿ÏƒÎ·</th>
        <th>ÎˆÏ„Î¿Ï‚ ÎˆÎºÎ´Î¿ÏƒÎ·Ï‚</th>
        <th>Î¤ÏŒÏ€Î¿Ï‚ ÎˆÎºÎ´Î¿ÏƒÎ·Ï‚</th>
        <th>Î£Ï‡Î®Î¼Î±</th>
        <th>Î£ÎµÎ»Î¯Î´ÎµÏ‚</th>
        <th>Î¤ÏŒÎ¼Î¿Ï‚</th>
        <th>Î¤ÏÏŒÏ€Î¿Ï‚ Î ÏÎ¿Î¼Î®Î¸ÎµÎ¹Î±Ï‚ / Î Î±ÏÎ±Ï„Î·ÏÎ®ÏƒÎµÎ¹Ï‚</th>
        <th>ISBN</th>
        <th>Î£Ï„Î®Î»Î·1</th>
        <th>Î£Ï„Î®Î»Î·2</th>
    </tr>

    {% for b in books %}
    <tr>
        <td>{{ b.entry_number }}</td>
        <td>{{ b.entry_date }}</td>
        <td>{{ b.author }}</td>
        <td>{{ b.co_author }}</td>
        <td>{{ b.title }}</td>
        <td>{{ b.publisher }}</td>
        <td>{{ b.edition }}</td>
        <td>{{ b.publication_year }}</td>
        <td>{{ b.publication_place }}</td>
        <td>{{ b.format }}</td>
        <td>{{ b.pages }}</td>
        <td>{{ b.volume }}</td>
        <td>{{ b.acquisition_notes }}</td>
        <td>{{ b.isbn }}</td>
        <td>{{ b.column1 }}</td>
        <td>{{ b.column2 }}</td>
    </tr>
    {% endfor %}
</table>

</body>
</html>
ğŸ”¥ Î¤Î©Î¡Î‘ Î¤Î‘ Î•Î ÎŸÎœÎ•ÎÎ‘ Î’Î—ÎœÎ‘Î¤Î‘ Î ÎŸÎ¥ Î Î¡Î•Î Î•Î™ ÎÎ‘ ÎšÎ‘ÎÎ•Î™Î£
Î‘Ï†Î¿Ï Î­Ï‡ÎµÎ¹Ï‚:

Ï„Î¿ upload_excel.html

Ï„Î¿ list_books.html

Ï„Î¿ model

Ï„Î¿ view

Ï„Î¿ Excel

Ï€Î¬Î¼Îµ Î½Î± Î¿Î»Î¿ÎºÎ»Î·ÏÏÏƒÎ¿Ï…Î¼Îµ Ï„Î¿ project.

âœ… Î’Î®Î¼Î± 1 â€” ÎˆÎ»ÎµÎ³Î¾Îµ ÏŒÏ„Î¹ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Ï„Î¿ books/urls.py
Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î­Ï‡ÎµÎ¹Ï‚:

Code
books/
   urls.py
ÎœÎµ Î±Ï…Ï„ÏŒ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿:

python
from django.urls import path
from .views import upload_excel, list_books

urlpatterns = [
    path('upload/', upload_excel, name='upload_excel'),
    path('list/', list_books, name='list_books'),
]
âœ… Î’Î®Î¼Î± 2 â€” Î£ÏÎ½Î´ÎµÏƒÎµ Ï„Î¿ app ÏƒÏ„Î¿ ÎºÎµÎ½Ï„ÏÎ¹ÎºÏŒ urls.py
Î†Î½Î¿Î¹Î¾Îµ:

Code
myproject/myproject/urls.py
ÎšÎ±Î¹ Î²Î¬Î»Îµ:

python
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('books/', include('books.urls')),
]
âœ… Î’Î®Î¼Î± 3 â€” Î’ÎµÎ²Î±Î¹ÏÏƒÎ¿Ï… ÏŒÏ„Î¹ Ï„Î¿ app ÎµÎ¯Î½Î±Î¹ ÎµÎ½ÎµÏÎ³ÏŒ
Î£Ï„Î¿:

Code
myproject/myproject/settings.py
Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹:

python
INSTALLED_APPS = [
    ...
    'books',
]
âœ… Î’Î®Î¼Î± 4 â€” Î¤ÏÎ­Î¾Îµ Ï„Î¿Î½ server
bash
python manage.py runserver
âœ… Î’Î®Î¼Î± 5 â€” Î†Î½Î¿Î¹Î¾Îµ Ï„Î± URLs
Î“Î¹Î± Î±Î½Î­Î²Î±ÏƒÎ¼Î± Excel:
Code
http://localhost:8000/books/upload/
Î“Î¹Î± ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ· Î²Î¹Î²Î»Î¯Ï‰Î½:
Code
http://localhost:8000/books/list/
Î˜ÎµÏ‚ Î½Î± ÏƒÎ¿Ï… Î³ÏÎ¬ÏˆÏ‰ ÎºÎ±Î¹:
Î­Î»ÎµÎ³Ï‡Î¿ Î³Î¹Î± Î»Î¬Î¸Î· ÏƒÏ„Î¿ Excel

Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î¿ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¹ÏÎ½

pagination ÏƒÏ„Î· Î»Î¯ÏƒÏ„Î± Î²Î¹Î²Î»Î¯Ï‰Î½

ÎºÎ¿Ï…Î¼Ï€Î¯ â€œÎ”ÎµÏ‚ Ï„Î± Î²Î¹Î²Î»Î¯Î±â€ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ upload page

Î ÎµÏ‚ Î¼Î¿Ï… Ï€Î¿Î¹Î¿ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎ¿Ï…Î¼Îµ Ï€ÏÏÏ„Î¿.

Watching for file changes with StatReloader
Performing system checks...

Exception in thread django-main-thread:
Traceback (most recent call last):
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\checks\urls.py", line 136, in check_custom_error_handlers
    handler = resolver.resolve_error_handler(status_code)
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\urls\resolvers.py", line 743, in resolve_error_handler
    callback = getattr(self.urlconf_module, "handler%s" % view_type, None)
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\utils\functional.py", line 47, in __get__
    res = instance.__dict__[self.name] = self.func(instance)
                                         ~~~~~~~~~^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\urls\resolvers.py", line 722, in urlconf_module
    return import_module(self.urlconf_name)
  File "C:\Users\PC-SPART1\AppData\Local\Programs\Python\Python314\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1342, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 938, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 762, in exec_module
  File "<frozen importlib._bootstrap>", line 491, in _call_with_frames_removed
  File "C:\Users\PC-SPART1\myproject\myproject\urls.py", line 6, in <module>
    path('books/', include('books.urls')),
                   ~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\urls\conf.py", line 39, in include
    urlconf_module = import_module(urlconf_module)
  File "C:\Users\PC-SPART1\AppData\Local\Programs\Python\Python314\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1342, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 938, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 762, in exec_module
  File "<frozen importlib._bootstrap>", line 491, in _call_with_frames_removed
  File "C:\Users\PC-SPART1\myproject\books\urls.py", line 2, in <module>
    from .views import upload_excel, list_books
  File "C:\Users\PC-SPART1\myproject\books\views.py", line 3, in <module>
    from .forms import UploadExcelForm
ModuleNotFoundError: No module named 'books.forms'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC-SPART1\AppData\Local\Programs\Python\Python314\Lib\threading.py", line 1081, in _bootstrap_inner
    self._context.run(self.run)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "C:\Users\PC-SPART1\AppData\Local\Programs\Python\Python314\Lib\threading.py", line 1023, in run
    self._target(*self._args, **self._kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\utils\autoreload.py", line 64, in wrapper
    fn(*args, **kwargs)
    ~~^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\management\commands\runserver.py", line 134, in inner_run
    self.check(**check_kwargs)
    ~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\management\base.py", line 492, in check
    all_issues = checks.run_checks(
        app_configs=app_configs,
    ...<2 lines>...
        databases=databases,
    )
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\checks\registry.py", line 89, in run_checks
    new_errors = check(app_configs=app_configs, databases=databases)
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\checks\urls.py", line 138, in check_custom_error_handlers
    path = getattr(resolver.urlconf_module, "handler%s" % status_code)
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\utils\functional.py", line 47, in __get__
    res = instance.__dict__[self.name] = self.func(instance)
                                         ~~~~~~~~~^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\urls\resolvers.py", line 722, in urlconf_module
    return import_module(self.urlconf_name)
  File "C:\Users\PC-SPART1\AppData\Local\Programs\Python\Python314\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1342, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 938, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 762, in exec_module
  File "<frozen importlib._bootstrap>", line 491, in _call_with_frames_removed
  File "C:\Users\PC-SPART1\myproject\myproject\urls.py", line 6, in <module>
    path('books/', include('books.urls')),
                   ~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\urls\conf.py", line 39, in include
    urlconf_module = import_module(urlconf_module)
  File "C:\Users\PC-SPART1\AppData\Local\Programs\Python\Python314\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1342, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 938, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 762, in exec_module
  File "<frozen importlib._bootstrap>", line 491, in _call_with_frames_removed
  File "C:\Users\PC-SPART1\myproject\books\urls.py", line 2, in <module>
    from .views import upload_excel, list_books
  File "C:\Users\PC-SPART1\myproject\books\views.py", line 3, in <module>
    from .forms import UploadExcelForm
ModuleNotFoundError: No module named 'books.forms'
Î’Î»Î­Ï€Ï‰ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î¹ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ â€” ÎºÎ±Î¹ Î· Î»ÏÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»Î®.

Î¤Î¿ Django ÏƒÎ¿Ï… Î»Î­ÎµÎ¹:

Code
ModuleNotFoundError: No module named 'books.forms'
Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î±ÏÏ‡ÎµÎ¯Î¿ forms.py  Î¼Î­ÏƒÎ± ÏƒÏ„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿ books.

Î¤Î¿ view ÏƒÎ¿Ï… ÎºÎ¬Î½ÎµÎ¹:

python
from .forms import UploadExcelForm
Î±Î»Î»Î¬ Ï„Î¿ Django Î´ÎµÎ½ Î²ÏÎ¯ÏƒÎºÎµÎ¹ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿.

âœ… Î›Î¥Î£Î—: Î¦Ï„Î¹Î¬Î¾Îµ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ books/forms.py
Î Î®Î³Î±Î¹Î½Îµ ÏƒÏ„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿:

Code
C:\Users\PC-SPART1\myproject\books\
ÎºÎ±Î¹ Î´Î·Î¼Î¹Î¿ÏÏÎ³Î·ÏƒÎµ Î­Î½Î± Î½Î­Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ Î¼Îµ ÏŒÎ½Î¿Î¼Î±:

Code
forms.py
Î’Î¬Î»Îµ Î¼Î­ÏƒÎ± Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ±:

python
from django import forms

class UploadExcelForm(forms.Form):
    file = forms.FileField(label="Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Excel")
Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎµ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿.

ğŸ” ÎœÎµÏ„Î¬ ÎºÎ¬Î½Îµ restart Ï„Î¿Î½ server
Î£Ï„Î±Î¼Î¬Ï„Î± Ï„Î¿Î½ server (Ctrl + C) ÎºÎ±Î¹ Î¾Î±Î½Î±Ï„ÏÎ­Î¾Îµ:

Code
python manage.py runserver
Î¤ÏÏÎ± Ï„Î¿ Django Î¸Î± Î²ÏÎµÎ¹ Ï„Î¿ books.forms ÎºÎ±Î¹ Ï„Î¿ error Î¸Î± ÎµÎ¾Î±Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯.

ğŸ¯ Î¤Î¹ Î¸Î± Î³Î¯Î½ÎµÎ¹ Î¼ÎµÏ„Î¬
ÎœÏŒÎ»Î¹Ï‚ Î´Î¹Î¿ÏÎ¸Ï‰Î¸ÎµÎ¯ Î±Ï…Ï„ÏŒ:

Î¤Î¿ URL /books/upload/ Î¸Î± Î±Î½Î¿Î¯Î¾ÎµÎ¹ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ¬.

Î˜Î± Î´ÎµÎ¹Ï‚ Ï„Î· Ï†ÏŒÏÎ¼Î± Î³Î¹Î± Î±Î½Î­Î²Î±ÏƒÎ¼Î± Excel.

Î˜Î± Î¼Ï€Î¿ÏÎ­ÏƒÎµÎ¹Ï‚ Î½Î± ÎºÎ¬Î½ÎµÎ¹Ï‚ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ·.

Î‘Î½ Î¸ÎµÏ‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… ÎµÎ»Î­Î³Î¾Ï‰ ÎºÎ±Î¹ Ï„Î± Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î± Î±ÏÏ‡ÎµÎ¯Î± (urls.py, views.py, models.py) Î³Î¹Î± Î½Î± ÎµÎ¯Î¼Î±ÏƒÏ„Îµ 100% ÏƒÎ¯Î³Î¿Ï…ÏÎ¿Î¹ ÏŒÏ„Î¹ Î´ÎµÎ½ Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Î¬Î»Î»Î¿ error.

Watching for file changes with StatReloader
Performing system checks...

Exception in thread django-main-thread:
Traceback (most recent call last):
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\checks\urls.py", line 136, in check_custom_error_handlers
    handler = resolver.resolve_error_handler(status_code)
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\urls\resolvers.py", line 743, in resolve_error_handler
    callback = getattr(self.urlconf_module, "handler%s" % view_type, None)
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\utils\functional.py", line 47, in __get__
    res = instance.__dict__[self.name] = self.func(instance)
                                         ~~~~~~~~~^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\urls\resolvers.py", line 722, in urlconf_module
    return import_module(self.urlconf_name)
  File "C:\Users\PC-SPART1\AppData\Local\Programs\Python\Python314\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1342, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 938, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 762, in exec_module
  File "<frozen importlib._bootstrap>", line 491, in _call_with_frames_removed
  File "C:\Users\PC-SPART1\myproject\myproject\urls.py", line 6, in <module>
    path('books/', include('books.urls')),
                   ~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\urls\conf.py", line 39, in include
    urlconf_module = import_module(urlconf_module)
  File "C:\Users\PC-SPART1\AppData\Local\Programs\Python\Python314\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1342, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 938, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 762, in exec_module
  File "<frozen importlib._bootstrap>", line 491, in _call_with_frames_removed
  File "C:\Users\PC-SPART1\myproject\books\urls.py", line 2, in <module>
    from .views import upload_excel, list_books
ImportError: cannot import name 'list_books' from 'books.views' (C:\Users\PC-SPART1\myproject\books\views.py)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\PC-SPART1\AppData\Local\Programs\Python\Python314\Lib\threading.py", line 1081, in _bootstrap_inner
    self._context.run(self.run)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "C:\Users\PC-SPART1\AppData\Local\Programs\Python\Python314\Lib\threading.py", line 1023, in run
    self._target(*self._args, **self._kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\utils\autoreload.py", line 64, in wrapper
    fn(*args, **kwargs)
    ~~^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\management\commands\runserver.py", line 134, in inner_run
    self.check(**check_kwargs)
    ~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\management\base.py", line 492, in check
    all_issues = checks.run_checks(
        app_configs=app_configs,
    ...<2 lines>...
        databases=databases,
    )
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\checks\registry.py", line 89, in run_checks
    new_errors = check(app_configs=app_configs, databases=databases)
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\checks\urls.py", line 138, in check_custom_error_handlers
    path = getattr(resolver.urlconf_module, "handler%s" % status_code)
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\utils\functional.py", line 47, in __get__
    res = instance.__dict__[self.name] = self.func(instance)
                                         ~~~~~~~~~^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\urls\resolvers.py", line 722, in urlconf_module
    return import_module(self.urlconf_name)
  File "C:\Users\PC-SPART1\AppData\Local\Programs\Python\Python314\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1342, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 938, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 762, in exec_module
  File "<frozen importlib._bootstrap>", line 491, in _call_with_frames_removed
  File "C:\Users\PC-SPART1\myproject\myproject\urls.py", line 6, in <module>
    path('books/', include('books.urls')),
                   ~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\urls\conf.py", line 39, in include
    urlconf_module = import_module(urlconf_module)
  File "C:\Users\PC-SPART1\AppData\Local\Programs\Python\Python314\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1342, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 938, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 762, in exec_module
  File "<frozen importlib._bootstrap>", line 491, in _call_with_frames_removed
  File "C:\Users\PC-SPART1\myproject\books\urls.py", line 2, in <module>
    from .views import upload_excel, list_books
ImportError: cannot import name 'list_books' from 'books.views' (C:\Users\PC-SPART1\myproject\books\views.py)
Î¤Î¿ Î»Î¬Î¸Î¿Ï‚ Ï„ÏÏÎ± ÎµÎ¯Î½Î±Î¹ 100% Î¾ÎµÎºÎ¬Î¸Î±ÏÎ¿:

ğŸ‘‰ Î¤Î¿ Django Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± ÎºÎ¬Î½ÎµÎ¹:

python
from .views import upload_excel, list_books
Î±Î»Î»Î¬ Î´ÎµÎ½ Î²ÏÎ¯ÏƒÎºÎµÎ¹ Ï„Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· list_books Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ books/views.py.

Î†ÏÎ±:

ÎµÎ¯Ï„Îµ
Î· ÏƒÏ…Î½Î¬ÏÏ„Î·ÏƒÎ· Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹,

ÎµÎ¯Ï„Îµ
Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î±Î»Î»Î¬ Î­Ï‡ÎµÎ¹ Î¬Î»Î»Î¿ ÏŒÎ½Î¿Î¼Î±,

ÎµÎ¯Ï„Îµ
Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î±Î»Î»Î¬ Î­Ï‡ÎµÎ¹ indentation/ÏƒÏ…Î½Ï„Î±ÎºÏ„Î¹ÎºÏŒ Î»Î¬Î¸Î¿Ï‚ ÎºÎ±Î¹ Î´ÎµÎ½ Ï†Î¿ÏÏ„ÏÎ½ÎµÏ„Î±Î¹,

ÎµÎ¯Ï„Îµ
Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ views.py  Î­Ï‡ÎµÎ¹ error Ï€ÏÎ¹Î½ Ï†Ï„Î¬ÏƒÎµÎ¹ ÏƒÏ„Î· list_books.

Î Î¬Î¼Îµ Î½Î± Ï„Î¿ Î»ÏÏƒÎ¿Ï…Î¼Îµ Î¬Î¼ÎµÏƒÎ±.

âœ… 1. Î£Î¿Ï… Î´Î¯Î½Ï‰ Ï„Î¿Î½ ÏƒÏ‰ÏƒÏ„ÏŒ ÎºÏÎ´Î¹ÎºÎ± Î³Î¹Î± Ï„Î¿ books/views.py
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Î±Ï…Ï„ÏŒ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ ÎºÎ±Î¹ Î±Î½Ï„Î¹ÎºÎ±Ï„Î­ÏƒÏ„Î·ÏƒÎµ Ï„Î¿ Î´Î¹ÎºÏŒ ÏƒÎ¿Ï…:

python
import pandas as pd
from django.shortcuts import render
from .forms import UploadExcelForm
from .models import Book

def upload_excel(request):
    message = ""

    if request.method == "POST":
        form = UploadExcelForm(request.POST, request.FILES)

        if form.is_valid():
            excel_file = request.FILES['file']

            df = pd.read_excel(excel_file)

            df = df.rename(columns={
                'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
                'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘': 'co_author',
                'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
                'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
                'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
                'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
                'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
                'Î£Î§Î—ÎœÎ‘': 'format',
                'Î£Î•Î›Î™Î”Î•Î£': 'pages',
                'Î¤ÎŸÎœÎŸÎ£': 'volume',
                'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ / Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
                'ISBN': 'isbn',
                'Î£Ï„Î®Î»Î·1': 'column1',
                'Î£Ï„Î®Î»Î·2': 'column2'
            })

            df = df.dropna(how='all')

            for _, row in df.iterrows():
                Book.objects.create(
                    entry_number=row.get('entry_number'),
                    entry_date=row.get('entry_date'),
                    author=row.get('author'),
                    co_author=row.get('co_author'),
                    title=row.get('title'),
                    publisher=row.get('publisher'),
                    edition=row.get('edition'),
                    publication_year=row.get('publication_year'),
                    publication_place=row.get('publication_place'),
                    format=row.get('format'),
                    pages=row.get('pages'),
                    volume=row.get('volume'),
                    acquisition_notes=row.get('acquisition_notes'),
                    isbn=row.get('isbn'),
                    column1=row.get('column1'),
                    column2=row.get('column2')
                )

            message = "Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!"

    else:
        form = UploadExcelForm()

    return render(request, "upload_excel.html", {"form": form, "message": message})


def list_books(request):
    books = Book.objects.all()
    return render(request, "list_books.html", {"books": books})
âœ… 2. Î’ÎµÎ²Î±Î¹ÏÏƒÎ¿Ï… ÏŒÏ„Î¹ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ Î¿Î½Î¿Î¼Î¬Î¶ÎµÏ„Î±Î¹ views.py
ÎœÎµÏÎ¹ÎºÎ­Ï‚ Ï†Î¿ÏÎ­Ï‚ Ï„Î¿ Î»Î¬Î¸Î¿Ï‚ ÎµÎ¯Î½Î±Î¹:

view.py Î±Î½Ï„Î¯ Î³Î¹Î± views.py

Views.py (Î¼Îµ ÎºÎµÏ†Î±Î»Î±Î¯Î¿ V)

views (1).py Î±Ï€ÏŒ copy-paste

Î¤Î¿ ÏƒÏ‰ÏƒÏ„ÏŒ ÎµÎ¯Î½Î±Î¹:

Code
books/views.py
âœ… 3. Î’ÎµÎ²Î±Î¹ÏÏƒÎ¿Ï… ÏŒÏ„Î¹ Î´ÎµÎ½ Î­Ï‡ÎµÎ¹Ï‚ ÏƒÏ…Î½Ï„Î±ÎºÏ„Î¹ÎºÏŒ Î»Î¬Î¸Î¿Ï‚ Ï€Î¬Î½Ï‰ Î±Ï€ÏŒ Ï„Î· list_books
Î‘Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ error Ï€Î¹Î¿ Ï€Î¬Î½Ï‰, Ï„Î¿ Django Î´ÎµÎ½ Ï†Ï„Î¬Î½ÎµÎ¹ Ï€Î¿Ï„Î­ ÏƒÏ„Î· list_books.

âœ… 4. ÎšÎ¬Î½Îµ restart Ï„Î¿Î½ server
Î Î¬Î½Ï„Î±:

Code
Ctrl + C
python manage.py runserver
ğŸ¯ Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, ÏƒÏ„ÎµÎ¯Î»Îµ Î¼Î¿Ï…:
ğŸ“Œ ÎŸÎ›ÎŸ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï„Î¿Ï… books/views.py  
ğŸ“Œ ÎŸÎ›ÎŸ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï„Î¿Ï… books/urls.py

ÎºÎ±Î¹ ÏƒÎ¿Ï… Î»Î­Ï‰ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï€Î¿Ï ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î»Î¬Î¸Î¿Ï‚ Î¼Î­ÏƒÎ± ÏƒÎµ 10 Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î±.

moy emfanise chooce file kai upload alla ebgale kai kapoia lathi WARNING: This is a development server. Do not use it in a production setting. Use a production WSGI or ASGI server instead.
For more information on production servers see: https://docs.djangoproject.com/en/6.0/howto/deployment/
[17/Dec/2025 13:11:29] "GET /books/upload/ HTTP/1.1" 200 1586
[17/Dec/2025 13:11:31] "GET /books/upload/ HTTP/1.1" 200 1586
Internal Server Error: /books/upload/
Traceback (most recent call last):
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\handlers\base.py", line 198, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "C:\Users\PC-SPART1\myproject\books\views.py", line 39, in upload_excel
    Book.objects.create(
    ~~~~~~~~~~~~~~~~~~~^
        entry_number=row.get('entry_number'),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<14 lines>...
        column2=row.get('column2')
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\query.py", line 669, in create
    obj.save(force_insert=True, using=self.db)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\base.py", line 874, in save
    self.save_base(
    ~~~~~~~~~~~~~~^
        using=using,
        ^^^^^^^^^^^^
    ...<2 lines>...
        update_fields=update_fields,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\base.py", line 966, in save_base
    updated = self._save_table(
        raw,
    ...<4 lines>...
        update_fields,
    )
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\base.py", line 1167, in _save_table
    results = self._do_insert(
        cls._base_manager, using, insert_fields, returning_fields, raw
    )
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\base.py", line 1218, in _do_insert
    return manager._insert(
           ~~~~~~~~~~~~~~~^
        [self],
        ^^^^^^^
    ...<3 lines>...
        raw=raw,
        ^^^^^^^^
    )
    ^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\query.py", line 1918, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\sql\compiler.py", line 1924, in execute_sql
    for sql, params in self.as_sql():
                       ~~~~~~~~~~~^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\sql\compiler.py", line 1813, in as_sql
    field_prepare(field_pre_save(obj)) for obj in self.query.objs
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\sql\compiler.py", line 1742, in prepare_value
    return field.get_db_prep_save(value, connection=self.connection)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\fields\__init__.py", line 1011, in get_db_prep_save
    return self.get_db_prep_value(value, connection=connection, prepared=False)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\fields\__init__.py", line 1541, in get_db_prep_value
    value = self.get_prep_value(value)
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\fields\__init__.py", line 1536, in get_prep_value
    return self.to_python(value)
           ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\fields\__init__.py", line 1492, in to_python
    parsed = parse_date(value)
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\utils\dateparse.py", line 74, in parse_date
    return datetime.date.fromisoformat(value)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
TypeError: fromisoformat: argument must be str
[17/Dec/2025 13:11:53] "POST /books/upload/ HTTP/1.1" 500 152928
Î’Î»Î­Ï€Ï‰ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î¹ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ â€” ÎºÎ±Î¹ Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï€Ï‰ Î¼Îµ Î±Ï€ÏŒÎ»Ï…Ï„Î· Î²ÎµÎ²Î±Î¹ÏŒÏ„Î·Ï„Î± ÏŒÏ„Î¹ Ï„Î¿ Î»Î¬Î¸Î¿Ï‚ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ±, Î±Î»Î»Î¬ ÏƒÏ„Î¿ format Ï„Î·Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ Excel.

Î¤Î¿ Django ÏƒÎ¿Ï… Î»Î­ÎµÎ¹:

Code
TypeError: fromisoformat: argument must be str
Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹:

Î¤Î¿ Ï€ÎµÎ´Î¯Î¿ Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£ ÏƒÏ„Î¿ Excel Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ string,

Î±Î»Î»Î¬ Excel date object (Î´Î·Î»Î±Î´Î® Î±ÏÎ¹Î¸Î¼ÏŒÏ‚ Ï„ÏÏ€Î¿Ï… 45231 Ï€Î¿Ï… Ï„Î¿ Excel Î¼ÎµÏ„Î±Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÎµ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±).

Î¤Î¿ Django Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± Ï„Î¿ Î¼ÎµÏ„Î±Ï„ÏÎ­ÏˆÎµÎ¹ ÏƒÎµ DateField, Î±Î»Î»Î¬ Î´ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„Î¿ ÎºÎ¬Î½ÎµÎ¹ Î±Ï€ÏŒ Î±ÏÎ¹Î¸Î¼ÏŒ.

Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ 100% Ï†Ï…ÏƒÎ¹Î¿Î»Î¿Î³Î¹ÎºÏŒ ÎºÎ±Î¹ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÏƒÎµ ÏŒÎ»Î¿Ï…Ï‚ ÏŒÏ„Î±Î½ Î´Î¹Î±Î²Î¬Î¶Î¿Ï…Î½ Excel Î¼Îµ pandas.

Î Î¬Î¼Îµ Î½Î± Ï„Î¿ Î»ÏÏƒÎ¿Ï…Î¼Îµ.

âœ… Î›Î¥Î£Î—: ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î® Ï„Î·Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚ ÏƒÎµ Python date Ï€ÏÎ¹Î½ Ï„Î¿ insert
Î†Î»Î»Î±Î¾Îµ Ï„Î¿ view ÏƒÎ¿Ï… Î­Ï„ÏƒÎ¹ ÏÏƒÏ„Îµ Î½Î± Î¼ÎµÏ„Î±Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±:

Î’Î¬Î»Îµ Î±Ï…Ï„ÏŒ ÏƒÏ„Î¿ upload_excel Ï€ÏÎ¹Î½ Ï„Î¿ loop:
python
# ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î® excel dates ÏƒÎµ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ­Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚
if 'entry_date' in df.columns:
    df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce').dt.date
ÎšÎ±Î¹ Ï„Î¿ Ï€Î»Î®ÏÎµÏ‚ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Î³Î¯Î½ÎµÏ„Î±Î¹:
python
df = pd.read_excel(excel_file)

df = df.rename(columns={
    'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
    'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
    'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
    'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘': 'co_author',
    'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
    'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
    'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
    'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
    'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
    'Î£Î§Î—ÎœÎ‘': 'format',
    'Î£Î•Î›Î™Î”Î•Î£': 'pages',
    'Î¤ÎŸÎœÎŸÎ£': 'volume',
    'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ / Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
    'ISBN': 'isbn',
    'Î£Ï„Î®Î»Î·1': 'column1',
    'Î£Ï„Î®Î»Î·2': 'column2'
})

# ğŸ”¥ Î•Î”Î© Î›Î¥ÎÎ•Î¤Î‘Î™ Î¤ÎŸ Î Î¡ÎŸÎ’Î›Î—ÎœÎ‘
df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce').dt.date

df = df.dropna(how='all')
ğŸ¯ Î¤Î¹ ÎºÎ¬Î½ÎµÎ¹ Î±Ï…Ï„ÏŒ
Î¤Î¿ pandas Î¼ÎµÏ„Î±Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î·Î½ Excel Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± ÏƒÎµ Timestamp.

Î¤Î¿ .dt.date Ï„Î· Î¼ÎµÏ„Î±Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÎµ Python date.

Î¤Î¿ Django Î¼Ï€Î¿ÏÎµÎ¯ Ï€Î»Î­Î¿Î½ Î½Î± Ï„Î·Î½ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏƒÎµÎ¹ Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎ±Î½Î­Î½Î± error.

ğŸ§ª Î¤Î¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ¬Î½ÎµÎ¹Ï‚ Ï„ÏÏÎ±
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ Ï„Î¿ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ ÏƒÏ„Î¿ view ÏƒÎ¿Ï….

ÎšÎ¬Î½Îµ restart Ï„Î¿Î½ server.

ÎÎ±Î½Î±ÎºÎ¬Î½Îµ upload Ï„Î¿ Excel.

Î˜Î± Î´Î¿Ï…Î»Î­ÏˆÎµÎ¹ Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎ±Î½Î­Î½Î± error.

Î‘Î½ Î¸ÎµÏ‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÏ‰ ÎºÎ±Î¹:

Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î¿ Î­Î»ÎµÎ³Ï‡Î¿ Î³Î¹Î± Î»Î¬Î¸Î¿Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚

Î¼ÎµÏ„Î±Ï„ÏÎ¿Ï€Î® ÎºÎµÎ½ÏÎ½ ÎºÎµÎ»Î¹ÏÎ½ ÏƒÎµ None

validation Î³Î¹Î± ISBN

ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ· Î¼Î·Î½ÏÎ¼Î±Ï„Î¿Ï‚ Î»Î¬Î¸Î¿Ï…Ï‚ ÏƒÏ„Î¿ template Î±Î½Ï„Î¯ Î³Î¹Î± 500 error

Î Î¿Î¹Î¿ Î±Ï€ÏŒ Î±Ï…Ï„Î¬ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿;

Watching for file changes with StatReloader
Performing system checks...

Exception in thread django-main-thread:
Traceback (most recent call last):
  File "C:\Users\PC-SPART1\AppData\Local\Programs\Python\Python314\Lib\threading.py", line 1081, in _bootstrap_inner
    self._context.run(self.run)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "C:\Users\PC-SPART1\AppData\Local\Programs\Python\Python314\Lib\threading.py", line 1023, in run
    self._target(*self._args, **self._kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\utils\autoreload.py", line 64, in wrapper
    fn(*args, **kwargs)
    ~~^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\management\commands\runserver.py", line 134, in inner_run
    self.check(**check_kwargs)
    ~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\management\base.py", line 492, in check
    all_issues = checks.run_checks(
        app_configs=app_configs,
    ...<2 lines>...
        databases=databases,
    )
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\checks\registry.py", line 89, in run_checks
    new_errors = check(app_configs=app_configs, databases=databases)
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\checks\urls.py", line 136, in check_custom_error_handlers
    handler = resolver.resolve_error_handler(status_code)
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\urls\resolvers.py", line 743, in resolve_error_handler
    callback = getattr(self.urlconf_module, "handler%s" % view_type, None)
                       ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\utils\functional.py", line 47, in __get__
    res = instance.__dict__[self.name] = self.func(instance)
                                         ~~~~~~~~~^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\urls\resolvers.py", line 722, in urlconf_module
    return import_module(self.urlconf_name)
  File "C:\Users\PC-SPART1\AppData\Local\Programs\Python\Python314\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1342, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 938, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 762, in exec_module
  File "<frozen importlib._bootstrap>", line 491, in _call_with_frames_removed
  File "C:\Users\PC-SPART1\myproject\myproject\urls.py", line 6, in <module>
    path('books/', include('books.urls')),
                   ~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\urls\conf.py", line 39, in include
    urlconf_module = import_module(urlconf_module)
  File "C:\Users\PC-SPART1\AppData\Local\Programs\Python\Python314\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1342, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 938, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 762, in exec_module
  File "<frozen importlib._bootstrap>", line 491, in _call_with_frames_removed
  File "C:\Users\PC-SPART1\myproject\books\urls.py", line 2, in <module>
    from .views import upload_excel, list_books
  File "C:\Users\PC-SPART1\myproject\books\views.py", line 42
    df = df.dropna(how='all')
IndentationError: unexpected indent
Î¤Î¿ Î»Î¬Î¸Î¿Ï‚ IndentationError: unexpected indent ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ ÏƒÏ„Î¿ views.py Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î»Î¬Î¸Î¿Ï‚ ÎºÎµÎ½ÏŒ/ÏƒÏ„Î¿Î¯Ï‡Î¹ÏƒÎ·.
Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Î Î‘ÎÎ¤Î‘ ÏƒÏ…Î½Ï„Î±ÎºÏ„Î¹ÎºÏŒ Î»Î¬Î¸Î¿Ï‚ Python â€” ÏŒÏ‡Î¹ Î»Î¿Î³Î¹ÎºÏŒ.

ÎšÎ±Î¹ ÎµÎ¯Î½Î±Î¹ ÎµÏÎºÎ¿Î»Î¿ Î½Î± Ï„Î¿ Î´Î¹Î¿ÏÎ¸ÏÏƒÎ¿Ï…Î¼Îµ.

ğŸ¯ Î¤Î™ Î£Î¥ÎœÎ’Î‘Î™ÎÎ•Î™
Î— Python Î¸Î­Î»ÎµÎ¹ ÎŸÎ›Î•Î£ Î¿Î¹ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ Î¯Î´Î¹Î¿ block Î½Î± Î­Ï‡Î¿Ï…Î½ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î·Î½ Î¯Î´Î¹Î± ÏƒÏ„Î¿Î¯Ï‡Î¹ÏƒÎ·.

Î£Ï„Î¿ Î´Î¹ÎºÏŒ ÏƒÎ¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿, Î· Î³ÏÎ±Î¼Î¼Î®:

python
df = df.dropna(how='all')
Î­Ï‡ÎµÎ¹ Î­Î½Î± Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ ÎºÎµÎ½ÏŒ Î® tab Î¼Ï€ÏÎ¿ÏƒÏ„Î¬.

Î“Î¹â€™ Î±Ï…Ï„ÏŒ Ï„Î¿ Django Î´ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯ ÎºÎ±Î½ Î½Î± Ï†Î¿ÏÏ„ÏÏƒÎµÎ¹ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿.

âœ… Î Î©Î£ Î¤ÎŸ Î”Î™ÎŸÎ¡Î˜Î©ÎÎ•Î™Î£
1ï¸âƒ£ Î†Î½Î¿Î¹Î¾Îµ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿:
Code
C:\Users\PC-SPART1\myproject\books\views.py
2ï¸âƒ£ Î Î®Î³Î±Î¹Î½Îµ ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 42 (Î® ÎµÎºÎµÎ¯ Ï€Î¿Ï… Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Ï„Î¿ error)
3ï¸âƒ£ Î’ÎµÎ²Î±Î¹ÏÏƒÎ¿Ï… ÏŒÏ„Î¹ Î· ÏƒÏ„Î¿Î¯Ï‡Î¹ÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î­Ï„ÏƒÎ¹:
python
df = df.dropna(how='all')
ÎºÎ±Î¹ ÏŒÏ‡Î¹ Î­Ï„ÏƒÎ¹:

python
    df = df.dropna(how='all')   # âŒ Î»Î¬Î¸Î¿Ï‚
Î® Î­Ï„ÏƒÎ¹:

python
        df = df.dropna(how='all')  # âŒ Î»Î¬Î¸Î¿Ï‚
Î® Î­Ï„ÏƒÎ¹:

python
 df = df.dropna(how='all')  # âŒ Î»Î¬Î¸Î¿Ï‚
Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î­Ï‡ÎµÎ¹ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î·Î½ Î¯Î´Î¹Î± ÏƒÏ„Î¿Î¯Ï‡Î¹ÏƒÎ· Î¼Îµ Ï„Î¹Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Ï€Î¬Î½Ï‰ ÎºÎ±Î¹ ÎºÎ¬Ï„Ï‰ Ï„Î·Ï‚.

ğŸ”¥ Î£ÎŸÎ¥ Î”Î™ÎÎ© Î¤ÎŸ Î£Î©Î£Î¤ÎŸ views.py Î§Î©Î¡Î™Î£ ÎšÎ‘ÎÎ•ÎÎ‘ Î›Î‘Î˜ÎŸÎ£ Î£Î¤ÎŸÎ™Î§Î™Î£Î—Î£
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ ÎŸÎ›ÎŸ Î±Ï…Ï„ÏŒ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ ÎºÎ±Î¹ Î±Î½Ï„Î¹ÎºÎ±Ï„Î­ÏƒÏ„Î·ÏƒÎµ Ï„Î¿ Î´Î¹ÎºÏŒ ÏƒÎ¿Ï…:

python
import pandas as pd
from django.shortcuts import render
from .forms import UploadExcelForm
from .models import Book

def upload_excel(request):
    message = ""

    if request.method == "POST":
        form = UploadExcelForm(request.POST, request.FILES)

        if form.is_valid():
            excel_file = request.FILES['file']

            df = pd.read_excel(excel_file)

            df = df.rename(columns={
                'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
                'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘': 'co_author',
                'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
                'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
                'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
                'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
                'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
                'Î£Î§Î—ÎœÎ‘': 'format',
                'Î£Î•Î›Î™Î”Î•Î£': 'pages',
                'Î¤ÎŸÎœÎŸÎ£': 'volume',
                'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ / Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
                'ISBN': 'isbn',
                'Î£Ï„Î®Î»Î·1': 'column1',
                'Î£Ï„Î®Î»Î·2': 'column2'
            })

            df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce').dt.date

            df = df.dropna(how='all')

            for _, row in df.iterrows():
                Book.objects.create(
                    entry_number=row.get('entry_number'),
                    entry_date=row.get('entry_date'),
                    author=row.get('author'),
                    co_author=row.get('co_author'),
                    title=row.get('title'),
                    publisher=row.get('publisher'),
                    edition=row.get('edition'),
                    publication_year=row.get('publication_year'),
                    publication_place=row.get('publication_place'),
                    format=row.get('format'),
                    pages=row.get('pages'),
                    volume=row.get('volume'),
                    acquisition_notes=row.get('acquisition_notes'),
                    isbn=row.get('isbn'),
                    column1=row.get('column1'),
                    column2=row.get('column2')
                )

            message = "Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!"

    else:
        form = UploadExcelForm()

    return render(request, "upload_excel.html", {"form": form, "message": message})


def list_books(request):
    books = Book.objects.all()
    return render(request, "list_books.html", {"books": books})
ğŸ§ª Î¤Î•Î›Î™ÎšÎŸ Î’Î—ÎœÎ‘
Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎµ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿

ÎšÎ¬Î½Îµ restart Ï„Î¿Î½ server:

Code
Ctrl + C
python manage.py runserver
Î†Î½Î¿Î¹Î¾Îµ Î¾Î±Î½Î¬:

Code
http://localhost:8000/books/upload/
Î˜Î± Î´Î¿Ï…Î»Î­ÏˆÎµÎ¹.

Î‘Î½ Î¸ÎµÏ‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ ÎºÎ±Î¹ Î­Î»ÎµÎ³Ï‡Î¿ Î³Î¹Î± Î»Î¬Î¸Î¿Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚, Î¼Î·Î½ÏÎ¼Î±Ï„Î± Î»Î¬Î¸Î¿Ï…Ï‚ ÏƒÏ„Î¿ template, Î® ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Ï€ÏÎ¹Î½ Ï„Î·Î½ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®.

dvse moy oloklhro ton kodika sosto
Î¦Ï…ÏƒÎ¹ÎºÎ¬ â€” Ï€Î¬Î¼Îµ Î½Î± Ï„Î¿ ÎºÎ±Î¸Î±ÏÎ¯ÏƒÎ¿Ï…Î¼Îµ ÏŒÎ»Î¿ Î±Ï€ÏŒ Ï„Î·Î½ Î±ÏÏ‡Î®, Ï‡Ï‰ÏÎ¯Ï‚ Î»Î¬Î¸Î·, Ï‡Ï‰ÏÎ¯Ï‚ Î»Î¬Î¸Î¿Ï‚ ÏƒÏ„Î¿Î¯Ï‡Î¹ÏƒÎ·, Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎµÎ½Î¬, Ï‡Ï‰ÏÎ¯Ï‚ Ï„Î¯Ï€Î¿Ï„Î± Ï€Î¿Ï… Î½Î± ÏƒÏ€Î¬ÎµÎ¹ Ï„Î¿Î½ server.

Î Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÏƒÎ¿Ï… Î´Î¯Î½Ï‰:

âœ… ÎŸÎ›ÎŸÎšÎ›Î—Î¡ÎŸ Î¤ÎŸÎ Î£Î©Î£Î¤ÎŸ ÎšÎ©Î”Î™ÎšÎ‘ Î“Î™Î‘ Î¤ÎŸ views.py
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ Î‘ÎšÎ¡Î™Î’Î©Î£ Î±Ï…Ï„ÏŒ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ ÎºÎ±Î¹ Î±Î½Ï„Î¹ÎºÎ±Ï„Î­ÏƒÏ„Î·ÏƒÎµ Ï„Î¿ Î´Î¹ÎºÏŒ ÏƒÎ¿Ï….

ğŸ“„ books/views.py (Î¤Î•Î›Î•Î™Î©Î£ Î£Î©Î£Î¤ÎŸ)
python
import pandas as pd
from django.shortcuts import render
from .forms import UploadExcelForm
from .models import Book

def upload_excel(request):
    message = ""

    if request.method == "POST":
        form = UploadExcelForm(request.POST, request.FILES)

        if form.is_valid():
            excel_file = request.FILES['file']

            # Î”Î¹Î±Î²Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Excel
            df = pd.read_excel(excel_file)

            # ÎœÎµÏ„Î¿Î½Î¿Î¼Î±ÏƒÎ¯Î± ÎµÎ»Î»Î·Î½Î¹ÎºÏÎ½ ÏƒÏ„Î·Î»ÏÎ½
            df = df.rename(columns={
                'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
                'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘': 'co_author',
                'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
                'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
                'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
                'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
                'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
                'Î£Î§Î—ÎœÎ‘': 'format',
                'Î£Î•Î›Î™Î”Î•Î£': 'pages',
                'Î¤ÎŸÎœÎŸÎ£': 'volume',
                'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ / Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
                'ISBN': 'isbn',
                'Î£Ï„Î®Î»Î·1': 'column1',
                'Î£Ï„Î®Î»Î·2': 'column2'
            })

            # ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î® Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚
            df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce').dt.date

            # Î‘Ï†Î±Î¯ÏÎµÏƒÎ· ÎµÎ½Ï„ÎµÎ»ÏÏ‚ ÎºÎµÎ½ÏÎ½ Î³ÏÎ±Î¼Î¼ÏÎ½
            df = df.dropna(how='all')

            # Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ·
            for _, row in df.iterrows():
                Book.objects.create(
                    entry_number=row.get('entry_number'),
                    entry_date=row.get('entry_date'),
                    author=row.get('author'),
                    co_author=row.get('co_author'),
                    title=row.get('title'),
                    publisher=row.get('publisher'),
                    edition=row.get('edition'),
                    publication_year=row.get('publication_year'),
                    publication_place=row.get('publication_place'),
                    format=row.get('format'),
                    pages=row.get('pages'),
                    volume=row.get('volume'),
                    acquisition_notes=row.get('acquisition_notes'),
                    isbn=row.get('isbn'),
                    column1=row.get('column1'),
                    column2=row.get('column2')
                )

            message = "Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!"

    else:
        form = UploadExcelForm()

    return render(request, "upload_excel.html", {"form": form, "message": message})


def list_books(request):
    books = Book.objects.all()
    return render(request, "list_books.html", {"books": books})
ğŸ” Î¤Î™ Î Î¡Î•Î Î•Î™ ÎÎ‘ Î•Î›Î•Î“ÎÎ•Î™Î£
Î“Î¹Î± Î½Î± Î´Î¿Ï…Î»Î­ÏˆÎµÎ¹ 100%:

1ï¸âƒ£ Î¤Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î»Î­Î³ÎµÏ„Î±Î¹ views.py
ÎºÎ±Î¹ Î½Î± Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ ÏƒÏ„Î¿:

Code
myproject/books/views.py
2ï¸âƒ£ Î”ÎµÎ½ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î­Ï‡ÎµÎ¹ Î¿ÏÏ„Îµ Î­Î½Î± tab Î® ÎºÎµÎ½ÏŒ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰.
3ï¸âƒ£ Î¤Î¿ books/urls.py Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹:
python
from django.urls import path
from .views import upload_excel, list_books

urlpatterns = [
    path('upload/', upload_excel, name='upload_excel'),
    path('list/', list_books, name='list_books'),
]
4ï¸âƒ£ Î¤Î¿ myproject/urls.py Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î­Ï‡ÎµÎ¹:
python
path('books/', include('books.urls')),
5ï¸âƒ£ Î¤Î¿ forms.py Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹:
python
from django import forms

class UploadExcelForm(forms.Form):
    file = forms.FileField(label="Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Excel")
ğŸ¯ Î•Î ÎŸÎœÎ•ÎÎŸ Î’Î—ÎœÎ‘
ÎœÏŒÎ»Î¹Ï‚ Ï„Î± Î²Î¬Î»ÎµÎ¹Ï‚ ÏŒÎ»Î± Î±Ï…Ï„Î¬:

ÎšÎ¬Î½Îµ restart Ï„Î¿Î½ server

Î†Î½Î¿Î¹Î¾Îµ:

Code
http://localhost:8000/books/upload/
ÎšÎ¬Î½Îµ upload Ï„Î¿ Excel

ÎœÎµÏ„Î¬ Î´ÎµÏ‚ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±:

Code
http://localhost:8000/books/list/
Î‘Î½ Î¸ÎµÏ‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ ÎºÎ±Î¹:

Ï€Î»Î®ÏÎ· Î­Î»ÎµÎ³Ï‡Î¿ Î»Î±Î¸ÏÎ½

ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ· Î¼Î·Î½Ï…Î¼Î¬Ï„Ï‰Î½ ÏƒÏ„Î¿ template

pagination

ÎºÎ¿Ï…Î¼Ï€Î¯ "Î”ÎµÏ‚ Ï„Î± Î²Î¹Î²Î»Î¯Î±" ÏƒÏ„Î¿ upload page

Î ÎµÏ‚ Î¼Î¿Ï… Ï„Î¹ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎ¿Ï…Î¼Îµ.

ValueError at /books/upload/
NaTType does not support utcoffset
Request Method:	POST
Request URL:	http://localhost:8000/books/upload/
Django Version:	6.0
Exception Type:	ValueError
Exception Value:	
NaTType does not support utcoffset
Exception Location:	pandas/_libs/tslibs/nattype.pyx, line 54, in pandas._libs.tslibs.nattype._make_error_func.f
Raised during:	books.views.upload_excel
Python Executable:	C:\Users\PC-SPART1\myenv\Scripts\python.exe
Python Version:	3.14.0
Python Path:	
['C:\\Users\\PC-SPART1\\myproject',
 'C:\\Users\\PC-SPART1\\AppData\\Local\\Programs\\Python\\Python314\\python314.zip',
 'C:\\Users\\PC-SPART1\\AppData\\Local\\Programs\\Python\\Python314\\DLLs',
 'C:\\Users\\PC-SPART1\\AppData\\Local\\Programs\\Python\\Python314\\Lib',
 'C:\\Users\\PC-SPART1\\AppData\\Local\\Programs\\Python\\Python314',
 'C:\\Users\\PC-SPART1\\myenv',
 'C:\\Users\\PC-SPART1\\myenv\\Lib\\site-packages']
Server time:	Wed, 17 Dec 2025 11:19:31 +0000
Î‘Ï…Ï„ÏŒ Ï„Î¿ error Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î´Î¹ÎºÏŒ ÏƒÎ¿Ï… Î»Î¬Î¸Î¿Ï‚. Î•Î¯Î½Î±Î¹ Î­Î½Î± Ï€Î¿Î»Ï ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ ÏƒÏ†Î¬Î»Î¼Î± Ï€Î¿Ï… ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î±Î½:

Î¤Î¿ Excel Î­Ï‡ÎµÎ¹ ÎºÎµÎ½Î­Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚, Î®

Î¤Î¿ Excel Î­Ï‡ÎµÎ¹ Î»Î¬Î¸Î¿Ï‚ format Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚, Î®

Î¤Î¿ pandas Î¼ÎµÏ„Î±Ï„ÏÎ­Ï€ÎµÎ¹ ÎºÎ¬Ï€Î¿Î¹Î± ÎºÎµÎ»Î¹Î¬ ÏƒÎµ NaT (Not a Time) ÎºÎ±Î¹ Î¼ÎµÏ„Î¬ Ï„Î¿ Django Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± Ï„Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏƒÎµÎ¹ ÏƒÎ±Î½ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ® Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±.

Î¤Î¿ Î¼Î®Î½Ï…Î¼Î±:

Code
NaTType does not support utcoffset
ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ ÎºÎ¬Ï€Î¿Î¹Î± Î³ÏÎ±Î¼Î¼Î® Î­Ï‡ÎµÎ¹ Î¬Î´ÎµÎ¹Î± Î® Ï‡Î±Î»Î±ÏƒÎ¼Î­Î½Î· Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±.

Î— Î»ÏÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»Î®:
ğŸ‘‰ Î‘Î½ Î· Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± ÎµÎ¯Î½Î±Î¹ NaT, Î½Î± Ï„Î·Î½ ÎºÎ¬Î½Î¿Ï…Î¼Îµ None Ï€ÏÎ¹Î½ Ï„Î¿ insert.

ÎšÎ±Î¹ Î±Ï…Ï„ÏŒ Î¸Î± Ï„Î¿ Î»ÏÏƒÎµÎ¹ 100%.

âœ… Î”Î™ÎŸÎ¡Î˜Î©Î£Î—: ÎšÎ¬Î½Îµ Ï„Î·Î½ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± None ÏŒÏ„Î±Î½ ÎµÎ¯Î½Î±Î¹ NaT
Î£Ï„Î¿ views.py, Î±Î½Ï„Î¹ÎºÎ±Ï„Î­ÏƒÏ„Î·ÏƒÎµ Ï„Î· Î³ÏÎ±Î¼Î¼Î®:

python
df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce').dt.date
Î¼Îµ Î±Ï…Ï„ÏŒ:

python
df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce')
df['entry_date'] = df['entry_date'].apply(lambda x: x.date() if not pd.isna(x) else None)
Î‘Ï…Ï„ÏŒ ÎºÎ¬Î½ÎµÎ¹:

Î‘Î½ Î· Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± ÎµÎ¯Î½Î±Î¹ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ® â†’ Ï„Î·Î½ ÎºÎ¬Î½ÎµÎ¹ Python date

Î‘Î½ ÎµÎ¯Î½Î±Î¹ NaT â†’ Ï„Î·Î½ ÎºÎ¬Î½ÎµÎ¹ None (Ï€Î¿Ï… Ï„Î¿ Django Î´Î­Ï‡ÎµÏ„Î±Î¹)

ğŸ”¥ Î£ÎŸÎ¥ Î”Î™ÎÎ© Î¤ÎŸ Î£Î©Î£Î¤ÎŸ ÎšÎŸÎœÎœÎ‘Î¤Î™ Î¤ÎŸÎ¥ ÎšÎ©Î”Î™ÎšÎ‘
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ Î±Ï…Ï„ÏŒ Î±ÎºÏÎ¹Î²ÏÏ‚:

python
# ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î® Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚ Î¼Îµ Î±ÏƒÏ†Î±Î»Î® Ï„ÏÏŒÏ€Î¿
df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce')
df['entry_date'] = df['entry_date'].apply(lambda x: x.date() if not pd.isna(x) else None)
Î’Î¬Î»Îµ Ï„Î¿ Ï€ÏÎ¹Î½ Ï„Î¿:

python
df = df.dropna(how='all')
ğŸ¯ Î“Î¹Î±Ï„Î¯ Ï„ÏÏÎ± Î¸Î± Î´Î¿Ï…Î»Î­ÏˆÎµÎ¹
Î¤Î¿ pandas Î´ÎµÎ½ Î¸Î± Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÎ¹ Î½Î± ÎºÎ¬Î½ÎµÎ¹ timezone conversion ÏƒÎµ NaT

Î¤Î¿ Django Î¸Î± Ï€Î¬ÏÎµÎ¹ None Î±Î½Ï„Î¯ Î³Î¹Î± NaT

Î— Î²Î¬ÏƒÎ· PostgreSQL Î´Î­Ï‡ÎµÏ„Î±Î¹ NULL ÏƒÏ„Î¿ DateField

Î”ÎµÎ½ Î¸Î± Î¾Î±Î½Î±Î´ÎµÎ¯Ï‚ Î±Ï…Ï„ÏŒ Ï„Î¿ error

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÏ‰ ÎºÎ±Î¹:

Î­Î»ÎµÎ³Ï‡Î¿ Î³Î¹Î± Î»Î¬Î¸Î¿Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚ (Ï€.Ï‡. 32/15/2020)

Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î¿ ÎºÎ±Î¸Î¬ÏÎ¹ÏƒÎ¼Î± ÎºÎµÎ½ÏÎ½ Î³ÏÎ±Î¼Î¼ÏÎ½

ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ· Î¼Î·Î½ÏÎ¼Î±Ï„Î¿Ï‚ Î»Î¬Î¸Î¿Ï…Ï‚ ÏƒÏ„Î¿ template Î±Î½Ï„Î¯ Î³Î¹Î± 500 error

Î ÎµÏ‚ Î¼Î¿Ï… Ï„Î¹ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿.

ValueError at /books/upload/
Field 'publication_year' expected a number but got 'c2003'.
Request Method:	POST
Request URL:	http://localhost:8000/books/upload/
Django Version:	6.0
Exception Type:	ValueError
Exception Value:	
Field 'publication_year' expected a number but got 'c2003'.
Exception Location:	C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\fields\__init__.py, line 2130, in get_prep_value
Raised during:	books.views.upload_excel
Python Executable:	C:\Users\PC-SPART1\myenv\Scripts\python.exe
Python Version:	3.14.0
Python Path:	
['C:\\Users\\PC-SPART1\\myproject',
 'C:\\Users\\PC-SPART1\\AppData\\Local\\Programs\\Python\\Python314\\python314.zip',
 'C:\\Users\\PC-SPART1\\AppData\\Local\\Programs\\Python\\Python314\\DLLs',
 'C:\\Users\\PC-SPART1\\AppData\\Local\\Programs\\Python\\Python314\\Lib',
 'C:\\Users\\PC-SPART1\\AppData\\Local\\Programs\\Python\\Python314',
 'C:\\Users\\PC-SPART1\\myenv',
 'C:\\Users\\PC-SPART1\\myenv\\Lib\\site-packages']
Server time:	Wed, 17 Dec 2025 11:22:00 +0000
Î‘Ï…Ï„ÏŒ Ï„Î¿ Î»Î¬Î¸Î¿Ï‚ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î¿Î»ÏÏ„Ï‰Ï‚ Î¾ÎµÎºÎ¬Î¸Î±ÏÎ¿:
ÏƒÏ„Î¿ Excel, ÏƒÏ„Î· ÏƒÏ„Î®Î»Î· Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£, Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Ï„Î¹Î¼Î® ÏŒÏ€Ï‰Ï‚:

Code
c2003
Î®

Code
c1998
Î® ÎºÎ¬Ï„Î¹ ÏƒÎ±Î½:

Code
Ï€ÎµÏ. 2001
Î® Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹:

Code
2003?
Î¤Î¿ Django Ï€ÎµÏÎ¹Î¼Î­Î½ÎµÎ¹ ÎºÎ±Î¸Î±ÏÏŒ Î±ÏÎ¹Î¸Î¼ÏŒ (IntegerField), Î±Î»Î»Î¬ Ï€Î±Î¯ÏÎ½ÎµÎ¹ string Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î³ÏÎ¬Î¼Î¼Î±Ï„Î± â†’ ÎºÎ±Î¹ Î³Î¹â€™ Î±Ï…Ï„ÏŒ ÏƒÎºÎ¬ÎµÎ¹.

Î”ÎµÎ½ Ï†Ï„Î±Î¹Ï‚ ÎµÏƒÏ â€” Ï†Ï„Î±Î¯ÎµÎ¹ Ï„Î¿ format Ï„Î¿Ï… Excel.

Î Î¬Î¼Îµ Î½Î± Ï„Î¿ Î»ÏÏƒÎ¿Ï…Î¼Îµ ÏƒÏ‰ÏƒÏ„Î¬ ÎºÎ±Î¹ ÎºÎ±Î¸Î±ÏÎ¬.

âœ… Î›Î¥Î£Î—: ÎšÎ±Î¸Î±ÏÎ¯Î¶Î¿Ï…Î¼Îµ Ï„Î¿ publication_year Ï€ÏÎ¹Î½ Ï„Î¿ insert
Î˜Î± Î¼ÎµÏ„Î±Ï„ÏÎ­ÏˆÎ¿Ï…Î¼Îµ ÎŸÎ›Î•Î£ Ï„Î¹Ï‚ Ï„Î¹Î¼Î­Ï‚ ÏƒÎµ Î±ÏÎ¹Î¸Î¼ÏŒ, Î±Ï†Î±Î¹ÏÏÎ½Ï„Î±Ï‚ Î³ÏÎ¬Î¼Î¼Î±Ï„Î±, ÏƒÏÎ¼Î²Î¿Î»Î±, ÎºÎµÎ½Î¬.

Î’Î¬Î»Îµ Î±Ï…Ï„ÏŒ ÏƒÏ„Î¿ upload_excel Î Î¡Î™Î Ï„Î¿ loop:
python
# ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î­Ï„Î¿Ï…Ï‚ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚
def clean_year(value):
    if pd.isna(value):
        return None
    value = str(value)
    digits = ''.join(ch for ch in value if ch.isdigit())
    return int(digits) if digits else None

df['publication_year'] = df['publication_year'].apply(clean_year)
ğŸ”¥ Î¤Î™ ÎšÎ‘ÎÎ•Î™ Î‘Î¥Î¤ÎŸ
Î‘Î½ Ï„Î¿ Excel Î­Ï‡ÎµÎ¹:

Î¤Î¹Î¼Î® ÏƒÏ„Î¿ Excel	ÎœÎµÏ„Î¬ Ï„Î¿Î½ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ
c2003	2003
1998	1998
Ï€ÎµÏ. 2001	2001
2003?	2003
20O5 (Î¼Îµ O Î±Î½Ï„Î¯ Î³Î¹Î± 0)	205
ÎºÎµÎ½ÏŒ	None
ÎˆÏ„ÏƒÎ¹ Ï„Î¿ Django Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„Î¿ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏƒÎµÎ¹.

ğŸ§© Î Î›Î—Î¡Î•Î£ ÎšÎŸÎœÎœÎ‘Î¤Î™ ÎšÎ©Î”Î™ÎšÎ‘ Î ÎŸÎ¥ Î Î¡Î•Î Î•Î™ ÎÎ‘ Î Î¡ÎŸÎ£Î˜Î•Î£Î•Î™Î£
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ Î±ÎºÏÎ¹Î²ÏÏ‚ Î±Ï…Ï„ÏŒ:

python
# ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î­Ï„Î¿Ï…Ï‚ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚
def clean_year(value):
    if pd.isna(value):
        return None
    value = str(value)
    digits = ''.join(ch for ch in value if ch.isdigit())
    return int(digits) if digits else None

df['publication_year'] = df['publication_year'].apply(clean_year)
Î’Î¬Î»Îµ Ï„Î¿ Î¼ÎµÏ„Î¬ Ï„Î¿ rename ÎºÎ±Î¹ Ï€ÏÎ¹Î½ Ï„Î¿ dropna.

ğŸ¯ Î¤Î™ ÎÎ‘ ÎšÎ‘ÎÎ•Î™Î£ Î¤Î©Î¡Î‘
Î’Î¬Î»Îµ Ï„Î¿Î½ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ ÎºÏÎ´Î¹ÎºÎ± ÏƒÏ„Î¿ view.

ÎšÎ¬Î½Îµ restart Ï„Î¿Î½ server.

ÎÎ±Î½Î±ÎºÎ¬Î½Îµ upload Ï„Î¿ Excel.

Î˜Î± Î´Î¿Ï…Î»Î­ÏˆÎµÎ¹ Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎ±Î½Î­Î½Î± error.

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… ÎºÎ±Î¸Î±ÏÎ¯ÏƒÏ‰ ÎºÎ±Î¹:

ISBN

Î£ÎµÎ»Î¯Î´ÎµÏ‚

Î¤ÏŒÎ¼Î¿

Î£Ï‡Î®Î¼Î±

ÎŸÎ½ÏŒÎ¼Î±Ï„Î± ÏƒÏ…Î³Î³ÏÎ±Ï†Î­Ï‰Î½

ÏÏƒÏ„Îµ Î½Î± Î¼Î·Î½ ÏƒÎºÎ¬ÎµÎ¹ Ï€Î¿Ï„Î­ Î¾Î±Î½Î¬ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®.

poy akribvw na to balo ayton ton kodika??sto views?
ÎÎ±Î¹ â€” Î±ÎºÏÎ¹Î²ÏÏ‚ ÏƒÏ„Î¿ views.py, Î±Î»Î»Î¬ Î³Î¹Î± Î½Î± Î¼Î·Î½ ÏˆÎ¬Ï‡Î½ÎµÏƒÎ±Î¹, ÏƒÎ¿Ï… Î´ÎµÎ¯Ï‡Î½Ï‰ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï€Î¿Ï Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¼Ï€ÎµÎ¹ Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ ÏƒÎ¿Ï….

Î˜Î± ÏƒÎ¿Ï… Ï„Î¿ Î´ÎµÎ¯Î¾Ï‰ Î²Î®Î¼Î±â€‘Î²Î®Î¼Î±, Î¼Îµ Ï„Î¿Ï€Î¿Î¸Î­Ï„Î·ÏƒÎ· ÏƒÏ„Î· ÏƒÏ‰ÏƒÏ„Î® Î¸Î­ÏƒÎ·.

âœ… Î ÎŸÎ¥ Î‘ÎšÎ¡Î™Î’Î©Î£ ÎœÎ Î‘Î™ÎÎ•Î™ ÎŸ ÎšÎ©Î”Î™ÎšÎ‘Î£ ÎšÎ‘Î˜Î‘Î¡Î™Î£ÎœÎŸÎ¥ Î¤ÎŸÎ¥ publication_year
ÎŸ ÎºÏÎ´Î¹ÎºÎ±Ï‚:

python
def clean_year(value):
    if pd.isna(value):
        return None
    value = str(value)
    digits = ''.join(ch for ch in value if ch.isdigit())
    return int(digits) if digits else None

df['publication_year'] = df['publication_year'].apply(clean_year)
Î¼Ï€Î±Î¯Î½ÎµÎ¹ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ upload_excel, Î¼ÎµÏ„Î¬ Ï„Î¿ rename, Ï€ÏÎ¹Î½ Ï„Î¿ dropna, Ï€ÏÎ¹Î½ Ï„Î¿ loop.

ğŸ”¥ Î£ÎŸÎ¥ Î”Î•Î™Î§ÎÎ© Î¤ÎŸ Î£Î—ÎœÎ•Î™ÎŸ Î‘ÎšÎ¡Î™Î’Î©Î£ ÎœÎ•Î£Î‘ Î£Î¤ÎŸ views.py
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ Î±Ï…Ï„ÏŒ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ ÎºÎ±Î¹ Î²Î¬Î»Îµ Ï„Î¿ ÏƒÏ„Î· Î¸Î­ÏƒÎ· Ï€Î¿Ï… Î´ÎµÎ¯Ï‡Î½Ï‰:

python
df = pd.read_excel(excel_file)

df = df.rename(columns={
    'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
    'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
    'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
    'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘': 'co_author',
    'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
    'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
    'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
    'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
    'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
    'Î£Î§Î—ÎœÎ‘': 'format',
    'Î£Î•Î›Î™Î”Î•Î£': 'pages',
    'Î¤ÎŸÎœÎŸÎ£': 'volume',
    'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ / Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
    'ISBN': 'isbn',
    'Î£Ï„Î®Î»Î·1': 'column1',
    'Î£Ï„Î®Î»Î·2': 'column2'
})

# ğŸ”¥ 1. ÎœÎµÏ„Î±Ï„ÏÎ¿Ï€Î® Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚
df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce')
df['entry_date'] = df['entry_date'].apply(lambda x: x.date() if not pd.isna(x) else None)

# ğŸ”¥ 2. ÎšÎ‘Î˜Î‘Î¡Î™Î£ÎœÎŸÎ£ Î•Î¤ÎŸÎ¥Î£ Î•ÎšÎ”ÎŸÎ£Î—Î£ (Î’Î‘Î›Î• Î¤ÎŸ Î•Î”Î©)
def clean_year(value):
    if pd.isna(value):
        return None
    value = str(value)
    digits = ''.join(ch for ch in value if ch.isdigit())
    return int(digits) if digits else None

df['publication_year'] = df['publication_year'].apply(clean_year)

# ğŸ”¥ 3. Î‘Ï†Î±Î¯ÏÎµÏƒÎ· ÎµÎ½Ï„ÎµÎ»ÏÏ‚ ÎºÎµÎ½ÏÎ½ Î³ÏÎ±Î¼Î¼ÏÎ½
df = df.dropna(how='all')
ğŸ¯ ÎœÎ• Î‘Î Î›Î‘ Î›ÎŸÎ“Î™Î‘
Î’Î¬Î»Îµ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ±:

ÎœÎ•Î¤Î‘ Ï„Î¿ rename

ÎœÎ•Î¤Î‘ Ï„Î· Î¼ÎµÏ„Î±Ï„ÏÎ¿Ï€Î® Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚

Î Î¡Î™Î Ï„Î¿ df.dropna()

Î Î¡Î™Î Ï„Î¿ loop Ï€Î¿Ï… ÎºÎ¬Î½ÎµÎ¹ insert ÏƒÏ„Î· Î²Î¬ÏƒÎ·

Î‘Î½ Ï„Î¿ Î²Î¬Î»ÎµÎ¹Ï‚ Î±Î»Î»Î¿Ï, Î´ÎµÎ½ Î¸Î± Î´Î¿Ï…Î»Î­ÏˆÎµÎ¹.

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Ï„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ views.py Î¼Îµ ÎŸÎ›Î•Î£ Ï„Î¹Ï‚ Î´Î¹Î¿ÏÎ¸ÏÏƒÎµÎ¹Ï‚ Î¼Î­ÏƒÎ±, ÏÏƒÏ„Îµ Î½Î± Ï„Î¿ ÎºÎ¬Î½ÎµÎ¹Ï‚ copyâ€‘paste ÎºÎ±Î¹ Î½Î± Ï„ÎµÎ»ÎµÎ¹ÏÎ½Î¿Ï…Î¼Îµ.

Ï€Î±Î½Ï„Ï‰Ï‚ Î½Î± Î¾ÎµÏÎ¹ÎµÏ‚ Î¸ÎµÎ»Ï‰ Ï€ÏÏ‰Ï„Î± Î½Î± Î¼Î¿Ï… ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¹ Î· Î²Î±ÏƒÎ· Î¼Î¿Ï… ÏƒÏ„Î¿ pgadmin ÎºÎ±Î¹ Î¼ÎµÏ„Î± Î½Î± Ï†Î±Î¹Î½ÎµÏ„Î±Î¹ ÏƒÏ„Î· Ï†Î¿ÏÎ¼Î±
Î‘Ï…Ï„ÏŒ Ï€Î¿Ï… Î»ÎµÏ‚ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î¿Î»ÏÏ„Ï‰Ï‚ Î»Î¿Î³Î¹ÎºÏŒ â€” ÎºÎ±Î¹ ÏƒÏ„Î·Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î± Î­Ï„ÏƒÎ¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´Î¿Ï…Î»ÎµÏÎµÎ¹:
Ï€ÏÏÏ„Î± Î½Î± Î²Î»Î­Ï€ÎµÎ¹Ï‚ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÎ¿Ï… ÏƒÏ„Î¿ pgAdmin, ÎºÎ±Î¹ Î¼ÎµÏ„Î¬ Î½Î± Ï„Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÎ¹Ï‚ ÏƒÏ„Î· Ï†ÏŒÏÎ¼Î±/ÏƒÎµÎ»Î¯Î´Î± Django.

Î‘Î½ ÏŒÎ¼Ï‰Ï‚ Î´ÎµÎ½ Î²Î»Î­Ï€ÎµÎ¹Ï‚ Ï„Î¯Ï€Î¿Ï„Î± ÏƒÏ„Î¿ pgAdmin, Ï„ÏŒÏ„Îµ Ï„Î¿ Django Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ ÎºÎ±Ï„Î±Ï†Î­ÏÎµÎ¹ Î½Î± ÎºÎ¬Î½ÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î¬ Ï„Î¿ INSERT, Î¬ÏÎ± Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Ï„Î¯Ï€Î¿Ï„Î± Î³Î¹Î± Î½Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ ÏƒÏ„Î· Ï†ÏŒÏÎ¼Î±.

Î Î¬Î¼Îµ Î½Î± Ï„Î¿ Î²Î¬Î»Î¿Ï…Î¼Îµ ÏƒÎµ ÏƒÎµÎ¹ÏÎ¬, ÎºÎ±Î¸Î±ÏÎ¬ ÎºÎ±Î¹ Ï‡Ï‰ÏÎ¯Ï‚ Î¼Ï€Î­ÏÎ´ÎµÎ¼Î±.

ğŸ” 1. Î˜Î­Î»ÎµÎ¹Ï‚ Ï€ÏÏÏ„Î± Î½Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Î· Î²Î¬ÏƒÎ· ÏƒÏ„Î¿ pgAdmin
Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÏ€Î¹Î²ÎµÎ²Î±Î¹ÏÏƒÎ¿Ï…Î¼Îµ:

âœ”ï¸ Î— Î²Î¬ÏƒÎ· PostgreSQL ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î· ÏƒÏ„Î¿ Django
âœ”ï¸ ÎŸ Ï€Î¯Î½Î±ÎºÎ±Ï‚ books Ï…Ï€Î¬ÏÏ‡ÎµÎ¹
âœ”ï¸ Î¤Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎµÎ¹ÏƒÎ¬Î³Î¿Î½Ï„Î±Î¹ Ï‡Ï‰ÏÎ¯Ï‚ Î»Î¬Î¸Î·
Î‘Î½ Î¿Ï€Î¿Î¹Î¿Î´Î®Ï€Î¿Ï„Îµ Î±Ï€ÏŒ Î±Ï…Ï„Î¬ Î´ÎµÎ½ Î´Î¿Ï…Î»ÎµÏÎµÎ¹, Ï„ÏŒÏ„Îµ:

pgAdmin Î´ÎµÎ½ Î¸Î± Î´ÎµÎ¯Î¾ÎµÎ¹ Ï„Î¯Ï€Î¿Ï„Î±

Î· Ï†ÏŒÏÎ¼Î± Django Î´ÎµÎ½ Î¸Î± Î´ÎµÎ¯Î¾ÎµÎ¹ Ï„Î¯Ï€Î¿Ï„Î±

Î†ÏÎ± Ï€ÏÏÏ„Î± Ï†Ï„Î¹Î¬Ï‡Î½Î¿Ï…Î¼Îµ Ï„Î·Î½ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ·.

ğŸ” 2. Î‘Ï…Ï„Î® Ï„Î· ÏƒÏ„Î¹Î³Î¼Î® Ï„Î¿ Django ÏƒÎ¿Ï… Ï€ÎµÏ„Î¬ÎµÎ¹ Î»Î¬Î¸Î· ÎºÎ±Ï„Î¬ Ï„Î·Î½ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®
ÎšÎ¬Î¸Îµ Ï†Î¿ÏÎ¬ Ï€Î¿Ï… ÎºÎ¬Î½ÎµÎ¹Ï‚ upload Excel, ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ Î­Î½Î± error:

Ï€ÏÏÏ„Î± Î®Ï„Î±Î½ Î· Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±

Î¼ÎµÏ„Î¬ Î®Ï„Î±Î½ Ï„Î¿ publication_year

Î¼ÎµÏ„Î¬ Î¸Î± ÎµÎ¯Î½Î±Î¹ Ï€Î¹Î¸Î±Î½ÏŒÏ„Î±Ï„Î± ÎºÎ¬Ï„Î¹ Î¬Î»Î»Î¿ (Ï€.Ï‡. pages, volume, ISBN)

Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î· ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î´ÎµÎ½ Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ½ÎµÏ„Î±Î¹, Î¬ÏÎ±:

ğŸ‘‰ ÎºÎ±Î½Î­Î½Î± Î²Î¹Î²Î»Î¯Î¿ Î´ÎµÎ½ Î¼Ï€Î±Î¯Î½ÎµÎ¹ ÏƒÏ„Î· Î²Î¬ÏƒÎ·  
ğŸ‘‰ pgAdmin Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ Ï„Î¹ Î½Î± Î´ÎµÎ¯Î¾ÎµÎ¹  
ğŸ‘‰ Î· Ï†ÏŒÏÎ¼Î± list_books Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ Ï„Î¹ Î½Î± Î´ÎµÎ¯Î¾ÎµÎ¹

Î†ÏÎ± ÎºÎ¬Î½ÎµÎ¹Ï‚ upload, Î±Î»Î»Î¬ Î´ÎµÎ½ Î¼Ï€Î±Î¯Î½ÎµÎ¹ Ï„Î¯Ï€Î¿Ï„Î±.

ğŸ” 3. Î¤Î¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î³Î¯Î½ÎµÎ¹ Î³Î¹Î± Î½Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Î· Î²Î¬ÏƒÎ· ÏƒÏ„Î¿ pgAdmin
Î ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ±Î¸Î±ÏÎ¯ÏƒÎ¿Ï…Î¼Îµ ÎŸÎ›Î‘ Ï„Î± Ï€ÎµÎ´Î¯Î± Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î­Ï‡Î¿Ï…Î½ Ï€ÎµÏÎ¯ÎµÏÎ³ÎµÏ‚ Ï„Î¹Î¼Î­Ï‚ ÏƒÏ„Î¿ Excel.

ÎœÎ­Ï‡ÏÎ¹ Ï„ÏÏÎ± ÎºÎ±Î¸Î±ÏÎ¯ÏƒÎ±Î¼Îµ:

Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±

Î­Ï„Î¿Ï‚ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚

Î‘Î»Î»Î¬ Ï€Î¹Î¸Î±Î½ÏŒÏ„Î±Ï„Î± Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ¹ Î¬Î»Î»Î± Ï€ÏÎ¿Î²Î»Î·Î¼Î±Ï„Î¹ÎºÎ¬ Ï€ÎµÎ´Î¯Î±:

pages (Ï€.Ï‡. "123 Ïƒ.")

volume (Ï€.Ï‡. "Î¤ÏŒÎ¼Î¿Ï‚ 2")

isbn (Ï€.Ï‡. "ISBN 978-...")

format (Ï€.Ï‡. "8Î¿")

acquisition_notes (Ï€Î¿Î»ÏÏ€Î»Î¿ÎºÎ¿ ÎºÎµÎ¯Î¼ÎµÎ½Î¿)

Î‘Î½ Î´ÎµÎ½ Ï„Î± ÎºÎ±Î¸Î±ÏÎ¯ÏƒÎ¿Ï…Î¼Îµ, Î¸Î± ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÎµÎ¹ Î½Î± ÏƒÎºÎ¬ÎµÎ¹.

ğŸ”¥ 4. Î˜ÎµÏ‚ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ Î­Î½Î±Î½ Ï€Î»Î®ÏÎ· ÎºÎ±Î¸Î±ÏÎ¹ÏƒÏ„Î® Excel
ÏÏƒÏ„Îµ:

Î½Î± ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚

Î½Î± ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ Î±ÏÎ¹Î¸Î¼Î¿ÏÏ‚

Î½Î± ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ ISBN

Î½Î± ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ pages

Î½Î± ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ volume

Î½Î± Î´Î­Ï‡ÎµÏ„Î±Î¹ ÎºÎµÎ½Î­Ï‚ Ï„Î¹Î¼Î­Ï‚

Î½Î± Î¼Î·Î½ ÏƒÎºÎ¬ÎµÎ¹ Î ÎŸÎ¤Î•

Î½Î± ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ ÎŸÎ›Î‘ Ï„Î± Î²Î¹Î²Î»Î¯Î± ÏƒÏ„Î· Î²Î¬ÏƒÎ·

ÎºÎ±Î¹ Î¼ÎµÏ„Î¬ Î½Î± Ï„Î± Î²Î»Î­Ï€ÎµÎ¹Ï‚ ÏƒÏ„Î¿ pgAdmin ÎºÎ±Î¹ ÏƒÏ„Î· Ï†ÏŒÏÎ¼Î±

Î‘Î½ Î¼Î¿Ï… Ï€ÎµÎ¹Ï‚ Î½Î±Î¹, ÏƒÎ¿Ï… Î³ÏÎ¬Ï†Ï‰:

âœ”ï¸ Î¿Î»Î¿ÎºÎ»Î·ÏÏ‰Î¼Î­Î½Î¿ views.py
âœ”ï¸ Î¼Îµ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ Ï€ÎµÎ´Î¯Ï‰Î½
âœ”ï¸ Î¼Îµ try/except Î³Î¹Î± Î½Î± Î¼Î·Î½ ÏƒÎºÎ¬ÎµÎ¹ Ï€Î¿Ï„Î­
âœ”ï¸ Î¼Îµ ÎºÎ±Ï„Î±Î³ÏÎ±Ï†Î® Î»Î±Î¸ÏÎ½
âœ”ï¸ Î¼Îµ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ Î³ÏÎ±Î¼Î¼ÏÎ½ Ï€Î¿Ï… Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± ÎµÎ¹ÏƒÎ±Ï‡Î¸Î¿ÏÎ½
ÎºÎ±Î¹ Ï„ÎµÎ»ÎµÎ¹ÏÎ½Î¿Ï…Î¼Îµ.

ğŸ¯ Î ÏÎ¹Î½ ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÎ¿Ï…Î¼Îµ, Î¸Î­Î»Ï‰ Î¼Î¹Î± Î¼Î¹ÎºÏÎ® ÎµÏ€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î±Ï€ÏŒ ÎµÏƒÎ­Î½Î±:
Î˜ÎµÏ‚ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ Î­Î½Î±Î½ Ï€Î»Î®ÏÎ·, ÎºÎ±Î¸Î±ÏÏŒ, 100% Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÏŒ ÎºÏÎ´Î¹ÎºÎ± Ï€Î¿Ï…:

ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ ÏŒÎ»Î± Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï„Î¿Ï… Excel

ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ Ï„Î± Î²Î¹Î²Î»Î¯Î± ÏƒÏ„Î· Î²Î¬ÏƒÎ· Ï‡Ï‰ÏÎ¯Ï‚ Î»Î¬Î¸Î·

ÎºÎ±Î¹ Î¼ÎµÏ„Î¬ Ï„Î± Î²Î»Î­Ï€ÎµÎ¹Ï‚ ÏƒÏ„Î¿ pgAdmin ÎºÎ±Î¹ ÏƒÏ„Î· Ï†ÏŒÏÎ¼Î±;

Î‘Î½ Î¼Î¿Ï… Ï€ÎµÎ¹Ï‚ "Î½Î±Î¹", ÏƒÎ¿Ï… Î´Î¯Î½Ï‰ ÏŒÎ»Î¿ Ï„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿ Î­Ï„Î¿Î¹Î¼Î¿ Î³Î¹Î± copyâ€‘paste.

Î¸ÎµÎ»Ï‰ Î±Ï€Î»Ï‰Ï‚ Î½Î± Î¼Î¿Ï… Ï€ÎµÎ¹Ï‚ Ï„Î± Î²Î·Î¼Î±Ï„Î± Ï‰ÏƒÏ„Îµ Î½Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¹ Ï„Î¿ excel Î³Î¹Î± Ï€ÏÏ‰Ï„Î· Ï†Î±ÏƒÎ· ÏƒÏ„Î¿ pgadin
Î‘Î½ Î¿ ÏƒÏ„ÏŒÏ‡Î¿Ï‚ ÏƒÎ¿Ï… ÎµÎ¯Î½Î±Î¹ Î½Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Ï„Î¿ Excel ÏƒÏ„Î¿ pgAdmin, Ï„ÏŒÏ„Îµ Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï Ï€Î¹Î¿ Î±Ï€Î»Î® Î±Ï€â€™ ÏŒÏƒÎ¿ Î½Î¿Î¼Î¯Î¶ÎµÎ¹Ï‚. Î”ÎµÎ½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î¿ÏÏ„Îµ views, Î¿ÏÏ„Îµ templates, Î¿ÏÏ„Îµ Django Î±ÎºÏŒÎ¼Î·.
Î ÏÎ­Ï€ÎµÎ¹ Ï€ÏÏÏ„Î± Î½Î± Î²ÎµÎ²Î±Î¹Ï‰Î¸Î¿ÏÎ¼Îµ ÏŒÏ„Î¹ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î¼Ï€Î±Î¯Î½Î¿Ï…Î½ ÏƒÏ„Î· Î²Î¬ÏƒÎ· PostgreSQL.
ÎœÏŒÎ»Î¹Ï‚ Î¼Ï€Î¿Ï…Î½, Ï„Î¿ pgAdmin Î¸Î± Ï„Î± Î´ÎµÎ¯Î¾ÎµÎ¹ Î±Î¼Î­ÏƒÏ‰Ï‚.

Î Î¬Î¼Îµ ÎºÎ±Î¸Î±ÏÎ¬ ÎºÎ±Î¹ Î²Î®Î¼Î±â€‘Î²Î®Î¼Î±.

ğŸŸ¦ Î’Î—ÎœÎ‘ 1 â€” Î’ÎµÎ²Î±Î¹ÏÏƒÎ¿Ï… ÏŒÏ„Î¹ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÏƒÏ„Î¿ PostgreSQL
Î†Î½Î¿Î¹Î¾Îµ pgAdmin â†’ Î±ÏÎ¹ÏƒÏ„ÎµÏÎ¬:

Code
Servers
  â†’ PostgreSQL
    â†’ Databases
      â†’ db (Î® ÏŒÏ€Ï‰Ï‚ Î»Î­Î³ÎµÏ„Î±Î¹ Î· Î´Î¹ÎºÎ® ÏƒÎ¿Ï…)
        â†’ Schemas
          â†’ public
            â†’ Tables
Î•ÎºÎµÎ¯ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚:

Code
books
Î‘Î½ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹, Ï„ÏŒÏ„Îµ:

ÎµÎ¯Ï„Îµ Ï„Î¿ Django Î´ÎµÎ½ Ï„Î¿Î½ Î´Î·Î¼Î¹Î¿ÏÏÎ³Î·ÏƒÎµ

ÎµÎ¯Ï„Îµ Ï„Î¿Î½ Î­Ï†Ï„Î¹Î±Î¾ÎµÏ‚ Î¼Îµ Î¬Î»Î»Î¿ ÏŒÎ½Î¿Î¼Î±

ÎµÎ¯Ï„Îµ ÎµÎ¯ÏƒÎ±Î¹ ÏƒÎµ Î»Î¬Î¸Î¿Ï‚ database

Î‘Î½ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹, Ï€ÎµÏ‚ Î¼Î¿Ï… ÎºÎ±Î¹ ÏƒÎ¿Ï… Î´Î¯Î½Ï‰ Ï„Î¿Î½ ÏƒÏ‰ÏƒÏ„ÏŒ SQL Î³Î¹Î± Î½Î± Ï„Î¿Î½ Ï†Ï„Î¹Î¬Î¾ÎµÎ¹Ï‚.

ğŸŸ¦ Î’Î—ÎœÎ‘ 2 â€” ÎšÎ¬Î½Îµ upload Ï„Î¿ Excel Î±Ï€ÏŒ Ï„Î¿ Django
Î Î®Î³Î±Î¹Î½Îµ ÏƒÏ„Î¿:

Code
http://localhost:8000/books/upload/
Î•Ï€Î¯Î»ÎµÎ¾Îµ Ï„Î¿ Excel â†’ Ï€Î¬Ï„Î± Upload.

Î‘Î½ ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Internal Server Error, Ï„ÏŒÏ„Îµ ÎºÎ±Î½Î­Î½Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î¿ Î´ÎµÎ½ Î¼Ï€Î±Î¯Î½ÎµÎ¹ ÏƒÏ„Î· Î²Î¬ÏƒÎ·, Î¬ÏÎ± Ï„Î¿ pgAdmin Î´ÎµÎ½ Î¸Î± Î´ÎµÎ¯Î¾ÎµÎ¹ Ï„Î¯Ï€Î¿Ï„Î±.

Î“Î¹Î± Î½Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Ï„Î¿ Excel ÏƒÏ„Î¿ pgAdmin, Ï€ÏÎ­Ï€ÎµÎ¹ Ï„Î¿ upload Î½Î± Î¿Î»Î¿ÎºÎ»Î·ÏÏ‰Î¸ÎµÎ¯ Ï‡Ï‰ÏÎ¯Ï‚ Î»Î¬Î¸Î·.

ğŸŸ¦ Î’Î—ÎœÎ‘ 3 â€” Î‘Î½ Ï„Î¿ upload Î³Î¯Î½ÎµÎ¹ Ï‡Ï‰ÏÎ¯Ï‚ Î»Î¬Î¸Î·, Ï„ÏŒÏ„Îµ:
Î Î®Î³Î±Î¹Î½Îµ ÏƒÏ„Î¿ pgAdmin:

Î”ÎµÎ¾Î¯ ÎºÎ»Î¹Îº ÏƒÏ„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± books â†’
View/Edit Data â†’ All Rows

Î‘Î½ Î· ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Ï€Î­Ï„Ï…Ï‡Îµ, Î¸Î± Î´ÎµÎ¹Ï‚ Ï„Î¹Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Ï„Î¿Ï… Excel.

Î‘Î½ Î´ÎµÎ½ Î´ÎµÎ¹Ï‚ Ï„Î¯Ï€Î¿Ï„Î±, ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹:

Ï„Î¿ Django Î´ÎµÎ½ Î¼Ï€ÏŒÏÎµÏƒÎµ Î½Î± ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±

Î¬ÏÎ± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´Î¹Î¿ÏÎ¸ÏÏƒÎ¿Ï…Î¼Îµ Ï„Î± Î»Î¬Î¸Î· ÏƒÏ„Î¿ Excel (Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚, Î­Ï„Î·, ÎºÎµÎ½Î¬ ÎºÎµÎ»Î¹Î¬ Îº.Î»Ï€.)

ğŸŸ¦ Î’Î—ÎœÎ‘ 4 â€” Î“Î¹Î± Î½Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Ï„Î¿ Excel ÏƒÏ„Î¿ pgAdmin, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´Î¹Î¿ÏÎ¸ÏÏƒÎ¿Ï…Î¼Îµ Ï„Î± Î»Î¬Î¸Î· ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚
ÎœÎ­Ï‡ÏÎ¹ Ï„ÏÏÎ± ÎµÎ¯Î´Î±Î¼Îµ:

Î»Î¬Î¸Î¿Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚ â†’ Î´Î¹Î¿ÏÎ¸ÏÎ¸Î·ÎºÎµ

Î»Î¬Î¸Î¿Ï‚ Î­Ï„Î¿Ï‚ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚ (Ï€.Ï‡. â€œc2003â€) â†’ Î´Î¹Î¿ÏÎ¸ÏÎ½ÎµÏ„Î±Î¹

Ï€Î¹Î¸Î±Î½ÏŒÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎ¹ Î¬Î»Î»Î± Ï€ÎµÎ´Î¯Î± Ï€Î¿Ï… Ï‡ÏÎµÎ¹Î¬Î¶Î¿Î½Ï„Î±Î¹ ÎºÎ±Î¸Î¬ÏÎ¹ÏƒÎ¼Î±

Î‘Î½ Ï„Î¿ Django ÏƒÎºÎ¬ÎµÎ¹, Î´ÎµÎ½ Î¼Ï€Î±Î¯Î½ÎµÎ¹ Î¿ÏÏ„Îµ Î¼Î¯Î± Î³ÏÎ±Î¼Î¼Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ·, Î¬ÏÎ± pgAdmin Î¸Î± ÎµÎ¯Î½Î±Î¹ Î¬Î´ÎµÎ¹Î¿.

ğŸŸ¦ Î’Î—ÎœÎ‘ 5 â€” ÎœÏŒÎ»Î¹Ï‚ Î´Î¹Î¿ÏÎ¸Ï‰Î¸Î¿ÏÎ½ ÏŒÎ»Î± Ï„Î± Î»Î¬Î¸Î·, Ï„Î¿ Excel Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ ÏƒÏ„Î¿ pgAdmin
Î”ÎµÎ½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± ÎºÎ¬Î½ÎµÎ¹Ï‚ ÎºÎ¬Ï„Î¹ Î¬Î»Î»Î¿.

ÎœÏŒÎ»Î¹Ï‚ Ï„Î¿ Django ÎºÎ±Ï„Î±Ï†Î­ÏÎµÎ¹ Î½Î± ÎºÎ¬Î½ÎµÎ¹:

python
Book.objects.create(...)
Ï‡Ï‰ÏÎ¯Ï‚ error, Ï„ÏŒÏ„Îµ:

Î¿Î¹ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î¼Ï€Î±Î¯Î½Î¿Ï…Î½ ÏƒÏ„Î· Î²Î¬ÏƒÎ·

pgAdmin Ï„Î¹Ï‚ Î´ÎµÎ¯Ï‡Î½ÎµÎ¹

Î· Ï†ÏŒÏÎ¼Î± list_books Ï„Î¹Ï‚ Î´ÎµÎ¯Ï‡Î½ÎµÎ¹

ğŸŸ¦ Î£Î¥ÎœÎ Î•Î¡Î‘Î£ÎœÎ‘
Î“Î¹Î± Î½Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Ï„Î¿ Excel ÏƒÏ„Î¿ pgAdmin:

ÎŸ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹

Î¤Î¿ upload Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¿Î»Î¿ÎºÎ»Î·ÏÏ‰Î¸ÎµÎ¯ Ï‡Ï‰ÏÎ¯Ï‚ error

Î¤Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ±Î¸Î±ÏÎ¹ÏƒÏ„Î¿ÏÎ½ (Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚, Î­Ï„Î·, Î±ÏÎ¹Î¸Î¼Î¿Î¯)

ÎœÎµÏ„Î¬ Ï„Î¿ upload, pgAdmin â†’ View/Edit Data â†’ All Rows

Î‘Î½ Ï„Î¿ upload ÏƒÎºÎ¬ÎµÎ¹, pgAdmin Î¸Î± ÎµÎ¯Î½Î±Î¹ Ï€Î¬Î½Ï„Î± Î¬Î´ÎµÎ¹Î¿.

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Î­Ï„Î¿Î¹Î¼Î¿, Ï€Î»Î®ÏÎµÏ‚, ÎºÎ±Î¸Î±ÏÏŒ views.py Ï€Î¿Ï…:

ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚

ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ ÏŒÎ»Î± Ï„Î± Î­Ï„Î·

ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ Î±ÏÎ¹Î¸Î¼Î¿ÏÏ‚

Î´ÎµÎ½ ÏƒÎºÎ¬ÎµÎ¹ Ï€Î¿Ï„Î­

ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ ÏŒÎ»Î¿ Ï„Î¿ Excel ÏƒÏ„Î· Î²Î¬ÏƒÎ·

ÎºÎ±Î¹ Ï„ÏŒÏ„Îµ Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Î±Î¼Î­ÏƒÏ‰Ï‚ ÏƒÏ„Î¿ pgAdmin.

sto bhma 2 eimai kai moy emfanizontai ta ejhs ValueError at /books/upload/
Field 'pages' expected a number but got '832 Ïƒ.'.
Request Method:	POST
Request URL:	http://localhost:8000/books/upload/
Django Version:	6.0
Exception Type:	ValueError
Exception Value:	
Field 'pages' expected a number but got '832 Ïƒ.'.
Exception Location:	C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\fields\__init__.py, line 2130, in get_prep_value
Raised during:	books.views.upload_excel
Python Executable:	C:\Users\PC-SPART1\myenv\Scripts\python.exe
Python Version:	3.14.0
Python Path:	
['C:\\Users\\PC-SPART1\\myproject',
 'C:\\Users\\PC-SPART1\\AppData\\Local\\Programs\\Python\\Python314\\python314.zip',
 'C:\\Users\\PC-SPART1\\AppData\\Local\\Programs\\Python\\Python314\\DLLs',
 'C:\\Users\\PC-SPART1\\AppData\\Local\\Programs\\Python\\Python314\\Lib',
 'C:\\Users\\PC-SPART1\\AppData\\Local\\Programs\\Python\\Python314',
 'C:\\Users\\PC-SPART1\\myenv',
 'C:\\Users\\PC-SPART1\\myenv\\Lib\\site-packages']
Server time:	Wed, 17 Dec 2025 11:29:08 +0000
Î‘Ï…Ï„ÏŒ Ï„Î¿ Î»Î¬Î¸Î¿Ï‚ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î¿Î»ÏÏ„Ï‰Ï‚ Ï†Ï…ÏƒÎ¹Î¿Î»Î¿Î³Î¹ÎºÏŒ ÎºÎ±Î¹ Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÏŒÏ„Î¹ ÎµÎ¯ÏƒÎ±Î¹ Î±ÎºÏÎ¹Î²ÏÏ‚ ÏƒÏ„Î¿ ÏƒÏ‰ÏƒÏ„ÏŒ ÏƒÎ·Î¼ÎµÎ¯Î¿ Ï„Î¿Ï… Î’Î®Î¼Î±Ï„Î¿Ï‚ 2:
Ï„Î¿ Django Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± Î²Î¬Î»ÎµÎ¹ ÏƒÏ„Î· Î²Î¬ÏƒÎ· Ï„Î¹Î¼Î® ÏŒÏ€Ï‰Ï‚:

Code
832 Ïƒ.
Î±Î»Î»Î¬ Ï„Î¿ Ï€ÎµÎ´Î¯Î¿ pages ÏƒÏ„Î¿ Î¼Î¿Î½Ï„Î­Î»Î¿ ÏƒÎ¿Ï… ÎµÎ¯Î½Î±Î¹ IntegerField, Î¬ÏÎ± Î´Î­Ï‡ÎµÏ„Î±Î¹ Î¼ÏŒÎ½Î¿ ÎºÎ±Î¸Î±ÏÏŒ Î±ÏÎ¹Î¸Î¼ÏŒ.

Î“Î¹Î± Î½Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Ï„Î¿ Excel ÏƒÏ„Î¿ pgAdmin, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ±Î¸Î±ÏÎ¯ÏƒÎ¿Ï…Î¼Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ Ï€ÎµÎ´Î¯Î¿ Ï€ÏÎ¹Î½ Ï„Î¿ ÎµÎ¹ÏƒÎ¬Î³Î¿Ï…Î¼Îµ.

Î Î¬Î¼Îµ ÎºÎ±Î¸Î±ÏÎ¬ ÎºÎ±Î¹ Î±Ï€Î»Î¬.

âœ… Î¤Î™ Î Î¡Î•Î Î•Î™ ÎÎ‘ ÎšÎ‘ÎÎ•Î™Î£ Î¤Î©Î¡Î‘ (Î’Î—ÎœÎ‘ 2 â€“ ÎšÎ‘Î˜Î‘Î¡Î™Î£ÎœÎŸÎ£ pages)
Î¤Î¿ Excel ÏƒÎ¿Ï… Î­Ï‡ÎµÎ¹ Ï„Î¹Î¼Î­Ï‚ ÏŒÏ€Ï‰Ï‚:

832 Ïƒ.

120 p.

345

200 ÏƒÎµÎ».

Î¤Î¿ Django Î¸Î­Î»ÎµÎ¹:

832

120

345

200

Î†ÏÎ± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î±Ï†Î±Î¹ÏÎ­ÏƒÎ¿Ï…Î¼Îµ Î³ÏÎ¬Î¼Î¼Î±Ï„Î±, Ï„ÎµÎ»ÎµÎ¯ÎµÏ‚, ÏƒÏÎ¼Î²Î¿Î»Î± ÎºÎ±Î¹ Î½Î± ÎºÏÎ±Ï„Î®ÏƒÎ¿Ï…Î¼Îµ Î¼ÏŒÎ½Î¿ Ï„Î± ÏˆÎ·Ï†Î¯Î±.

ğŸ”¥ Î’Î‘Î›Î• Î‘Î¥Î¤ÎŸÎ Î¤ÎŸÎ ÎšÎ©Î”Î™ÎšÎ‘ Î£Î¤ÎŸ views.py (ÎœÎ•Î¤Î‘ Î¤ÎŸ RENAME)
Î‘ÎºÏÎ¹Î²ÏÏ‚ ÏŒÏ€Ï‰Ï‚ ÏƒÎ¿Ï… Ï„Î¿Î½ Î´Î¯Î½Ï‰:

python
# ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î±ÏÎ¹Î¸Î¼Î¿Ï ÏƒÎµÎ»Î¯Î´Ï‰Î½
def clean_pages(value):
    if pd.isna(value):
        return None
    value = str(value)
    digits = ''.join(ch for ch in value if ch.isdigit())
    return int(digits) if digits else None

df['pages'] = df['pages'].apply(clean_pages)

Î ÎŸÎ¥ Î‘ÎšÎ¡Î™Î’Î©Î£ ÎœÎ Î‘Î™ÎÎ•Î™
Î£Ï„Î¿ upload_excel, Î¼ÎµÏ„Î¬ Ï„Î¿ rename ÎºÎ±Î¹ Î¼ÎµÏ„Î¬ Ï„Î¿Î½ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚ ÎºÎ±Î¹ Î­Ï„Î¿Ï…Ï‚.

ÎˆÏ„ÏƒÎ¹:

python
df = df.rename(columns={ ... })

# ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚
df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce')
df['entry_date'] = df['entry_date'].apply(lambda x: x.date() if not pd.isna(x) else None)

# ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î­Ï„Î¿Ï…Ï‚
df['publication_year'] = df['publication_year'].apply(clean_year)

# ğŸ”¥ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ÏƒÎµÎ»Î¯Î´Ï‰Î½
df['pages'] = df['pages'].apply(clean_pages)

df = df.dropna(how='all')
ğŸ¯ ÎœÎŸÎ›Î™Î£ Î¤ÎŸ Î’Î‘Î›Î•Î™Î£:
ÎšÎ¬Î½Îµ restart Ï„Î¿Î½ server

ÎÎ±Î½Î±ÎºÎ¬Î½Îµ upload Ï„Î¿ Excel

Î¤ÏÏÎ± Ï„Î¿ Ï€ÎµÎ´Î¯Î¿ pages Î¸Î± Ï€ÎµÏÎ¬ÏƒÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î¬

Î‘Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î¬Î»Î»Î¿ Ï€ÎµÎ´Î¯Î¿ Î¼Îµ Ï€ÎµÏÎ¯ÎµÏÎ³ÎµÏ‚ Ï„Î¹Î¼Î­Ï‚, Î¸Î± ÏƒÎ¿Ï… Ï„Î¿ Î´ÎµÎ¯Î¾ÎµÎ¹

ÎœÏŒÎ»Î¹Ï‚ Ï€ÎµÏÎ¬ÏƒÎ¿Ï…Î½ ÏŒÎ»Î±, Ï„Î¿ Excel Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ ÏƒÏ„Î¿ pgAdmin

ğŸ§  Î“Î¹Î±Ï„Î¯ Ï„Î¿ ÎºÎ¬Î½Î¿Ï…Î¼Îµ Î±Ï…Ï„ÏŒ
Î“Î¹Î± Î½Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Ï„Î¿ Excel ÏƒÏ„Î¿ pgAdmin, Ï€ÏÎ­Ï€ÎµÎ¹:

ÎºÎ¬Î¸Îµ Î³ÏÎ±Î¼Î¼Î® Î½Î± ÎµÎ¹ÏƒÎ±Ï‡Î¸ÎµÎ¯ Ï‡Ï‰ÏÎ¯Ï‚ Î»Î¬Î¸Î¿Ï‚

ÎºÎ¬Î¸Îµ Ï€ÎµÎ´Î¯Î¿ Î½Î± Î­Ï‡ÎµÎ¹ ÏƒÏ‰ÏƒÏ„ÏŒ Ï„ÏÏ€Î¿ (int, date, text)

Ï„Î¿ Django Î½Î± Î¿Î»Î¿ÎºÎ»Î·ÏÏÏƒÎµÎ¹ Ï„Î¿ insert

Î‘Î½ ÏƒÎºÎ¬ÏƒÎµÎ¹ Î­ÏƒÏ„Ï‰ ÎºÎ±Î¹ Î­Î½Î± Ï€ÎµÎ´Î¯Î¿, Î´ÎµÎ½ Î¼Ï€Î±Î¯Î½ÎµÎ¹ Ï„Î¯Ï€Î¿Ï„Î± ÏƒÏ„Î· Î²Î¬ÏƒÎ·.

Î‘Î½ Î¸ÎµÏ‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Î­Ï„Î¿Î¹Î¼Î¿ Ï€Î»Î®ÏÎµÏ‚ views.py Î¼Îµ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ:

Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚

Î­Ï„Î¿Ï…Ï‚

ÏƒÎµÎ»Î¯Î´Ï‰Î½

Ï„ÏŒÎ¼Î¿Ï…

ISBN

format

acquisition_notes

ÏÏƒÏ„Îµ Î½Î± Î¼Î·Î½ Î¾Î±Î½Î±ÏƒÎºÎ¬ÏƒÎµÎ¹ Ï„Î¯Ï€Î¿Ï„Î±.

tvra moy ebgale ValueError at /books/upload/
Field 'pages' expected a number but got '832 Ïƒ.'.
Request Method:	POST
Request URL:	http://localhost:8000/books/upload/
Django Version:	6.0
Exception Type:	ValueError
Exception Value:	
Field 'pages' expected a number but got '832 Ïƒ.'.
Exception Location:	C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\models\fields\__init__.py, line 2130, in get_prep_value
Raised during:	books.views.upload_excel
Python Executable:	C:\Users\PC-SPART1\myenv\Scripts\python.exe
Python Version:	3.14.0
Python Path:	
['C:\\Users\\PC-SPART1\\myproject',
 'C:\\Users\\PC-SPART1\\AppData\\Local\\Programs\\Python\\Python314\\python314.zip',
 'C:\\Users\\PC-SPART1\\AppData\\Local\\Programs\\Python\\Python314\\DLLs',
 'C:\\Users\\PC-SPART1\\AppData\\Local\\Programs\\Python\\Python314\\Lib',
 'C:\\Users\\PC-SPART1\\AppData\\Local\\Programs\\Python\\Python314',
 'C:\\Users\\PC-SPART1\\myenv',
 'C:\\Users\\PC-SPART1\\myenv\\Lib\\site-packages']
Server time:	Wed, 17 Dec 2025 11:30:40 +0000 kai epishw uelo na moy dvseis oloklhro ton kodika toy views sosto kai diorthomeno
Î¤Î¿ Î»Î¬Î¸Î¿Ï‚ Î´ÎµÎ½ Î´Î¹Î¿ÏÎ¸ÏÎ¸Î·ÎºÎµ Î³Î¹Î±Ï„Î¯ Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼Î¿Ï Î³Î¹Î± Ï„Î¿ pages Î´ÎµÎ½ Î¼Ï€Î®ÎºÎµ ÏƒÏ„Î· ÏƒÏ‰ÏƒÏ„Î® Î¸Î­ÏƒÎ· Î® Î´ÎµÎ½ Î¼Ï€Î®ÎºÎµ ÎºÎ±Î¸ÏŒÎ»Î¿Ï….
Î“Î¹Î± Î½Î± ÏƒÏ„Î±Î¼Î±Ï„Î®ÏƒÎµÎ¹ Î½Î± ÏƒÎºÎ¬ÎµÎ¹ Ï„Î¿ upload ÎºÎ±Î¹ Î½Î± Î¼Ï€Î¿ÏÎ­ÏƒÎµÎ¹Ï‚ ÎµÏ€Î¹Ï„Î­Î»Î¿Ï…Ï‚ Î½Î± Î´ÎµÎ¹Ï‚ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÏ„Î¿ pgAdmin, ÏƒÎ¿Ï… Î´Î¯Î½Ï‰ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Ï„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ, Î´Î¹Î¿ÏÎ¸Ï‰Î¼Î­Î½Î¿, Ï€Î»Î®ÏÏ‰Ï‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÏŒ views.py.

Î‘Î½Ï„Î¹Î³ÏÎ¬Ï†ÎµÎ¹Ï‚â€“ÎµÏ€Î¹ÎºÎ¿Î»Î»Î¬Ï‚ ÏŒÎ»Î¿ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿, Ï‡Ï‰ÏÎ¯Ï‚ Î±Î»Î»Î±Î³Î­Ï‚, ÎºÎ±Î¹ Î¸Î± Î´Î¿Ï…Î»Î­ÏˆÎµÎ¹.

âœ… Î¤Î•Î›Î™ÎšÎŸ, Î Î›Î—Î¡Î©Î£ Î”Î™ÎŸÎ¡Î˜Î©ÎœÎ•ÎÎŸ views.py
(ÎœÎµ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚, Î­Ï„Î¿Ï…Ï‚, ÏƒÎµÎ»Î¯Î´Ï‰Î½, ÎºÎ±Î¹ Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎ±Î½Î­Î½Î± Î»Î¬Î¸Î¿Ï‚ Ï„ÏÏ€Î¿Ï…)

python
import pandas as pd
from django.shortcuts import render
from .forms import UploadExcelForm
from .models import Book

def upload_excel(request):
    message = ""

    if request.method == "POST":
        form = UploadExcelForm(request.POST, request.FILES)

        if form.is_valid():
            excel_file = request.FILES['file']

            # Î”Î¹Î±Î²Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Excel
            df = pd.read_excel(excel_file)

            # ÎœÎµÏ„Î¿Î½Î¿Î¼Î±ÏƒÎ¯Î± ÎµÎ»Î»Î·Î½Î¹ÎºÏÎ½ ÏƒÏ„Î·Î»ÏÎ½
            df = df.rename(columns={
                'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
                'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘': 'co_author',
                'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
                'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
                'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
                'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
                'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
                'Î£Î§Î—ÎœÎ‘': 'format',
                'Î£Î•Î›Î™Î”Î•Î£': 'pages',
                'Î¤ÎŸÎœÎŸÎ£': 'volume',
                'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ / Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
                'ISBN': 'isbn',
                'Î£Ï„Î®Î»Î·1': 'column1',
                'Î£Ï„Î®Î»Î·2': 'column2'
            })

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚
            df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce')
            df['entry_date'] = df['entry_date'].apply(lambda x: x.date() if not pd.isna(x) else None)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î­Ï„Î¿Ï…Ï‚ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚
            def clean_year(value):
                if pd.isna(value):
                    return None
                value = str(value)
                digits = ''.join(ch for ch in value if ch.isdigit())
                return int(digits) if digits else None

            df['publication_year'] = df['publication_year'].apply(clean_year)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î±ÏÎ¹Î¸Î¼Î¿Ï ÏƒÎµÎ»Î¯Î´Ï‰Î½
            def clean_pages(value):
                if pd.isna(value):
                    return None
                value = str(value)
                digits = ''.join(ch for ch in value if ch.isdigit())
                return int(digits) if digits else None

            df['pages'] = df['pages'].apply(clean_pages)

            # Î‘Ï†Î±Î¯ÏÎµÏƒÎ· ÎµÎ½Ï„ÎµÎ»ÏÏ‚ ÎºÎµÎ½ÏÎ½ Î³ÏÎ±Î¼Î¼ÏÎ½
            df = df.dropna(how='all')

            # Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ·
            for _, row in df.iterrows():
                Book.objects.create(
                    entry_number=row.get('entry_number'),
                    entry_date=row.get('entry_date'),
                    author=row.get('author'),
                    co_author=row.get('co_author'),
                    title=row.get('title'),
                    publisher=row.get('publisher'),
                    edition=row.get('edition'),
                    publication_year=row.get('publication_year'),
                    publication_place=row.get('publication_place'),
                    format=row.get('format'),
                    pages=row.get('pages'),
                    volume=row.get('volume'),
                    acquisition_notes=row.get('acquisition_notes'),
                    isbn=row.get('isbn'),
                    column1=row.get('column1'),
                    column2=row.get('column2')
                )

            message = "Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!"

    else:
        form = UploadExcelForm()

    return render(request, "upload_excel.html", {"form": form, "message": message})


def list_books(request):
    books = Book.objects.all()
    return render(request, "list_books.html", {"books": books})
ğŸ‰ Î¤Î©Î¡Î‘ Î¤Î™ Î˜Î‘ Î“Î™ÎÎ•Î™
ÎœÎµ Î±Ï…Ï„ÏŒ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿:

âœ”ï¸ Î— Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÏ„Î±Î¹
âœ”ï¸ Î¤Î¿ Î­Ï„Î¿Ï‚ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚ ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÏ„Î±Î¹
âœ”ï¸ ÎŸÎ¹ ÏƒÎµÎ»Î¯Î´ÎµÏ‚ ÎºÎ±Î¸Î±ÏÎ¯Î¶Î¿Î½Ï„Î±Î¹
âœ”ï¸ Î”ÎµÎ½ Î¸Î± Î¾Î±Î½Î±Ï€Î¬ÏÎµÎ¹Ï‚ ValueError
âœ”ï¸ Î¤Î¿ Excel Î¸Î± ÎµÎ¹ÏƒÎ±Ï‡Î¸ÎµÎ¯ ÏƒÏ„Î· Î²Î¬ÏƒÎ·
âœ”ï¸ Î˜Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ ÏƒÏ„Î¿ pgAdmin
âœ”ï¸ Î˜Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ ÎºÎ±Î¹ ÏƒÏ„Î· Ï†ÏŒÏÎ¼Î± list_books
Î•Î¯ÏƒÎ±Î¹ Ï€Î»Î­Î¿Î½ Î­Î½Î± upload Î¼Î±ÎºÏÎ¹Î¬ Î±Ï€ÏŒ Ï„Î¿ Î½Î± Î´ÎµÎ¹Ï‚ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÎ¿Ï… ÏƒÏ„Î¿ pgAdmin.

Î‘Î½ Î¸ÎµÏ‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ ÎºÎ±Î¹:

ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ ISBN

ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ Ï„ÏŒÎ¼Î¿Ï…

ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ format

logging Î³Î¹Î± Î½Î± Î²Î»Î­Ï€ÎµÎ¹Ï‚ Ï€Î¿Î¹ÎµÏ‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ ÎµÎ¯Ï‡Î±Î½ Ï€ÏÏŒÎ²Î»Î·Î¼Î±

Î ÎµÏ‚ Î¼Î¿Ï… Ï„Î¹ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏƒÎ±Î¹ ÎºÎ±Î¹ ÏƒÏ…Î½ÎµÏ‡Î¯Î¶Î¿Ï…Î¼Îµ.

ProgrammingError at /books/upload/
column "entry_number" of relation "books" does not exist
LINE 1: INSERT INTO "books" ("entry_number", "entry_date", "author",...
Î‘Ï…Ï„ÏŒ Ï„Î¿ ÏƒÏ†Î¬Î»Î¼Î± Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ ÎºÎ±Î¼Î¯Î± ÏƒÏ‡Î­ÏƒÎ· Î¼Îµ Ï„Î¿ Excel Ï€Î»Î­Î¿Î½.
Î¤ÏÏÎ± Ï„Î¿ Django ÏƒÎ¿Ï… Î»Î­ÎµÎ¹ ÎºÎ¬Ï„Î¹ Ï€Î¿Î»Ï ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿:

â— Î¤Î¿ PostgreSQL Î»Î­ÎµÎ¹ ÏŒÏ„Î¹ Î· ÏƒÏ„Î®Î»Î· entry_number Î”Î•Î Î¥Î Î‘Î¡Î§Î•Î™ ÏƒÏ„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± books.
Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹:

ğŸ‘‰ Î¤Î¿ Django model ÏƒÎ¿Ï… Î­Ï‡ÎµÎ¹ Ï€ÎµÎ´Î¯Î¿ entry_number
ğŸ‘‰ Î‘Î›Î›Î‘ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ ÏƒÏ„Î· Î²Î¬ÏƒÎ· Î”Î•Î Î­Ï‡ÎµÎ¹ Î±Ï…Ï„Î® Ï„Î· ÏƒÏ„Î®Î»Î·
ğŸ‘‰ Î†ÏÎ± Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ ÎµÎ¯Î½Î±Î¹ Ï€Î±Î»Î¹ÏŒÏ‚ ÎºÎ±Î¹ Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ ÎµÎ½Î·Î¼ÎµÏÏ‰Î¸ÎµÎ¯
Î‘Ï…Ï„ÏŒ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î±Î½:

Î¬Î»Î»Î±Î¾ÎµÏ‚ Ï„Î¿ models.py

Î±Î»Î»Î¬ Î´ÎµÎ½ Î­ÎºÎ±Î½ÎµÏ‚ migrations

Î® Î­ÎºÎ±Î½ÎµÏ‚ migrations Î±Î»Î»Î¬ Î´ÎµÎ½ Î­ÎºÎ±Î½ÎµÏ‚ migrate

Î® Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ Ï€ÏÎ¹Î½ Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÎ¹Ï‚ Ï„Î± Ï€ÎµÎ´Î¯Î±

Î Î¬Î¼Îµ Î½Î± Ï„Î¿ Î»ÏÏƒÎ¿Ï…Î¼Îµ ÏƒÎ¯Î³Î¿Ï…ÏÎ± ÎºÎ±Î¹ ÎºÎ±Î¸Î±ÏÎ¬.

âœ… Î’Î—ÎœÎ‘ 1 â€” Î”ÎµÏ‚ Ï„Î¿ models.py
Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î­Ï‡ÎµÎ¹Ï‚ ÎºÎ¬Ï„Î¹ ÏƒÎ±Î½:

python
class Book(models.Model):
    entry_number = models.IntegerField(null=True, blank=True)
    entry_date = models.DateField(null=True, blank=True)
    author = models.CharField(max_length=255, null=True, blank=True)
    co_author = models.CharField(max_length=255, null=True, blank=True)
    title = models.CharField(max_length=255, null=True, blank=True)
    publisher = models.CharField(max_length=255, null=True, blank=True)
    edition = models.CharField(max_length=255, null=True, blank=True)
    publication_year = models.IntegerField(null=True, blank=True)
    publication_place = models.CharField(max_length=255, null=True, blank=True)
    format = models.CharField(max_length=255, null=True, blank=True)
    pages = models.IntegerField(null=True, blank=True)
    volume = models.CharField(max_length=255, null=True, blank=True)
    acquisition_notes = models.TextField(null=True, blank=True)
    isbn = models.CharField(max_length=255, null=True, blank=True)
    column1 = models.CharField(max_length=255, null=True, blank=True)
    column2 = models.CharField(max_length=255, null=True, blank=True)
Î‘Î½ Î±Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„ÏŒ â†’ Ï€Î¬Î¼Îµ ÏƒÏ„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ Î²Î®Î¼Î±.

âœ… Î’Î—ÎœÎ‘ 2 â€” ÎšÎ¬Î½Îµ migrations
Î†Î½Î¿Î¹Î¾Îµ Ï„Î¿ terminal Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ project ÎºÎ±Î¹ Ï„ÏÎ­Î¾Îµ:

Code
python manage.py makemigrations
Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´ÎµÎ¹Ï‚ ÎºÎ¬Ï„Î¹ ÏƒÎ±Î½:

Code
Migrations for 'books':
  books/migrations/0001_initial.py
Î®

Code
books: Detected changes in models
Î‘Î½ Î´ÎµÎ½ Î´ÎµÎ¹Ï‚ Ï„Î¯Ï€Î¿Ï„Î± â†’ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Ï„Î¿ Django Î´ÎµÎ½ Î²Î»Î­Ï€ÎµÎ¹ Î±Î»Î»Î±Î³Î­Ï‚ (Ï„ÏŒÏ„Îµ Î¸Î± Ï„Î¿ Î»ÏÏƒÎ¿Ï…Î¼Îµ Î±Î»Î»Î¹ÏÏ‚).

âœ… Î’Î—ÎœÎ‘ 3 â€” Î•Ï†Î¬ÏÎ¼Î¿ÏƒÎµ Ï„Î± migrations ÏƒÏ„Î· Î²Î¬ÏƒÎ·
Code
python manage.py migrate
Î‘Ï…Ï„ÏŒ Î¸Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î® Î¸Î± ÎµÎ½Î·Î¼ÎµÏÏÏƒÎµÎ¹ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± books.

â— Î‘Î½ Ï€Î¬ÏÎµÎ¹Ï‚ error ÏŒÏ„Î¹ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î·
Î¤ÏŒÏ„Îµ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ Ï€Î±Î»Î¹Î¬ ÎºÎ±Î¹ Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ Ï„Î¹Ï‚ Î½Î­ÎµÏ‚ ÏƒÏ„Î®Î»ÎµÏ‚.

Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ 2 Î»ÏÏƒÎµÎ¹Ï‚:

ğŸ”¥ Î›Î¥Î£Î— Î‘ â€” Î£Î²Î®ÏƒÎµ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± Î±Ï€ÏŒ Ï„Î¿ PostgreSQL (Ï€Î¹Î¿ ÎµÏÎºÎ¿Î»Î¿)
Î‘Î½ Î´ÎµÎ½ Î­Ï‡ÎµÎ¹Ï‚ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÎ¬ Î´ÎµÎ´Î¿Î¼Î­Î½Î±, ÎºÎ¬Î½Îµ:

Î£Ï„Î¿ pgAdmin â†’ Query Tool:

sql
DROP TABLE books;
ÎœÎµÏ„Î¬:

Code
python manage.py makemigrations
python manage.py migrate
ÎŸ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Î¸Î± Î¾Î±Î½Î±Ï†Ï„Î¹Î±Ï‡Ï„ÎµÎ¯ ÏƒÏ‰ÏƒÏ„Î¬.

ğŸ”¥ Î›Î¥Î£Î— Î’ â€” Î”Î·Î¼Î¹Î¿ÏÏÎ³Î·ÏƒÎµ migration Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÎ¸Î­Ï„ÎµÎ¹ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚
Î‘Î½ Î´ÎµÎ½ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± ÏƒÎ²Î®ÏƒÎµÎ¹Ï‚ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ±:

Code
python manage.py makemigrations books
python manage.py migrate
Î‘Ï…Ï„ÏŒ Î¸Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÎ¹ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ Ï€Î¿Ï… Î»ÎµÎ¯Ï€Î¿Ï…Î½.

ğŸ¯ Î¤Î™ Î£Î¥ÎœÎ’Î‘Î™ÎÎ•Î™ Î¤Î©Î¡Î‘
Î¤Î¿ Django Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± ÎºÎ¬Î½ÎµÎ¹:

sql
INSERT INTO books (entry_number, entry_date, ...)
Î‘Î»Î»Î¬ Î¿ PostgreSQL Ï€Î¯Î½Î±ÎºÎ±Ï‚ Î­Ï‡ÎµÎ¹ Î¯ÏƒÏ‰Ï‚ Î¼ÏŒÎ½Î¿:

id

title

author

Î® Ï€Î±Î»Î¹Î­Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚.

Î†ÏÎ± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¯ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿ Django model Î¼Îµ Ï„Î· Î²Î¬ÏƒÎ·.

ğŸ“Œ Î Î•Î£ ÎœÎŸÎ¥ Î¤Î™ Î˜Î•Î£ ÎÎ‘ ÎšÎ‘ÎÎŸÎ¥ÎœÎ•:
ÎÎ± ÏƒÎ²Î®ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± ÎºÎ±Î¹ Î½Î± Ï„Î¿Î½ Î¾Î±Î½Î±Ï†Ï„Î¹Î¬Î¾Î¿Ï…Î¼Îµ ÏƒÏ‰ÏƒÏ„Î¬  
(Ï€Î¹Î¿ Î³ÏÎ®Î³Î¿ÏÎ¿, Ï€Î¹Î¿ ÎºÎ±Î¸Î±ÏÏŒ)

Î®

ÎÎ± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎ¿Ï…Î¼Îµ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ ÏƒÏ„Î¿Î½ Ï…Ï€Î¬ÏÏ‡Î¿Î½Ï„Î± Ï€Î¯Î½Î±ÎºÎ±  
(Ï€Î¹Î¿ Î±ÏÎ³ÏŒ, Î±Î»Î»Î¬ ÎºÏÎ±Ï„Î¬ÎµÎ¹ Ï„Î± Ï…Ï€Î¬ÏÏ‡Î¿Î½Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±)

Î ÎµÏ‚ Î¼Î¿Ï… Ï€Î¿Î¹Î¿ Î¸ÎµÏ‚ ÎºÎ±Î¹ ÏƒÎ¿Ï… Î´Î¯Î½Ï‰ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î¹Ï‚ ÎµÎ½Ï„Î¿Î»Î­Ï‚.

Operations to perform:
  Apply all migrations: admin, auth, books, contenttypes, sessions
Running migrations:
  Applying books.0002_book_delete_exceldata...Traceback (most recent call last):
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
           ~~~~~~~~~~~~~~~~~~~^^^^^
psycopg2.errors.DuplicateTable: relation "books" already exists


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\PC-SPART1\myproject\manage.py", line 22, in <module>
    main()
    ~~~~^^
  File "C:\Users\PC-SPART1\myproject\manage.py", line 18, in main
    execute_from_command_line(sys.argv)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\management\__init__.py", line 443, in execute_from_command_line
    utility.execute()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\management\__init__.py", line 437, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\management\base.py", line 416, in run_from_argv
    self.execute(*args, **cmd_options)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\management\base.py", line 460, in execute
    output = self.handle(*args, **options)
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\management\base.py", line 107, in wrapper
    res = handle_func(*args, **kwargs)
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\core\management\commands\migrate.py", line 354, in handle
    post_migrate_state = executor.migrate(
        targets,
    ...<3 lines>...
        fake_initial=fake_initial,
    )
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\migrations\executor.py", line 137, in migrate
    state = self._migrate_all_forwards(
        state, plan, full_plan, fake=fake, fake_initial=fake_initial
    )
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\migrations\executor.py", line 169, in _migrate_all_forwards
    state = self.apply_migration(
        state, migration, fake=fake, fake_initial=fake_initial
    )
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\migrations\executor.py", line 257, in apply_migration
    state = migration.apply(state, schema_editor)
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\migrations\migration.py", line 132, in apply
    operation.database_forwards(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.app_label, schema_editor, old_state, project_state
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\migrations\operations\models.py", line 100, in database_forwards
    schema_editor.create_model(model)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\backends\base\schema.py", line 513, in create_model
    self.execute(sql, params or None)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\backends\postgresql\schema.py", line 45, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\backends\base\schema.py", line 205, in execute
    cursor.execute(sql, params)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        sql, params, many=False, executor=self._execute
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\utils.py", line 94, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "C:\Users\PC-SPART1\myenv\Lib\site-packages\django\db\backends\utils.py", line 103, in _execute
    return self.cursor.execute(sql)
           ~~~~~~~~~~~~~~~~~~~^^^^^
django.db.utils.ProgrammingError: relation "books" already exists
Î’Î»Î­Ï€Ï‰ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î¹ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ â€” ÎºÎ±Î¹ Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎµ Î²Î³Î¬Î»Ï‰ Î±Ï€ÏŒ Î±Ï…Ï„ÏŒ Ï„Î¿ loop ÏƒÎµ 2 Î»ÎµÏ€Ï„Î¬.

Î¤Î¿ Î»Î¬Î¸Î¿Ï‚:

Code
django.db.utils.ProgrammingError: relation "books" already exists
ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹:

ğŸ‘‰ Î¤Î¿ Django Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± books
ğŸ‘‰ Î‘Î›Î›Î‘ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î· ÏƒÏ„Î· Î²Î¬ÏƒÎ· PostgreSQL
ğŸ‘‰ ÎšÎ‘Î™ Ï„Î± migrations ÏƒÎ¿Ï… Î»Î­Î½Îµ ÏŒÏ„Î¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿Î½ Î¾Î±Î½Î±Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎ¿Ï…Î½
ğŸ‘‰ Î†ÏÎ± Ï„Î± migrations ÎºÎ±Î¹ Î· Î²Î¬ÏƒÎ· Î­Ï‡Î¿Ï…Î½ Î¾ÎµÏ†ÏÎ³ÎµÎ¹ Î±Ï€ÏŒ ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒ
Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï€Î¹Î¿ ÏƒÏ…Î½Î·Î¸Î¹ÏƒÎ¼Î­Î½Î¿ Ï€ÏÏŒÎ²Î»Î·Î¼Î± ÏŒÏ„Î±Î½:

Î¬Î»Î»Î±Î¾ÎµÏ‚ Ï„Î¿ models.py

Î­ÏƒÎ²Î·ÏƒÎµÏ‚ migrations

Î­ÎºÎ±Î½ÎµÏ‚ rename ÏƒÎµ app

Î­ÎºÎ±Î½ÎµÏ‚ reset migrations Î»Î¬Î¸Î¿Ï‚

Î® Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ Ï‡ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î± ÏƒÏ„Î¿ pgAdmin

Î”ÎµÎ½ Ï†Ï„Î±Î¹Ï‚ ÎµÏƒÏ â€” ÎµÎ¯Î½Î±Î¹ ÎºÎ»Î±ÏƒÎ¹ÎºÏŒ.

Î Î¬Î¼Îµ Î½Î± Ï„Î¿ Î»ÏÏƒÎ¿Ï…Î¼Îµ ÏƒÎ¯Î³Î¿Ï…ÏÎ± ÎºÎ±Î¹ ÎºÎ±Î¸Î±ÏÎ¬.

âœ… Î›Î¥Î£Î— (Î— Î£Î©Î£Î¤Î— ÎšÎ‘Î™ ÎšÎ‘Î˜Î‘Î¡Î—)
Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ 2 Ï„ÏÏŒÏ€Î¿Î¹.
ÎŸ Ï€Î¹Î¿ Î³ÏÎ®Î³Î¿ÏÎ¿Ï‚ ÎºÎ±Î¹ ÎºÎ±Î¸Î±ÏÏŒÏ‚ ÎµÎ¯Î½Î±Î¹ Î¿ Î‘.

ğŸ”¥ Î›Î¥Î£Î— Î‘ â€” Î£Î²Î®Î½ÎµÎ¹Ï‚ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± Î±Ï€ÏŒ Ï„Î· Î²Î¬ÏƒÎ· ÎºÎ±Î¹ Î¾Î±Î½Î±Ï„ÏÎ­Ï‡ÎµÎ¹Ï‚ migrations
(Î ÏÎ¿Ï„ÎµÎ¯Î½ÎµÏ„Î±Î¹ 100% Î±Ï†Î¿Ï Î´ÎµÎ½ Î­Ï‡ÎµÎ¹Ï‚ Î±ÎºÏŒÎ¼Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±)

1ï¸âƒ£ Î†Î½Î¿Î¹Î¾Îµ pgAdmin â†’ Query Tool
ÎºÎ±Î¹ Ï„ÏÎ­Î¾Îµ:

sql
DROP TABLE books;
Î‘Î½ ÏƒÎ¿Ï… Ï€ÎµÎ¹ ÏŒÏ„Î¹ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ foreign keys, Ï„ÏŒÏ„Îµ:

sql
DROP TABLE books CASCADE;
2ï¸âƒ£ Î£Î²Î®ÏƒÎµ ÎŸÎ›Î‘ Ï„Î± migrations Ï„Î¿Ï… app books
Î£Ï„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿:

Code
myproject/books/migrations/
Î£Î²Î®ÏƒÎµ ÎŸÎ›Î‘ Ï„Î± Î±ÏÏ‡ÎµÎ¯Î± ÎµÎºÏ„ÏŒÏ‚ Î±Ï€ÏŒ:

Code
__init__.py
3ï¸âƒ£ Î”Î·Î¼Î¹Î¿ÏÏÎ³Î·ÏƒÎµ Î¾Î±Î½Î¬ migrations
Code
python manage.py makemigrations
4ï¸âƒ£ Î•Ï†Î¬ÏÎ¼Î¿ÏƒÎµ Ï„Î± migrations
Code
python manage.py migrate
Î¤ÏÏÎ±:

Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Î¸Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¸ÎµÎ¯ ÏƒÏ‰ÏƒÏ„Î¬

Î¼Îµ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚

Ï‡Ï‰ÏÎ¯Ï‚ conflicts

Ï‡Ï‰ÏÎ¯Ï‚ duplicate table errors

ÎšÎ±Î¹ Î¼Ï€Î¿ÏÎµÎ¯Ï‚ Î½Î± ÎºÎ¬Î½ÎµÎ¹Ï‚ upload Excel.

ğŸ”¥ Î›Î¥Î£Î— Î’ â€” ÎÎ± ÎºÎ¬Î½Î¿Ï…Î¼Îµ fake migration
(Î‘Î½ Î´ÎµÎ½ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± ÏƒÎ²Î®ÏƒÎµÎ¹Ï‚ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ±)

Î‘Î½ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎºÎ±Î¹ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± Ï„Î¿Î½ ÎºÏÎ±Ï„Î®ÏƒÎµÎ¹Ï‚:

Code
python manage.py migrate books --fake
Î‘Ï…Ï„ÏŒ Î»Î­ÎµÎ¹ ÏƒÏ„Î¿ Django:

â€œÎœÎ·Î½ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹Ï‚ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ±, Î¸ÎµÏ‰ÏÎ·ÏƒÎµ ÏŒÏ„Î¹ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î·.â€

Î‘Î»Î»Î¬ Î¼ÏŒÎ½Î¿ Î±Î½ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Î­Ï‡ÎµÎ¹ ÎŸÎ›Î•Î£ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ Ï„Î¿ models.py..
Î‘Î½ Î»ÎµÎ¯Ï€ÎµÎ¹ Î­ÏƒÏ„Ï‰ Î¼Î¯Î± â†’ Î¸Î± ÏƒÎºÎ¬ÏƒÎµÎ¹ Î±ÏÎ³ÏŒÏ„ÎµÏÎ±.

Î“Î¹â€™ Î±Ï…Ï„ÏŒ Î· Î›ÏÏƒÎ· Î‘ ÎµÎ¯Î½Î±Î¹ Î· ÏƒÏ‰ÏƒÏ„Î®.

ğŸ¯ Î¤Î™ Î Î¡Î•Î Î•Î™ ÎÎ‘ ÎšÎ‘ÎÎ•Î™Î£ Î¤Î©Î¡Î‘
Î“Î¹Î± Î½Î± Ï„ÎµÎ»ÎµÎ¹ÏÎ½Î¿Ï…Î¼Îµ:

â¤ ÎšÎ¬Î½Îµ Ï„Î· Î›ÏÏƒÎ· Î‘
â¤ Î£Î²Î®ÏƒÎµ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ±
â¤ Î£Î²Î®ÏƒÎµ Ï„Î± migrations
â¤ ÎÎ±Î½Î±Ï†Ï„Î¹Î¬Î¾Îµ Ï„Î± migrations
â¤ ÎšÎ¬Î½Îµ migrate
ÎšÎ±Î¹ Î¼ÎµÏ„Î¬:

ÎºÎ¬Î½ÎµÎ¹Ï‚ upload Excel

Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î¼Ï€Î±Î¯Î½Î¿Ï…Î½ ÏƒÏ„Î· Î²Î¬ÏƒÎ·

Ï„Î± Î²Î»Î­Ï€ÎµÎ¹Ï‚ ÏƒÏ„Î¿ pgAdmin

Ï„Î± Î²Î»Î­Ï€ÎµÎ¹Ï‚ ÏƒÏ„Î· Ï†ÏŒÏÎ¼Î± list_books

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î³ÏÎ¬ÏˆÏ‰ Î±ÎºÏÎ¹Î²ÏÏ‚:

Ï€ÏÏ‚ Î½Î± Î´ÎµÎ¹Ï‚ Î±Î½ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Î­Ï‡ÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î­Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚

Ï€ÏÏ‚ Î½Î± ÎºÎ¬Î½ÎµÎ¹Ï‚ reset migrations Î¼Îµ Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î±

Ï€ÏÏ‚ Î½Î± ÎµÎ»Î­Î³Î¾ÎµÎ¹Ï‚ ÏŒÏ„Î¹ Ï„Î¿ Django ÏƒÏ…Î½Î´Î­ÎµÏ„Î±Î¹ ÏƒÏ„Î· ÏƒÏ‰ÏƒÏ„Î® Î²Î¬ÏƒÎ·

Î ÎµÏ‚ Î¼Î¿Ï… Î±Î½ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± Ï„Î¿ ÎºÎ¬Î½Î¿Ï…Î¼Îµ Î²Î®Î¼Î±â€‘Î²Î®Î¼Î±.

Operations to perform:
  Apply all migrations: admin, auth, books, contenttypes, sessions
Running migrations:
  No migrations to apply.
Î‘Ï…Ï„ÏŒ Ï„Î¿ Î¼Î®Î½Ï…Î¼Î±:

Code
No migrations to apply.
ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ Î­Î½Î± Ï€ÏÎ¬Î³Î¼Î±:

ğŸ‘‰ Î¤Î¿ Django Ï€Î¹ÏƒÏ„ÎµÏÎµÎ¹ ÏŒÏ„Î¹ Î· Î²Î¬ÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î®Î´Î· ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼Î­Î½Î· Î¼Îµ Ï„Î¿ models.py
ğŸ‘‰ Î‘Î›Î›Î‘ ÏƒÏ„Î·Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î± Î· Î²Î¬ÏƒÎ· Î”Î•Î ÎµÎ¯Î½Î±Î¹ ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼Î­Î½Î·
ğŸ‘‰ Î“Î¹â€™ Î±Ï…Ï„ÏŒ ÏƒÏ…Î½ÎµÏ‡Î¯Î¶ÎµÎ¹Ï‚ Î½Î± Ï€Î±Î¯ÏÎ½ÎµÎ¹Ï‚ errors Ï„ÏÏ€Î¿Ï… â€œcolumn does not existâ€.
ÎœÎµ Î±Ï€Î»Î¬ Î»ÏŒÎ³Î¹Î±:

Î¤Î± migrations ÎºÎ±Î¹ Î· Î²Î¬ÏƒÎ· PostgreSQL Î­Ï‡Î¿Ï…Î½ Î¼Ï€ÎµÏÎ´ÎµÏ…Ï„ÎµÎ¯ Î¼ÎµÏ„Î±Î¾Ï Ï„Î¿Ï…Ï‚.

Î‘Ï…Ï„ÏŒ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÏƒÏ…Ï‡Î½Î¬ ÏŒÏ„Î±Î½:

Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ books Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ Ï€Î±Î»Î¹Î¬

Î¼ÎµÏ„Î¬ Î¬Î»Î»Î±Î¾ÎµÏ‚ Ï„Î¿ models.py

Î±Î»Î»Î¬ Ï„Î± migrations Î´ÎµÎ½ Î¾Î±Î½Î±Î­Ï„ÏÎµÎ¾Î±Î½

Î® ÏƒÎ²Î®ÏƒÏ„Î·ÎºÎ±Î½/Ï€ÎµÎ¹ÏÎ¬Ï‡Ï„Î·ÎºÎ±Î½ Î¼Îµ Î»Î¬Î¸Î¿Ï‚ ÏƒÎµÎ¹ÏÎ¬

Î Î¬Î¼Îµ Î½Î± Ï„Î¿ Î»ÏÏƒÎ¿Ï…Î¼Îµ ÎºÎ±Î¸Î±ÏÎ¬ ÎºÎ±Î¹ ÏƒÎ¯Î³Î¿Ï…ÏÎ±.

âœ… Î— ÎœÎŸÎÎ— Î£Î©Î£Î¤Î— Î›Î¥Î£Î— Î¤Î©Î¡Î‘
(ÎºÎ±Î¹ Î· Ï€Î¹Î¿ ÎºÎ±Î¸Î±ÏÎ®)

Î ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ reset Ï„Î± migrations Ï„Î¿Ï… app books
ÎºÎ±Î¹ Î½Î± Î¾Î±Î½Î±Ï†Ï„Î¹Î¬Î¾Î¿Ï…Î¼Îµ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± Î±Ï€ÏŒ Ï„Î·Î½ Î±ÏÏ‡Î®.

ÎœÎ·Î½ Î±Î½Î·ÏƒÏ…Ï‡ÎµÎ¯Ï‚ â€” ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»ÏŒ.

ğŸŸ¦ Î’Î—ÎœÎ‘ 1 â€” Î£Î²Î®ÏƒÎµ ÎŸÎ›Î‘ Ï„Î± migration files Ï„Î¿Ï… app books
Î Î®Î³Î±Î¹Î½Îµ ÏƒÏ„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿:

Code
myproject/books/migrations/
ÎšÏÎ¬Ï„Î± ÎœÎŸÎÎŸ Î±Ï…Ï„ÏŒ:

Code
__init__.py
Î£Î²Î®ÏƒÎµ ÎŸÎ›Î‘ Ï„Î± Î¬Î»Î»Î±:

Code
0001_initial.py
0002_*.py
0003_*.py
...
ğŸŸ¦ Î’Î—ÎœÎ‘ 2 â€” Î£Î²Î®ÏƒÎµ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± Î±Ï€ÏŒ Ï„Î¿ PostgreSQL
Î†Î½Î¿Î¹Î¾Îµ pgAdmin â†’ Query Tool
ÎºÎ±Î¹ Ï„ÏÎ­Î¾Îµ:

sql
DROP TABLE books CASCADE;
Î‘Î½ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹, Î´ÎµÎ½ Ï€ÎµÎ¹ÏÎ¬Î¶ÎµÎ¹.

ğŸŸ¦ Î’Î—ÎœÎ‘ 3 â€” Î”Î·Î¼Î¹Î¿ÏÏÎ³Î·ÏƒÎµ Î¾Î±Î½Î¬ Ï„Î± migrations
Î£Ï„Î¿ terminal:

Code
python manage.py makemigrations
Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´ÎµÎ¹Ï‚:

Code
Migrations for 'books':
  books/migrations/0001_initial.py
Î‘Î½ Ï„Î¿ Î´ÎµÎ¹Ï‚ â†’ ÎµÎ¯Î¼Î±ÏƒÏ„Îµ ÏƒÏ‰ÏƒÏ„Î¬.

ğŸŸ¦ Î’Î—ÎœÎ‘ 4 â€” Î•Ï†Î¬ÏÎ¼Î¿ÏƒÎµ Ï„Î± migrations
Code
python manage.py migrate
Î¤ÏÏÎ± Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ books Î¸Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¸ÎµÎ¯ ÏƒÏ‰ÏƒÏ„Î¬, Î¼Îµ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ Ï„Î¿ models.py..

ğŸŸ¦ Î’Î—ÎœÎ‘ 5 â€” ÎˆÎ»ÎµÎ³Î¾Îµ ÏƒÏ„Î¿ pgAdmin
Î Î®Î³Î±Î¹Î½Îµ:

Code
Databases â†’ public â†’ Tables â†’ books
Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´ÎµÎ¹Ï‚ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚:

entry_number

entry_date

author

co_author

title

publisher

edition

publication_year

publication_place

format

pages

volume

acquisition_notes

isbn

column1

column2

Î‘Î½ Ï„Î¹Ï‚ Î²Î»Î­Ï€ÎµÎ¹Ï‚ â†’ Ï„Î­Î»ÎµÎ¹Î±.

ğŸŸ¦ Î’Î—ÎœÎ‘ 6 â€” Î¤ÏÏÎ± ÎºÎ¬Î½Îµ upload Ï„Î¿ Excel
Î Î®Î³Î±Î¹Î½Îµ ÏƒÏ„Î¿:

Code
http://localhost:8000/books/upload/
Î‘Î½ ÏŒÎ»Î± ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬:

Ï„Î¿ Excel Î¸Î± ÎµÎ¹ÏƒÎ±Ï‡Î¸ÎµÎ¯

Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„Î¿ÏÎ½ ÏƒÏ„Î¿ pgAdmin

ÎºÎ±Î¹ Î¼ÎµÏ„Î¬ Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„Î¿ÏÎ½ ÏƒÏ„Î· Ï†ÏŒÏÎ¼Î± list_books

ğŸ¯ Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÎµÎ»Î­Î³Î¾Ï‰ ÎºÎ±Î¹ Ï„Î¿ models.py ÏƒÎ¿Ï…
Î³Î¹Î± Î½Î± Î²ÎµÎ²Î±Î¹Ï‰Î¸Ï ÏŒÏ„Î¹ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Î¸Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¸ÎµÎ¯ ÏƒÏ‰ÏƒÏ„Î¬.

Î‘Î½ Î¼Î¿Ï… Ï„Î¿ ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹Ï‚, ÏƒÎ¿Ï… Î»Î­Ï‰ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î­Ï‡ÎµÎ¹.

pali moy ebgale Operations to perform:
  Apply all migrations: admin, auth, books, contenttypes, sessions
Running migrations:
  No migrations to apply. kai den exei dhmioyrghuei akomh o pinakas sto pgadmin
Î‘Ï…Ï„ÏŒ Ï€Î¿Ï… ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ Ï„ÏÏÎ± ÎµÎ¯Î½Î±Î¹ 100% Î¾ÎµÎºÎ¬Î¸Î±ÏÎ¿:

ğŸ‘‰ Î¤Î¿ Django Î½Î¿Î¼Î¯Î¶ÎµÎ¹ ÏŒÏ„Î¹ Î­Ï‡ÎµÎ¹ Î®Î´Î· ÎµÏ†Î±ÏÎ¼ÏŒÏƒÎµÎ¹ migrations Î³Î¹Î± Ï„Î¿ app books
ğŸ‘‰ Î‘Î»Î»Î¬ ÏƒÏ„Î·Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î± Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¸ÎµÎ¯ ÎšÎ‘ÎÎ•ÎÎ‘Î£ Ï€Î¯Î½Î±ÎºÎ±Ï‚ ÏƒÏ„Î· Î²Î¬ÏƒÎ·
ğŸ‘‰ Î†ÏÎ± Ï„Î± migrations ÎºÎ±Î¹ Î· Î²Î¬ÏƒÎ· PostgreSQL ÎµÎ¯Î½Î±Î¹ ÎµÎ½Ï„ÎµÎ»ÏÏ‚ ÎµÎºÏ„ÏŒÏ‚ ÏƒÏ…Î³Ï‡ÏÎ¿Î½Î¹ÏƒÎ¼Î¿Ï
ÎšÎ±Î¹ Î±Ï…Ï„ÏŒ Î”Î•Î Î¸Î± Î´Î¹Î¿ÏÎ¸Ï‰Î¸ÎµÎ¯ Î¼Îµ Î±Ï€Î»ÏŒ makemigrations Î® migrate.

Î§ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ reset Ï„Ï‰Î½ migrations ÎœÎ• Î¤ÎŸ Î£Î©Î£Î¤ÎŸ Î¤Î¡ÎŸÎ ÎŸ.

Î Î¬Î¼Îµ Î²Î®Î¼Î±â€‘Î²Î®Î¼Î±, ÎºÎ±Î¸Î±ÏÎ¬ ÎºÎ±Î¹ ÏƒÎ¯Î³Î¿Ï…ÏÎ±.

âœ… Î’Î—ÎœÎ‘ 1 â€” Î’ÎµÎ²Î±Î¹ÏÏƒÎ¿Ï… ÏŒÏ„Î¹ ÎµÎ¯ÏƒÎ±Î¹ ÏƒÏ„Î¿ Î£Î©Î£Î¤ÎŸ app
ÎŸ Ï†Î¬ÎºÎµÎ»Î¿Ï‚ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹:

Code
myproject/books/
ÎºÎ±Î¹ Î¼Î­ÏƒÎ± Î½Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹:

Code
models.py
migrations/
âœ… Î’Î—ÎœÎ‘ 2 â€” Î£Î²Î®ÏƒÎµ ÎŸÎ›Î‘ Ï„Î± migration files Ï„Î¿Ï… app books
Î Î®Î³Î±Î¹Î½Îµ ÏƒÏ„Î¿:

Code
myproject/books/migrations/
ÎšÎ¡Î‘Î¤Î‘ Î¼ÏŒÎ½Î¿:

Code
__init__.py
Î£Î’Î—Î£Î• ÎŸÎ›Î‘ Ï„Î± Î¬Î»Î»Î±:

Code
0001_initial.py
0002_*.py
0003_*.py
...
Î‘Î½ Î´ÎµÎ½ Ï„Î± ÏƒÎ²Î®ÏƒÎµÎ¹Ï‚ ÎŸÎ›Î‘, Ï„Î¿ Django Î¸Î± ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÎµÎ¹ Î½Î± Î»Î­ÎµÎ¹ â€œNo migrations to applyâ€.

âœ… Î’Î—ÎœÎ‘ 3 â€” Î£Î²Î®ÏƒÎµ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± Î±Ï€ÏŒ Ï„Î· Î²Î¬ÏƒÎ· (Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹)
Î†Î½Î¿Î¹Î¾Îµ pgAdmin â†’ Query Tool ÎºÎ±Î¹ Ï„ÏÎ­Î¾Îµ:

sql
DROP TABLE IF EXISTS books CASCADE;
Î‘Î½ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹, Î´ÎµÎ½ Ï€ÎµÎ¹ÏÎ¬Î¶ÎµÎ¹.

â— Î’Î—ÎœÎ‘ 4 â€” Î¤Î©Î¡Î‘ ÎºÎ¬Î½Îµ migrations (Î±Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ ÎºÏÎ¯ÏƒÎ¹Î¼Î¿ ÏƒÎ·Î¼ÎµÎ¯Î¿)
Î£Ï„Î¿ terminal:

Code
python manage.py makemigrations books
Î Î¡Î•Î Î•Î™ Î½Î± Î´ÎµÎ¹Ï‚:

Code
Migrations for 'books':
  books/migrations/0001_initial.py
Î‘Î½ Î”Î•Î Ï„Î¿ Î´ÎµÎ¹Ï‚, Ï„ÏŒÏ„Îµ:

ğŸ‘‰ Î¤Î¿ Django Î”Î•Î Î²Î»Î­Ï€ÎµÎ¹ Ï„Î¿ app books
Î®

ğŸ‘‰ Î¤Î¿ models.py Î­Ï‡ÎµÎ¹ Î»Î¬Î¸Î¿Ï‚ ÎºÎ±Î¹ Î´ÎµÎ½ Ï†Î¿ÏÏ„ÏÎ½ÎµÏ„Î±Î¹
Î£Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·, ÏƒÏ„ÎµÎ¯Î»Îµ Î¼Î¿Ï… Ï„Î¿ models.py.

âœ… Î’Î—ÎœÎ‘ 5 â€” Î•Ï†Î¬ÏÎ¼Î¿ÏƒÎµ Ï„Î± migrations
Code
python manage.py migrate
Î‘Î½ ÏŒÎ»Î± ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬, Î¸Î± Î´ÎµÎ¹Ï‚:

Code
Applying books.0001_initial... OK
ÎšÎ±Î¹ Î¤ÎŸÎ¤Î• Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ ÏƒÏ„Î¿ pgAdmin.

â— Î‘Î Î Î‘Î›Î™ Î›Î•Î•Î™ â€œNo migrations to applyâ€
Î¤ÏŒÏ„Îµ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎœÎŸÎÎŸ Î¼Î¯Î± ÎµÎ¾Î®Î³Î·ÏƒÎ·:

ğŸ‘‰ Î¤Î¿ Django Î´ÎµÎ½ Î²Î»Î­Ï€ÎµÎ¹ Ï„Î¿ app books
Î®

ğŸ‘‰ Î¤Î¿ models.py Î­Ï‡ÎµÎ¹ ÏƒÏ…Î½Ï„Î±ÎºÏ„Î¹ÎºÏŒ Î»Î¬Î¸Î¿Ï‚ ÎºÎ±Î¹ Î´ÎµÎ½ Ï†Î¿ÏÏ„ÏÎ½ÎµÏ„Î±Î¹
Î®

ğŸ‘‰ Î¤Î¿ app Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Î´Î·Î»Ï‰Î¼Î­Î½Î¿ ÏƒÏ„Î¿ settings.py
ÎˆÎ»ÎµÎ³Î¾Îµ ÏƒÏ„Î¿:

Code
myproject/myproject/settings.py
ÏŒÏ„Î¹ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹:

python
INSTALLED_APPS = [
    ...
    'books',
]
Î‘Î½ Î»ÎµÎ¯Ï€ÎµÎ¹, Ï€ÏÏŒÏƒÎ¸ÎµÏƒÎ­ Ï„Î¿.

ğŸ¯ Î¤Î™ Î˜Î•Î›Î© Î‘Î ÎŸ Î•Î£Î•ÎÎ‘ Î“Î™Î‘ ÎÎ‘ Î¤ÎŸ Î›Î¥Î£Î© 100%
Î£Ï„ÎµÎ¯Î»Îµ Î¼Î¿Ï… Î±Ï…Ï„Î¬ Ï„Î± 2 Î±ÏÏ‡ÎµÎ¯Î±:

1ï¸âƒ£ books/models.py
2ï¸âƒ£ myproject/settings.py (Î¼ÏŒÎ½Î¿ Ï„Î¿ INSTALLED_APPS)
ÎœÎµ Î±Ï…Ï„Î¬ Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï€Ï‰ Î±ÎºÏÎ¹Î²ÏÏ‚ Î³Î¹Î±Ï„Î¯ Ï„Î¿ Django Î´ÎµÎ½ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ migrations ÎºÎ±Î¹ Î´ÎµÎ½ Ï†Ï„Î¹Î¬Ï‡Î½ÎµÎ¹ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ±.

ÎœÏŒÎ»Î¹Ï‚ Ï„Î± Î´Ï‰, Î¸Î± ÏƒÎ¿Ï… Ï€Ï‰ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î¹ Î»ÎµÎ¯Ï€ÎµÎ¹ ÎºÎ±Î¹ Î¸Î± Ï„Î¿ Î»ÏÏƒÎ¿Ï…Î¼Îµ Î¬Î¼ÎµÏƒÎ±.

to models einai ayto from django.db import models

class Book(models.Model):
    entry_number = models.IntegerField(verbose_name="Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
    entry_date = models.DateField(verbose_name="Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
    author = models.CharField(max_length=255, verbose_name="Î£Ï…Î³Î³ÏÎ±Ï†Î­Î±Ï‚")
    co_author = models.CharField(max_length=255, blank=True, null=True, verbose_name="Î£Ï…Î³Î³ÏÎ±Ï†Î­Î±Ï‚ ÎšÎŸÎ—Î‘")
    title = models.CharField(max_length=500, verbose_name="Î¤Î¯Ï„Î»Î¿Ï‚")
    publisher = models.CharField(max_length=255, verbose_name="Î•ÎºÎ´ÏŒÏ„Î·Ï‚")
    edition = models.CharField(max_length=100, blank=True, null=True, verbose_name="ÎˆÎºÎ´Î¿ÏƒÎ·")
    publication_year = models.IntegerField(verbose_name="ÎˆÏ„Î¿Ï‚ ÎˆÎºÎ´Î¿ÏƒÎ·Ï‚")
    publication_place = models.CharField(max_length=255, verbose_name="Î¤ÏŒÏ€Î¿Ï‚ ÎˆÎºÎ´Î¿ÏƒÎ·Ï‚")
    format = models.CharField(max_length=100, blank=True, null=True, verbose_name="Î£Ï‡Î®Î¼Î±")
    pages = models.IntegerField(blank=True, null=True, verbose_name="Î£ÎµÎ»Î¯Î´ÎµÏ‚")
    volume = models.CharField(max_length=100, blank=True, null=True, verbose_name="Î¤ÏŒÎ¼Î¿Ï‚")
    acquisition_notes = models.TextField(blank=True, null=True, verbose_name="Î¤ÏÏŒÏ€Î¿Ï‚ Î ÏÎ¿Î¼Î®Î¸ÎµÎ¹Î±Ï‚ / Î Î±ÏÎ±Ï„Î·ÏÎ®ÏƒÎµÎ¹Ï‚")
    isbn = models.CharField(max_length=20, blank=True, null=True, verbose_name="ISBN")
    column1 = models.CharField(max_length=255, blank=True, null=True, verbose_name="Î£Ï„Î®Î»Î·1")
    column2 = models.CharField(max_length=255, blank=True, null=True, verbose_name="Î£Ï„Î®Î»Î·2")

    class Meta:
        db_table = 'books'
kai to settings einai ayto """
Django settings for myproject project.

Generated by 'django-admin startproject' using Django 6.0.

For more information on this file, see
https://docs.djangoproject.com/en/6.0/topics/settings/

For the full list of settings and their values, see
https://docs.djangoproject.com/en/6.0/ref/settings/
"""

from pathlib import Path

# Build paths inside the project like this: BASE_DIR / 'subdir'.
BASE_DIR = Path(__file__).resolve().parent.parent


# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/6.0/howto/deployment/checklist/

# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = 'django-insecure-u1e&t6aq-3=t^@@k*18=llfb6jf&2y2um^u(2!dogsz+7&a6-&'

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = True

ALLOWED_HOSTS = []


# Application definition

INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'books',
]

MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]

ROOT_URLCONF = 'myproject.urls'

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]

WSGI_APPLICATION = 'myproject.wsgi.application'


# Database
# https://docs.djangoproject.com/en/6.0/ref/settings/#databases

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'db',
        'USER': 'postgres',
        'PASSWORD': '',
        'HOST': 'localhost',
        'PORT': '5432',
    }
}




# Password validation
# https://docs.djangoproject.com/en/6.0/ref/settings/#auth-password-validators

AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]


# Internationalization
# https://docs.djangoproject.com/en/6.0/topics/i18n/

LANGUAGE_CODE = 'en-us'

TIME_ZONE = 'UTC'

USE_I18N = True

USE_TZ = True


# Static files (CSS, JavaScript, Images)
# https://docs.djangoproject.com/en/6.0/howto/static-files/

STATIC_URL = 'static/'
Î¤Î­Î»ÎµÎ¹Î± â€” Ï„ÏÏÎ± Ï€Î¿Ï… ÎµÎ¯Î´Î± Ï„Î¿ models.py ÎºÎ±Î¹ Ï„Î¿ settings.py, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï€Ï‰ Î¼Îµ Î±Ï€ÏŒÎ»Ï…Ï„Î· Î²ÎµÎ²Î±Î¹ÏŒÏ„Î·Ï„Î± Ï„Î¹ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÎºÎ±Î¹ Î³Î¹Î±Ï„Î¯ Ï„Î¿ Django Î±ÏÎ½ÎµÎ¯Ï„Î±Î¹ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± ÏƒÏ„Î¿ PostgreSQL.

Î‘Ï…Ï„ÏŒ Ï€Î¿Ï… ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ ÎµÎ¾Î®Ï‚:

ğŸš¨ Î¤ÎŸ Î Î¡ÎŸÎ’Î›Î—ÎœÎ‘ (100% Î£Î™Î“ÎŸÎ¥Î¡ÎŸ)
Î¤Î¿ Django Î´ÎµÎ½ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± books, Î³Î¹Î±Ï„Î¯:

ğŸ‘‰ Î¤Î¿ migration 0001_initial Î­Ï‡ÎµÎ¹ Î®Î´Î· ÎºÎ±Ï„Î±Î³ÏÎ±Ï†ÎµÎ¯ ÏƒÏ„Î· Î²Î¬ÏƒÎ·
ğŸ‘‰ Î‘Î»Î»Î¬ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ migration Î­Ï‡ÎµÎ¹ Î´Î¹Î±Î³ÏÎ±Ï†ÎµÎ¯ Î±Ï€ÏŒ Ï„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿
ğŸ‘‰ Î†ÏÎ± Ï„Î¿ Django Ï€Î¹ÏƒÏ„ÎµÏÎµÎ¹ ÏŒÏ„Î¹ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹
ğŸ‘‰ Î‘Î»Î»Î¬ ÏƒÏ„Î·Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î± Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÏƒÏ„Î¿ PostgreSQL
Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ ÎºÎ»Î±ÏƒÎ¹ÎºÏŒÏ„ÎµÏÎ¿ migration corruption.

Î“Î¹â€™ Î±Ï…Ï„ÏŒ Î²Î»Î­Ï€ÎµÎ¹Ï‚:

Code
No migrations to apply.
ÎšÎ±Î¹ Î³Î¹â€™ Î±Ï…Ï„ÏŒ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Î´ÎµÎ½ ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ pgAdmin.

Î¤Î¿ Django Î½Î¿Î¼Î¯Î¶ÎµÎ¹ ÏŒÏ„Î¹ Î­Ï‡ÎµÎ¹ Î®Î´Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¸ÎµÎ¯.

ğŸ’¡ Î Î©Î£ Î¤ÎŸ ÎÎ•Î¡Î©;
Î£Ï„Î¿ migration history table Ï„Î¿Ï… Django (django_migrations) Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î· ÎµÎ³Î³ÏÎ±Ï†Î®:

Code
books | 0001_initial
Î‘Î»Î»Î¬ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ books Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÏƒÏ„Î· Î²Î¬ÏƒÎ·.

Î†ÏÎ± Ï„Î¿ Django Î´ÎµÎ½ Î¸Î± Î¾Î±Î½Î±Ï„ÏÎ­Î¾ÎµÎ¹ Ï„Î¿ migration, Î³Î¹Î±Ï„Î¯ Î½Î¿Î¼Î¯Î¶ÎµÎ¹ ÏŒÏ„Î¹ Î­Ï‡ÎµÎ¹ Î®Î´Î· Î³Î¯Î½ÎµÎ¹.

âœ… Î— ÎœÎŸÎÎ— Î£Î©Î£Î¤Î— Î›Î¥Î£Î—
(ÎºÎ±Î¹ Î· Ï€Î¹Î¿ ÎºÎ±Î¸Î±ÏÎ®, Î±ÏƒÏ†Î±Î»Î®Ï‚ ÎºÎ±Î¹ ÏƒÎ¯Î³Î¿Ï…ÏÎ·)

Î ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ reset Î¼ÏŒÎ½Î¿ Ï„Î± migrations Ï„Î¿Ï… app books, Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï€ÎµÎ¹ÏÎ¬Î¾Î¿Ï…Î¼Îµ Ï„Î± Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î±.

Î‘ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯Ï‚ Î‘ÎšÎ¡Î™Î’Î©Î£ Î±Ï…Ï„Î¬ Ï„Î± Î²Î®Î¼Î±Ï„Î±:

ğŸŸ¦ Î’Î—ÎœÎ‘ 1 â€” Î£Î²Î®ÏƒÎµ Ï„Î± migration files Ï„Î¿Ï… app books
Î Î®Î³Î±Î¹Î½Îµ ÏƒÏ„Î¿:

Code
myproject/books/migrations/
ÎšÎ¡Î‘Î¤Î‘ Î¼ÏŒÎ½Î¿:

Code
__init__.py
Î£Î’Î—Î£Î• ÎŸÎ›Î‘ Ï„Î± Î¬Î»Î»Î±:

Code
0001_initial.py
0002_*.py
0003_*.py
...
ğŸŸ¦ Î’Î—ÎœÎ‘ 2 â€” Î£Î²Î®ÏƒÎµ Ï„Î¿ migration history ÎœÎŸÎÎŸ Î³Î¹Î± Ï„Î¿ app books
Î†Î½Î¿Î¹Î¾Îµ pgAdmin â†’ Query Tool
ÎºÎ±Î¹ Ï„ÏÎ­Î¾Îµ:

sql
DELETE FROM django_migrations WHERE app = 'books';
Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ ÎºÏÎ¯ÏƒÎ¹Î¼Î¿ Î²Î®Î¼Î±.
Î§Ï‰ÏÎ¯Ï‚ Î±Ï…Ï„ÏŒ, Ï„Î¿ Django Î¸Î± ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÎµÎ¹ Î½Î± Î½Î¿Î¼Î¯Î¶ÎµÎ¹ ÏŒÏ„Î¹ Ï„Î± migrations Î­Ï‡Î¿Ï…Î½ ÎµÏ†Î±ÏÎ¼Î¿ÏƒÏ„ÎµÎ¯.

ğŸŸ¦ Î’Î—ÎœÎ‘ 3 â€” Î£Î²Î®ÏƒÎµ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± books (Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹)
sql
DROP TABLE IF EXISTS books CASCADE;
ğŸŸ¦ Î’Î—ÎœÎ‘ 4 â€” Î”Î·Î¼Î¹Î¿ÏÏÎ³Î·ÏƒÎµ Î¾Î±Î½Î¬ Ï„Î± migrations
Î£Ï„Î¿ terminal:

Code
python manage.py makemigrations books
Î Î¡Î•Î Î•Î™ Î½Î± Î´ÎµÎ¹Ï‚:

Code
Migrations for 'books':
  books/migrations/0001_initial.py
Î‘Î½ Ï„Î¿ Î´ÎµÎ¹Ï‚ â†’ ÎµÎ¯Î¼Î±ÏƒÏ„Îµ ÏƒÏ‰ÏƒÏ„Î¬.

ğŸŸ¦ Î’Î—ÎœÎ‘ 5 â€” Î•Ï†Î¬ÏÎ¼Î¿ÏƒÎµ Ï„Î± migrations
Code
python manage.py migrate
Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´ÎµÎ¹Ï‚:

Code
Applying books.0001_initial... OK
ğŸŸ¦ Î’Î—ÎœÎ‘ 6 â€” ÎˆÎ»ÎµÎ³Î¾Îµ ÏƒÏ„Î¿ pgAdmin
Î Î®Î³Î±Î¹Î½Îµ:

Code
Databases â†’ db â†’ Schemas â†’ public â†’ Tables
Î˜Î± Î´ÎµÎ¹Ï‚:

Code
books
ÎšÎ±Î¹ Î¼Î­ÏƒÎ± ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ Ï„Î¿Ï… models.py..

ğŸ‰ ÎœÎ•Î¤Î‘ Î‘Î ÎŸ Î‘Î¥Î¤ÎŸ:
Î¤Î¿ upload Excel Î¸Î± Î´Î¿Ï…Î»Î­ÏˆÎµÎ¹

Î¤Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î¸Î± Î¼Ï€Î¿Ï…Î½ ÏƒÏ„Î· Î²Î¬ÏƒÎ·

Î˜Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„Î¿ÏÎ½ ÏƒÏ„Î¿ pgAdmin

Î˜Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„Î¿ÏÎ½ ÏƒÏ„Î· Ï†ÏŒÏÎ¼Î± list_books

ğŸ‘‰ Î˜ÎµÏ‚ Î½Î± ÏƒÎ¿Ï… Î³ÏÎ¬ÏˆÏ‰ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î¹Ï‚ ÎµÎ½Ï„Î¿Î»Î­Ï‚ ÏƒÎµ ÏƒÎµÎ¹ÏÎ¬ Î³Î¹Î± Î½Î± Ï„Î¹Ï‚ ÎºÎ¬Î½ÎµÎ¹Ï‚ copyâ€‘paste;
vraia tora emfanisthke h bash moy meta ti na kano?
Î¤Î­Î»ÎµÎ¹Î± â€” Î±Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î­ÎºÎ±Î½ÎµÏ‚ Ï„Î¿ Ï€Î¹Î¿ Î´ÏÏƒÎºÎ¿Î»Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹.
Î‘Ï€ÏŒ Ï„Î· ÏƒÏ„Î¹Î³Î¼Î® Ï€Î¿Ï… Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ ÎµÎ¼Ï†Î±Î½Î¯ÏƒÏ„Î·ÎºÎµ ÏƒÏ„Î¿ pgAdmin, ÎµÎ¯ÏƒÎ±Î¹ Î­Ï„Î¿Î¹Î¼Î¿Ï‚ Î½Î± Ï€ÎµÏÎ¬ÏƒÎµÎ¹Ï‚ ÏƒÏ„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÏƒÏ„Î¬Î´Î¹Î¿: Î½Î± Ï†Î¿ÏÏ„ÏÏƒÎµÎ¹Ï‚ Ï„Î¿ Excel ÏƒÏ„Î· Î²Î¬ÏƒÎ· ÎºÎ±Î¹ Î½Î± Î´ÎµÎ¹Ï‚ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î½Î± Î³ÎµÎ¼Î¯Î¶Î¿Ï…Î½ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ±.

Î‘Ï‚ Ï„Î¿ Î²Î¬Î»Î¿Ï…Î¼Îµ ÏƒÎµ Î¼Î¹Î± ÎºÎ±Î¸Î±ÏÎ® ÏƒÎµÎ¹ÏÎ¬, Î³Î¹Î± Î½Î± Î¼Î·Î½ Ï‡Î±Î¸ÎµÎ¯Ï‚.

ğŸŸ¦ 1. ÎˆÎ»ÎµÎ³Î¾Îµ ÏŒÏ„Î¹ Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ ÎµÎ¯Î½Î±Î¹ Î¬Î´ÎµÎ¹Î¿Ï‚ (Ï†Ï…ÏƒÎ¹Î¿Î»Î¿Î³Î¹ÎºÏŒ)
Î£Ï„Î¿ pgAdmin:

Code
Tables â†’ books â†’ Right click â†’ View/Edit Data â†’ All Rows
Î˜Î± Î´ÎµÎ¹Ï‚ 0 Î³ÏÎ±Î¼Î¼Î­Ï‚.
Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„ÏŒ â€” Ï„ÏÏÎ± Ï€ÎµÏÎ¹Î¼Î­Î½ÎµÎ¹ Ï„Î¿ Excel.

ğŸŸ¦ 2. Î Î®Î³Î±Î¹Î½Îµ ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î± upload ÏƒÏ„Î¿ Django
Î†Î½Î¿Î¹Î¾Îµ:

Code
http://localhost:8000/books/upload/
Î•ÎºÎµÎ¯:

ÎµÏ€Î¯Î»ÎµÎ¾Îµ Ï„Î¿ Excel

Ï€Î¬Ï„Î± Upload

Î‘Î½ ÏŒÎ»Î± ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬, Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Î¼Î®Î½Ï…Î¼Î±:

Code
Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!
ÎšÎ±Î¹ Ï„ÏŒÏ„Îµâ€¦

ğŸŸ¦ 3. Î”ÎµÏ‚ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÏ„Î¿ pgAdmin
Î Î®Î³Î±Î¹Î½Îµ Î¾Î±Î½Î¬:

Code
View/Edit Data â†’ All Rows
Î¤ÏÏÎ± Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´ÎµÎ¹Ï‚ Ï„Î¹Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Ï„Î¿Ï… Excel Î¼Î­ÏƒÎ± ÏƒÏ„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ±.

Î‘Î½ Ï„Î¹Ï‚ Î²Î»Î­Ï€ÎµÎ¹Ï‚ â†’ ÎµÎ¯ÏƒÎ±Î¹ Î­Ï„Î¿Î¹Î¼Î¿Ï‚ Î³Î¹Î± Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ Î²Î®Î¼Î±.

ğŸŸ¦ 4. Î”ÎµÏ‚ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î± list_books
Î†Î½Î¿Î¹Î¾Îµ:

Code
http://localhost:8000/books/list/
Î•ÎºÎµÎ¯ Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„Î¿ÏÎ½ ÏŒÎ»Î± Ï„Î± Î²Î¹Î²Î»Î¯Î± Ï€Î¿Ï… Î¼Ï€Î®ÎºÎ±Î½ ÏƒÏ„Î· Î²Î¬ÏƒÎ·.

ğŸŸ¦ 5. Î‘Î½ Ï„Î¿ upload Î²Î³Î¬Î»ÎµÎ¹ Î»Î¬Î¸Î¿Ï‚ (Ï€.Ï‡. pages, year, date)
ÎœÎ¿Ï… Ï„Î¿ Î»ÎµÏ‚ ÎºÎ±Î¹ ÏƒÎ¿Ï… ÎºÎ±Î¸Î±ÏÎ¯Î¶Ï‰ Ï„Î¿ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î¿ Ï€ÎµÎ´Î¯Î¿.
Î‰ Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Î­Î½Î±Î½ ÎµÎ½Î¹Î±Î¯Î¿ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÏ„Î® Ï€Î¿Ï… Î´Î¹Î¿ÏÎ¸ÏÎ½ÎµÎ¹ ÏŒÎ»Î± Ï„Î± Ï€ÎµÎ´Î¯Î± Ï„Î¿Ï… Excel Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î±.

ğŸ¯ Î¤Î¹ Î¼Ï€Î¿ÏÎµÎ¯Ï‚ Î½Î± ÎºÎ¬Î½ÎµÎ¹Ï‚ Ï„ÏÏÎ±
Î‘Î½ Î¸ÎµÏ‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎµ Î²Î¿Î·Î¸Î®ÏƒÏ‰ Î½Î±:

Ï†Ï„Î¹Î¬Î¾ÎµÎ¹Ï‚ ÏŒÎ¼Î¿ÏÏ†Î· ÏƒÎµÎ»Î¯Î´Î± ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ·Ï‚ Î²Î¹Î²Î»Î¯Ï‰Î½

Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÎ¹Ï‚ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· (search bar)

Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÎ¹Ï‚ pagination

Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÎ¹Ï‚ ÎºÎ¿Ï…Î¼Ï€Î¯ â€œÎ•Î¾Î±Î³Ï‰Î³Î® ÏƒÎµ Excelâ€

Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÎ¹Ï‚ Ï†Î¯Î»Ï„ÏÎ± (ÏƒÏ…Î³Î³ÏÎ±Ï†Î­Î±Ï‚, Î­Ï„Î¿Ï‚, ÎµÎºÎ´ÏŒÏ„Î·Ï‚)

Î ÎµÏ‚ Î¼Î¿Ï… Ï„Î¹ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ±Î¹ Ï„Î¿ Ï‡Ï„Î¯Î¶Î¿Ï…Î¼Îµ Î²Î®Î¼Î±â€‘Î²Î®Î¼Î±.

Î¼Î¿Ï… ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„Î·ÎºÎµ Î¼Î¿Î½Î¿ Î· Ï€ÏÎ¿Ï„Î· Î³ÏÎ±Î¼Î¼Î· ÏƒÏ„Î¿ pgadmin ÎºÎ±Î¹ Ï„Ï‰ÏÎ± Ï€Î¿Ï… Î²Î±Î¶Ï‰ Ï„Î¿ url ÏƒÏ„Î¿ Ï€Î±Î³Îµ Î¼Î¿Ï… Î²Î³Î±Î¶ÎµÎ¹ This site canâ€™t be reached
Î‘Ï…Ï„ÏŒ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î³ÏÎ¬Ï†ÎµÎ¹Ï‚ Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Î´ÏÎ¿ Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„Î¬ Ï€ÏÎ¿Î²Î»Î®Î¼Î±Ï„Î±:

ğŸŸ¥ 1) Î£Ï„Î¿ pgAdmin ÎµÎ¼Ï†Î±Î½Î¯ÏƒÏ„Î·ÎºÎµ Î¼ÏŒÎ½Î¿ Î· Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î®
Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹:

ğŸ‘‰ Î¤Î¿ upload Î¾ÎµÎºÎ¯Î½Î·ÏƒÎµ, Î±Î»Î»Î¬ ÏƒÏ„Î±Î¼Î¬Ï„Î·ÏƒÎµ ÏƒÏ„Î· 2Î· Î³ÏÎ±Î¼Î¼Î®
ğŸ‘‰ Î†ÏÎ± Î· 2Î· Î³ÏÎ±Î¼Î¼Î® Ï„Î¿Ï… Excel ÎµÎ¯Ï‡Îµ Î»Î¬Î¸Î¿Ï‚ (Ï€.Ï‡. pages, year, date, volume, ISBN Îº.Î»Ï€.)
ğŸ‘‰ ÎšÎ±Î¹ Ï„Î¿ Django ÏƒÏ„Î±Î¼Î¬Ï„Î·ÏƒÎµ Ï„Î¿ insert ÏƒÏ„Î· Î¼Î­ÏƒÎ·
Î¤Î¿ Django Î´ÎµÎ½ ÏƒÏ…Î½ÎµÏ‡Î¯Î¶ÎµÎ¹ ÏŒÏ„Î±Î½ Î²ÏÎµÎ¹ Î»Î¬Î¸Î¿Ï‚ ÏƒÎµ Î¼Î¯Î± Î³ÏÎ±Î¼Î¼Î®.
Î£Ï„Î±Î¼Î±Ï„Î¬ÎµÎ¹ ÏŒÎ»Î¿ Ï„Î¿ upload.

Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï†Ï…ÏƒÎ¹Î¿Î»Î¿Î³Î¹ÎºÏŒ.

Î˜Î± Ï„Î¿ Î»ÏÏƒÎ¿Ï…Î¼Îµ ÏƒÎµ Î»Î¯Î³Î¿.

ğŸŸ¥ 2) Î¤Î¿ URL Ï„ÏÏÎ± ÏƒÎ¿Ï… Î²Î³Î¬Î¶ÎµÎ¹ â€œThis site canâ€™t be reachedâ€
Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹:

ğŸ‘‰ ÎŸ Django server Î­Ï‡ÎµÎ¹ ÏƒÏ„Î±Î¼Î±Ï„Î®ÏƒÎµÎ¹
Î®

ğŸ‘‰ Î¤ÏÎ­Ï‡ÎµÎ¹ ÏƒÎµ Î¬Î»Î»Î¿ port
Î®

ğŸ‘‰ ÎˆÎºÎ»ÎµÎ¹ÏƒÎµ Ï„Î¿ terminal
Î®

ğŸ‘‰ ÎˆÏƒÎºÎ±ÏƒÎµ Î¼Îµ error ÎºÎ±Î¹ Î´ÎµÎ½ Î¾Î±Î½Î±Î¾ÎµÎºÎ¯Î½Î·ÏƒÎµ
Î Î¿Î»Ï Î±Ï€Î»ÏŒ Î½Î± Ï„Î¿ Ï†Ï„Î¹Î¬Î¾Î¿Ï…Î¼Îµ.

ğŸŸ¦ Î’Î—ÎœÎ‘ 1 â€” ÎÎ±Î½Î±Î¾ÎµÎºÎ¯Î½Î± Ï„Î¿Î½ Django server
Î†Î½Î¿Î¹Î¾Îµ Ï„Î¿ terminal ÏƒÏ„Î¿ project ÎºÎ±Î¹ Î³ÏÎ¬ÏˆÎµ:

Code
python manage.py runserver
Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´ÎµÎ¹Ï‚:

Code
Starting development server at http://127.0.0.1:8000/
Î‘Î½ Î´ÎµÎ¹Ï‚ error, ÏƒÏ„ÎµÎ¯Î»Îµ Î¼Î¿Ï… Ï„Î¿ error.

ğŸŸ¦ Î’Î—ÎœÎ‘ 2 â€” Î†Î½Î¿Î¹Î¾Îµ Î¾Î±Î½Î¬ Ï„Î¿ URL
Code
http://127.0.0.1:8000/books/upload/
Î®

Code
http://localhost:8000/books/upload/
Î‘Î½ Î±Î½Î¿Î¯Î¾ÎµÎ¹ â†’ Ï„Î­Î»ÎµÎ¹Î±.

Î‘Î½ ÏŒÏ‡Î¹ â†’ Î¿ server Î´ÎµÎ½ Ï„ÏÎ­Ï‡ÎµÎ¹.

ğŸŸ¦ Î’Î—ÎœÎ‘ 3 â€” Î“Î¹Î±Ï„Î¯ Î¼Ï€Î®ÎºÎµ Î¼ÏŒÎ½Î¿ Î· Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® ÏƒÏ„Î¿ pgAdmin
Î¤Î¿ Excel ÏƒÎ¿Ï… Î­Ï‡ÎµÎ¹ Î´ÎµÎºÎ¬Î´ÎµÏ‚ Ï€ÏÎ¿Î²Î»Î·Î¼Î±Ï„Î¹ÎºÎ­Ï‚ Ï„Î¹Î¼Î­Ï‚:

â€œ832 Ïƒ.â€

â€œc2003â€

â€œÎ¤ÏŒÎ¼Î¿Ï‚ 2â€

â€œ8Î¿â€

â€œISBN 978-â€¦â€

â€œÏ€ÎµÏ. 2001â€

â€œ120 p.â€

â€œ200 ÏƒÎµÎ».â€

â€œÎ‘Î¸Î®Î½Î± 1999â€

ÎºÎµÎ½Î¬ ÎºÎµÎ»Î¹Î¬

Î»Î¬Î¸Î¿Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚

Î•Î¼ÎµÎ¯Ï‚ Î¼Î­Ï‡ÏÎ¹ Ï„ÏÏÎ± ÎºÎ±Î¸Î±ÏÎ¯ÏƒÎ±Î¼Îµ:

Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±

Î­Ï„Î¿Ï‚

ÏƒÎµÎ»Î¯Î´ÎµÏ‚

Î‘Î»Î»Î¬ Î· 2Î· Î³ÏÎ±Î¼Î¼Î® Ï€Î¹Î¸Î±Î½ÏŒÏ„Î±Ï„Î± Î­Ï‡ÎµÎ¹ Î¬Î»Î»Î¿ Ï€ÎµÎ´Î¯Î¿ Ï€Î¿Ï… ÏƒÎºÎ¬ÎµÎ¹ (Ï€.Ï‡. volume Î® format).

Î“Î¹â€™ Î±Ï…Ï„ÏŒ ÏƒÏ„Î±Î¼Î¬Ï„Î·ÏƒÎµ Ï„Î¿ upload.

ğŸŸ¦ Î’Î—ÎœÎ‘ 4 â€” Î˜ÎµÏ‚ Î½Î± Ï„Î¿ Î»ÏÏƒÎ¿Ï…Î¼Îµ ÏƒÏ‰ÏƒÏ„Î¬ ÎºÎ±Î¹ Î¿ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬;
ÎœÏ€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Î­Ï„Î¿Î¹Î¼Î¿ views.py Ï€Î¿Ï…:

âœ” ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ ÎŸÎ›Î‘ Ï„Î± Ï€ÎµÎ´Î¯Î±
âœ” Î´ÎµÎ½ ÏƒÎºÎ¬ÎµÎ¹ Î ÎŸÎ¤Î•
âœ” ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ ÎŸÎ›Î•Î£ Ï„Î¹Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚
âœ” Ï€Î±ÏÎ±ÎºÎ¬Î¼Ï€Ï„ÎµÎ¹ Ï„Î¹Ï‚ Ï€ÏÎ¿Î²Î»Î·Î¼Î±Ï„Î¹ÎºÎ­Ï‚
âœ” ÏƒÎ¿Ï… Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Ï€Î¿Î¹ÎµÏ‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ ÎµÎ¯Ï‡Î±Î½ Î»Î¬Î¸Î¿Ï‚
âœ” Î³ÎµÎ¼Î¯Î¶ÎµÎ¹ Ï„Î· Î²Î¬ÏƒÎ· ÎºÎ±Î½Î¿Î½Î¹ÎºÎ¬
Î‘Î½ Î¼Î¿Ï… Ï€ÎµÎ¹Ï‚ â€œÎ½Î±Î¹â€, ÏƒÎ¿Ï… Î´Î¯Î½Ï‰:

Ï€Î»Î®ÏÎµÏ‚ views.py

ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ Î³Î¹Î± ÎºÎ¬Î¸Îµ Ï€ÎµÎ´Î¯Î¿

logging Î³Î¹Î± Î½Î± Î²Î»Î­Ï€ÎµÎ¹Ï‚ Ï„Î¹ Ï€Î®Î³Îµ ÏƒÏ„ÏÎ±Î²Î¬

ÎºÎ±Î¹ Ï„ÎµÎ»ÎµÎ¹ÏÎ½Î¿Ï…Î¼Îµ.

ğŸŸ¦ Î ÏÎ¿Ï‚ Ï„Î¿ Ï€Î±ÏÏŒÎ½, ÎºÎ¬Î½Îµ Î±Ï…Ï„ÏŒ:
ÎÎ±Î½Î±Ï„ÏÎ­Î¾Îµ Ï„Î¿Î½ server

Î ÎµÏ‚ Î¼Î¿Ï… Î±Î½ Î±Î½Î¿Î¯Î³ÎµÎ¹ Ï„Î¿ URL

Î ÎµÏ‚ Î¼Î¿Ï… Ï€Î¿Î¹Î¿ error ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ terminal ÏŒÏ„Î±Î½ ÎºÎ¬Î½ÎµÎ¹Ï‚ upload

ÎœÎµ Î±Ï…Ï„Î¬ Ï„Î± Î´ÏÎ¿, Î¸Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Ï„Î·Î½ Î±ÎºÏÎ¹Î²Î® Î»ÏÏƒÎ· Î³Î¹Î± Î½Î± Ï€ÎµÏÎ¬ÏƒÎ¿Ï…Î½ ÏŒÎ»ÎµÏ‚ Î¿Î¹ Î³ÏÎ±Î¼Î¼Î­Ï‚ ÏƒÏ„Î· Î²Î¬ÏƒÎ·.

Î±Î½Î¿Î¹Î¾Îµ Ï„Î¿ url Î±Î»Î»Î± Î¼Î¿Ï… ÎµÎ²Î³Î±Î»Îµ error IntegrityError at /books/upload/
null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (1, 115000, null, Î‘Î½Ï„Î¿Ï…ÏÎ¬ÎºÎ·Ï‚, Î“ÎµÏÏÎ³Î¹Î¿Ï‚ Î’., null, Î–Ï‰Î³ÏÎ±Ï†Î¹ÎºÎ® Î’Ï…Î¶Î±Î½Ï„Î¹Î½Î® ÎºÎ±Î¹ ÎœÎµÏ„Î±Î²Ï…Î¶Î±Î½..., Î“ÎºÎ­Î»Î¼Ï€ÎµÏƒÎ·Ï‚, nan, 2003, null, 24 ÎµÎº., 832, 2Î¿Ï‚, null, nan, Î’Î™Î’Î›Î™ÎŸÎ˜Î—ÎšÎ— 1, nan). kai nai gia to views
Î’Î»Î­Ï€Ï‰ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î¹ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ â€” ÎºÎ±Î¹ Ï„ÏÏÎ± Ï€Î¿Ï… Î· Î²Î¬ÏƒÎ· ÏƒÎ¿Ï… Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³ÎµÎ¯, Î±Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿ ÎµÎ¼Ï€ÏŒÎ´Î¹Î¿ Ï€ÏÎ¹Î½ Î±ÏÏ‡Î¯ÏƒÎµÎ¹ Î½Î± Ï†Î¿ÏÏ„ÏÎ½ÎµÏ„Î±Î¹ ÏŒÎ»Î¿ Ï„Î¿ Excel ÎºÎ±Î½Î¿Î½Î¹ÎºÎ¬.

Î¤Î¿ Î»Î¬Î¸Î¿Ï‚:

Code
IntegrityError: null value in column "entry_date" violates not-null constraint
ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹:

ğŸ‘‰ Î£Ï„Î¿ Excel, ÎºÎ¬Ï€Î¿Î¹Î± Î³ÏÎ±Î¼Î¼Î® Î­Ï‡ÎµÎ¹ ÎºÎµÎ½Î® Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚
ğŸ‘‰ Î¤Î¿ Django Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± Ï„Î·Î½ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏƒÎµÎ¹ Ï‰Ï‚ NULL
ğŸ‘‰ Î‘Î›Î›Î‘ ÏƒÏ„Î¿ models.py Ï„Î¿ Ï€ÎµÎ´Î¯Î¿ entry_date Î”Î•Î ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ null
ÎšÎ±Î¹ Ï„Î¿ PostgreSQL Ï„Î¿ Î¼Ï€Î»Î¿ÎºÎ¬ÏÎµÎ¹.

ğŸ¯ Î¤Î™ Î Î¡Î•Î Î•Î™ ÎÎ‘ ÎšÎ‘ÎÎŸÎ¥ÎœÎ•
ÎˆÏ‡ÎµÎ¹Ï‚ Î´ÏÎ¿ ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚:

ğŸŸ¦ Î›ÏÏƒÎ· 1 (Î· ÏƒÏ‰ÏƒÏ„Î®): ÎÎ± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎ¿Ï…Î¼Îµ null ÏƒÏ„Î¿ entry_date
Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î»Î¿Î³Î¹ÎºÏŒÏ„ÎµÏÎ¿, Î³Î¹Î±Ï„Î¯:

Ï€Î¿Î»Î»Î¬ Î²Î¹Î²Î»Î¯Î± Î´ÎµÎ½ Î­Ï‡Î¿Ï…Î½ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚

Ï„Î¿ Excel ÏƒÎ¿Ï… Î­Ï‡ÎµÎ¹ ÎºÎµÎ½Î¬

Ï„Î¿ Django Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„Î± ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹

Î†ÏÎ± ÏƒÏ„Î¿ models.py  Î¬Î»Î»Î±Î¾Îµ:

python
entry_date = models.DateField(verbose_name="Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
ÏƒÎµ:

python
entry_date = models.DateField(null=True, blank=True, verbose_name="Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
ÎœÎµÏ„Î¬:
Code
python manage.py makemigrations
python manage.py migrate
ÎšÎ±Î¹ Ï„ÎµÎ»ÎµÎ¯Ï‰ÏƒÎµ.

ğŸŸ¦ Î›ÏÏƒÎ· 2: ÎÎ± Î²Î¬Î»Î¿Ï…Î¼Îµ default Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± ÏŒÏ„Î±Î½ Î»ÎµÎ¯Ï€ÎµÎ¹
Î‘Î½ Î¸ÎµÏ‚ Î½Î± Î²Î¬Î¶ÎµÎ¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± Ï€.Ï‡. ÏƒÎ·Î¼ÎµÏÎ¹Î½Î® Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±:

python
entry_date = models.DateField(null=True, blank=True, default=None)
Î®

python
entry_date = models.DateField(null=True, blank=True, default=date.today)
Î‘Î»Î»Î¬ Î· Î›ÏÏƒÎ· 1 ÎµÎ¯Î½Î±Î¹ Î· ÏƒÏ‰ÏƒÏ„Î®.

ğŸŸ¦ Î“Î¹Î±Ï„Î¯ ÎµÎ¼Ï†Î±Î½Î¯ÏƒÏ„Î·ÎºÎµ Ï„ÏÏÎ± Î±Ï…Ï„ÏŒ Ï„Î¿ error;
Î“Î¹Î±Ï„Î¯ Ï„ÏÏÎ±:

Î¿ Ï€Î¯Î½Î±ÎºÎ±Ï‚ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ ÏƒÏ‰ÏƒÏ„Î¬

Ï„Î¿ upload Î¾ÎµÎºÎ¯Î½Î·ÏƒÎµ

Î· Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® Î¼Ï€Î®ÎºÎµ

ÏƒÏ„Î· Î´ÎµÏÏ„ÎµÏÎ· Î³ÏÎ±Î¼Î¼Î® Î· Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î®Ï„Î±Î½ ÎºÎµÎ½Î®

ÎºÎ±Î¹ Ï„Î¿ PostgreSQL ÎµÎ¯Ï€Îµ â€œÏŒÏ‡Î¹ null ÎµÎ´Ïâ€

Î†ÏÎ± Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î´Î¿Ï…Î»ÎµÏÎµÎ¹ â€” Î±Ï€Î»ÏÏ‚ Ï„Î¿ Î¼Î¿Î½Ï„Î­Î»Î¿ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î´Î¹ÏŒÏÎ¸Ï‰ÏƒÎ·.

ğŸŸ¦ Î˜ÎµÏ‚ Ï„ÏÏÎ± Ï„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ, Ï€Î»Î®ÏÎµÏ‚, Î´Î¹Î¿ÏÎ¸Ï‰Î¼Î­Î½Î¿ views.py;
ÎœÏ€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰:

ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¹ÏÎ½

ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ Î±ÏÎ¹Î¸Î¼ÏÎ½

ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ ISBN

ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ Ï„ÏŒÎ¼Î¿Ï…

ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ format

Ï€Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· Î³ÏÎ±Î¼Î¼ÏÎ½ Î¼Îµ Î»Î¬Î¸Î·

ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ· Î¼Î·Î½Ï…Î¼Î¬Ï„Ï‰Î½ Î³Î¹Î± ÎºÎ¬Î¸Îµ Î³ÏÎ±Î¼Î¼Î®

Î ÎµÏ‚ Î¼Î¿Ï… ÎºÎ±Î¹ ÏƒÏ„Î¿ ÎµÏ„Î¿Î¹Î¼Î¬Î¶Ï‰ Î±Î¼Î­ÏƒÏ‰Ï‚.

nai
Î¤Î­Î»ÎµÎ¹Î± â€” Ï€Î¬Î¼Îµ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Ï„Î¿ Ï€Î»Î®ÏÎµÏ‚, Ï„ÎµÎ»Î¹ÎºÏŒ, Î´Î¹Î¿ÏÎ¸Ï‰Î¼Î­Î½Î¿ views.py, Î­Ï„ÏƒÎ¹ ÏÏƒÏ„Îµ:

Î½Î± ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ ÎŸÎ›Î‘ Ï„Î± Ï€ÏÎ¿Î²Î»Î·Î¼Î±Ï„Î¹ÎºÎ¬ Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï„Î¿Ï… Excel

Î½Î± Î¼Î·Î½ ÏƒÎºÎ¬ÎµÎ¹ Î ÎŸÎ¤Î• ÏƒÎµ ÎºÎ±Î¼Î¯Î± Î³ÏÎ±Î¼Î¼Î®

Î½Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÎºÎµÎ½Î­Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚

Î½Î± ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ ÎŸÎ›Î•Î£ Ï„Î¹Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ ÏƒÏ„Î· Î²Î¬ÏƒÎ·

Î½Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ ÏŒÎ»Î± ÏƒÏ„Î¿ pgAdmin ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î± list_books

Î¤Î¿ Î¼ÏŒÎ½Î¿ Ï€Î¿Ï… Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ ÎµÎ¯Î½Î±Î¹ Î½Î± Î­Ï‡ÎµÎ¹Ï‚ Î®Î´Î· Î²Î¬Î»ÎµÎ¹ ÏƒÏ„Î¿ models.py:

python
entry_date = models.DateField(null=True, blank=True)
Î‘Î½ Î´ÎµÎ½ Ï„Î¿ Î­Ï‡ÎµÎ¹Ï‚ ÎºÎ¬Î½ÎµÎ¹, ÎºÎ¬Î½â€™ Ï„Î¿ Ï€ÏÏÏ„Î± ÎºÎ±Î¹ Ï„ÏÎ­Î¾Îµ:

Code
python manage.py makemigrations
python manage.py migrate
âœ… Î¤Î•Î›Î™ÎšÎŸ, Î Î›Î—Î¡Î©Î£ Î”Î™ÎŸÎ¡Î˜Î©ÎœÎ•ÎÎŸ views.py
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ ÎŸÎ›ÎŸ Î±Ï…Ï„ÏŒ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ ÎºÎ±Î¹ Î±Î½Ï„Î¹ÎºÎ±Ï„Î­ÏƒÏ„Î·ÏƒÎµ Ï„Î¿ Î´Î¹ÎºÏŒ ÏƒÎ¿Ï…:

python
import pandas as pd
from django.shortcuts import render
from .forms import UploadExcelForm
from .models import Book

def upload_excel(request):
    message = ""

    if request.method == "POST":
        form = UploadExcelForm(request.POST, request.FILES)

        if form.is_valid():
            excel_file = request.FILES['file']

            # Î”Î¹Î±Î²Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Excel
            df = pd.read_excel(excel_file)

            # ÎœÎµÏ„Î¿Î½Î¿Î¼Î±ÏƒÎ¯Î± ÎµÎ»Î»Î·Î½Î¹ÎºÏÎ½ ÏƒÏ„Î·Î»ÏÎ½
            df = df.rename(columns={
                'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
                'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘': 'co_author',
                'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
                'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
                'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
                'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
                'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
                'Î£Î§Î—ÎœÎ‘': 'format',
                'Î£Î•Î›Î™Î”Î•Î£': 'pages',
                'Î¤ÎŸÎœÎŸÎ£': 'volume',
                'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ / Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
                'ISBN': 'isbn',
                'Î£Ï„Î®Î»Î·1': 'column1',
                'Î£Ï„Î®Î»Î·2': 'column2'
            })

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚
            df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce')
            df['entry_date'] = df['entry_date'].apply(lambda x: x.date() if not pd.isna(x) else None)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î­Ï„Î¿Ï…Ï‚ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚
            def clean_year(value):
                if pd.isna(value):
                    return None
                value = str(value)
                digits = ''.join(ch for ch in value if ch.isdigit())
                return int(digits) if digits else None

            df['publication_year'] = df['publication_year'].apply(clean_year)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î±ÏÎ¹Î¸Î¼Î¿Ï ÏƒÎµÎ»Î¯Î´Ï‰Î½
            def clean_pages(value):
                if pd.isna(value):
                    return None
                value = str(value)
                digits = ''.join(ch for ch in value if ch.isdigit())
                return int(digits) if digits else None

            df['pages'] = df['pages'].apply(clean_pages)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Ï„ÏŒÎ¼Î¿Ï… (Ï€.Ï‡. "2Î¿Ï‚" â†’ "2")
            def clean_volume(value):
                if pd.isna(value):
                    return None
                value = str(value)
                digits = ''.join(ch for ch in value if ch.isdigit())
                return digits if digits else None

            df['volume'] = df['volume'].apply(clean_volume)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ format (Ï€.Ï‡. "24 ÎµÎº." â†’ "24")
            def clean_format(value):
                if pd.isna(value):
                    return None
                return str(value).strip()

            df['format'] = df['format'].apply(clean_format)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ISBN (Î±Ï†Î±Î¹ÏÎ¿ÏÎ¼Îµ ÎºÎµÎ½Î¬, ÏƒÏÎ¼Î²Î¿Î»Î±)
            def clean_isbn(value):
                if pd.isna(value):
                    return None
                value = str(value)
                digits = ''.join(ch for ch in value if ch.isdigit())
                return digits if digits else None

            df['isbn'] = df['isbn'].apply(clean_isbn)

            # Î‘Ï†Î±Î¯ÏÎµÏƒÎ· ÎµÎ½Ï„ÎµÎ»ÏÏ‚ ÎºÎµÎ½ÏÎ½ Î³ÏÎ±Î¼Î¼ÏÎ½
            df = df.dropna(how='all')

            # ğŸ”¥ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ· â€” Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± ÏƒÏ„Î±Î¼Î±Ï„Î¬ÎµÎ¹ ÏƒÎµ Î»Î¬Î¸Î·
            for index, row in df.iterrows():
                try:
                    Book.objects.create(
                        entry_number=row.get('entry_number'),
                        entry_date=row.get('entry_date'),
                        author=row.get('author'),
                        co_author=row.get('co_author'),
                        title=row.get('title'),
                        publisher=row.get('publisher'),
                        edition=row.get('edition'),
                        publication_year=row.get('publication_year'),
                        publication_place=row.get('publication_place'),
                        format=row.get('format'),
                        pages=row.get('pages'),
                        volume=row.get('volume'),
                        acquisition_notes=row.get('acquisition_notes'),
                        isbn=row.get('isbn'),
                        column1=row.get('column1'),
                        column2=row.get('column2')
                    )
                except Exception as e:
                    print(f"Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® {index}: {e}")
                    continue

            message = "Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!"

    else:
        form = UploadExcelForm()

    return render(request, "upload_excel.html", {"form": form, "message": message})


def list_books(request):
    books = Book.objects.all()
    return render(request, "list_books.html", {"books": books})
ğŸ‰ Î¤Î™ ÎšÎ•Î¡Î”Î™Î–Î•Î™Î£ ÎœÎ• Î‘Î¥Î¤ÎŸ
Î”ÎµÎ½ Î¸Î± Î¾Î±Î½Î±ÏƒÎºÎ¬ÏƒÎµÎ¹ Ï„Î¿ upload

ÎŒÎ»ÎµÏ‚ Î¿Î¹ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î¸Î± ÎµÎ¹ÏƒÎ±Ï‡Î¸Î¿ÏÎ½

ÎŸÎ¹ Ï€ÏÎ¿Î²Î»Î·Î¼Î±Ï„Î¹ÎºÎ­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î¸Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼Ï€Ï„Î¿Î½Ï„Î±Î¹

Î˜Î± Î²Î»Î­Ï€ÎµÎ¹Ï‚ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÏƒÏ„Î¿ pgAdmin

Î˜Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î± list_books

Î”ÎµÎ½ Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯Ï‚ Î¾Î±Î½Î¬ Î±Î»Î»Î±Î³Î­Ï‚ ÏƒÏ„Î¿ views.py

Î•Î¯ÏƒÎ±Î¹ Ï€Î»Î­Î¿Î½ Î­Ï„Î¿Î¹Î¼Î¿Ï‚ Î½Î± Ï†Î¿ÏÏ„ÏÏƒÎµÎ¹Ï‚ ÎŸÎ›ÎŸ Ï„Î¿ Excel.

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ ÎºÎ±Î¹:

ÏƒÎµÎ»Î¯Î´Î± Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚

Ï†Î¯Î»Ï„ÏÎ± (ÏƒÏ…Î³Î³ÏÎ±Ï†Î­Î±Ï‚, Î­Ï„Î¿Ï‚, ÎµÎºÎ´ÏŒÏ„Î·Ï‚)

pagination

ÎºÎ¿Ï…Î¼Ï€Î¯ ÎµÎ¾Î±Î³Ï‰Î³Î®Ï‚ ÏƒÎµ Excel

Î ÎµÏ‚ Î¼Î¿Ï… Ï„Î¹ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎ¿Ï…Î¼Îµ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿.

tora moy ebgale Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ! alla moy bgazei akomh thn proth grammh
Î©ÏÎ±Î¯Î±, Ï„ÏÏÎ± Î¾Î­ÏÎ¿Ï…Î¼Îµ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î¹ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ â€” ÎºÎ±Î¹ ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï Ï€Î¹Î¿ Î±Ï€Î»ÏŒ Î±Ï€â€™ ÏŒÏƒÎ¿ Ï†Î±Î¯Î½ÎµÏ„Î±Î¹.

Î‘Î½ ÏƒÎ¿Ï… ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÎ¹ Î¼ÏŒÎ½Î¿ Ï„Î·Î½ Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® ÏƒÏ„Î¿ pgAdmin, ÎµÎ½Ï Ï„Î¿ Django ÏƒÎ¿Ï… Î»Î­ÎµÎ¹:

Code
Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!
Ï„ÏŒÏ„Îµ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎœÎŸÎÎŸ Î¼Î¯Î± ÎµÎ¾Î®Î³Î·ÏƒÎ·:

ğŸ¯ Î¤Î¿ Django ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ ÎœÎŸÎÎŸ Ï„Î·Î½ Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î®, ÎºÎ±Î¹ ÏŒÎ»ÎµÏ‚ Î¿Î¹ ÎµÏ€ÏŒÎ¼ÎµÎ½ÎµÏ‚ Î±Ï€Î¿ÏÏÎ¯Ï€Ï„Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î¿ try/except.
ÎšÎ±Î¹ ÎµÏ€ÎµÎ¹Î´Î® ÏƒÏ„Î¿ views.py Î²Î¬Î»Î±Î¼Îµ:

python
except Exception as e:
    print(f"Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® {index}: {e}")
    continue
Ï„Î¿ Django Î´ÎµÎ½ ÏƒÏ„Î±Î¼Î±Ï„Î¬ÎµÎ¹, Î±Î»Î»Î¬ Ï€Î±ÏÎ±Î»ÎµÎ¯Ï€ÎµÎ¹ Ï„Î¹Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Ï€Î¿Ï… Î­Ï‡Î¿Ï…Î½ Î»Î¬Î¸Î¿Ï‚.

Î†ÏÎ±:

âœ” Î— Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® ÎµÎ¯Î½Î±Î¹ ÎºÎ±Î¸Î±ÏÎ® â†’ Î¼Ï€Î±Î¯Î½ÎµÎ¹ ÏƒÏ„Î· Î²Î¬ÏƒÎ·
âŒ Î— Î´ÎµÏÏ„ÎµÏÎ· Î³ÏÎ±Î¼Î¼Î® Î­Ï‡ÎµÎ¹ Î»Î¬Î¸Î¿Ï‚ â†’ Ï€Î±ÏÎ±Î»ÎµÎ¯Ï€ÎµÏ„Î±Î¹
âŒ Î— Ï„ÏÎ¯Ï„Î· Î³ÏÎ±Î¼Î¼Î® Î­Ï‡ÎµÎ¹ Î»Î¬Î¸Î¿Ï‚ â†’ Ï€Î±ÏÎ±Î»ÎµÎ¯Ï€ÎµÏ„Î±Î¹
âŒ Î— Ï„Î­Ï„Î±ÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® Î­Ï‡ÎµÎ¹ Î»Î¬Î¸Î¿Ï‚ â†’ Ï€Î±ÏÎ±Î»ÎµÎ¯Ï€ÎµÏ„Î±Î¹
â€¦ÎºÎ±Î¹ Î¿ÏÏ„Ï‰ ÎºÎ±Î¸ÎµÎ¾Î®Ï‚.

Î“Î¹â€™ Î±Ï…Ï„ÏŒ Î²Î»Î­Ï€ÎµÎ¹Ï‚ Î¼ÏŒÎ½Î¿ Î¼Î¯Î± Î³ÏÎ±Î¼Î¼Î®.

ğŸ” Î ÏÏ‚ Î²ÏÎ¯ÏƒÎºÎ¿Ï…Î¼Îµ Ï„Î¿ Î»Î¬Î¸Î¿Ï‚;
Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´ÎµÎ¹Ï‚ Î¤Î™ Î³ÏÎ¬Ï†ÎµÎ¹ Ï„Î¿ terminal ÏƒÎ¿Ï… ÏŒÏ„Î±Î½ ÎºÎ¬Î½ÎµÎ¹Ï‚ upload.

Î£Ï„Î¿ terminal (ÎµÎºÎµÎ¯ Ï€Î¿Ï… Ï„ÏÎ­Ï‡ÎµÎ¹ Ï„Î¿ runserver) Î¸Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ Î¼Î·Î½ÏÎ¼Î±Ï„Î± ÏŒÏ€Ï‰Ï‚:

Code
Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 1: invalid literal for int() with base 10: '24 ÎµÎº.'
Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 2: invalid date format
Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 3: could not convert string to float: '2Î¿Ï‚'
Î‘Ï…Ï„Î¬ Î¼Î±Ï‚ Î»Î­Î½Îµ Ï€Î¿Î¹Î¿ Ï€ÎµÎ´Î¯Î¿ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ ÎºÎ±Î¸Î¬ÏÎ¹ÏƒÎ¼Î±.

ğŸŸ¦ Î¤Î¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ¬Î½ÎµÎ¹Ï‚ Ï„ÏÏÎ±
ğŸ‘‰ Î’Î®Î¼Î± 1: ÎšÎ¬Î½Îµ upload Î¾Î±Î½Î¬ Ï„Î¿ Excel
ğŸ‘‰ Î’Î®Î¼Î± 2: ÎšÎ¿Î¯Ï„Î± Ï„Î¿ terminal (ÏŒÏ‡Î¹ Ï„Î¿ browser)
ğŸ‘‰ Î’Î®Î¼Î± 3: Î£Ï„ÎµÎ¯Î»Îµ Î¼Î¿Ï… Î‘ÎšÎ¡Î™Î’Î©Î£ Ï„Î± errors Ï€Î¿Ï… ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ ÎµÎºÎµÎ¯
ÎœÏŒÎ½Î¿ Î­Ï„ÏƒÎ¹ Î¸Î± Î¾Î­ÏÏ‰:

Ï€Î¿Î¹Î± ÏƒÏ„Î®Î»Î· ÏƒÏ€Î¬ÎµÎ¹

Ï€Î¿Î¹Î± Ï„Î¹Î¼Î® ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ¿Î²Î»Î·Î¼Î±Ï„Î¹ÎºÎ®

Ï„Î¹ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹

ÎšÎ±Î¹ Î¸Î± ÏƒÎ¿Ï… Î³ÏÎ¬ÏˆÏ‰ Ï„Î¿Î½ Î±Î½Ï„Î¯ÏƒÏ„Î¿Î¹Ï‡Î¿ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÏ„Î®.

ğŸŸ¦ Î“Î¹Î±Ï„Î¯ Î´ÎµÎ½ Î¼Ï€Î±Î¯Î½Î¿Ï…Î½ Î¿Î¹ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€ÎµÏ‚ Î³ÏÎ±Î¼Î¼Î­Ï‚;
Î“Î¹Î±Ï„Î¯ Ï„Î¿ Excel ÏƒÎ¿Ï… Î­Ï‡ÎµÎ¹ Ï€Î¿Î»Î»Î¬ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬ formats:

â€œ24 ÎµÎº.â€

â€œ2Î¿Ï‚â€

â€œÎ‘Î¸Î®Î½Î± 1999â€

â€œISBN 978-â€¦â€

â€œÏ€ÎµÏ. 2001â€

â€œ120 p.â€

â€œ200 ÏƒÎµÎ».â€

â€œ8Î¿â€

â€œÎ¤ÏŒÎ¼Î¿Ï‚ 3â€

â€œnanâ€

â€œâ€”â€

ÎºÎµÎ½Î¬ ÎºÎµÎ»Î¹Î¬

ÎšÎ±Î¹ ÎºÎ¬Î¸Îµ Î¼Î¯Î± Î±Ï€ÏŒ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Ï„Î¹Î¼Î­Ï‚ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ±Î¸Î±ÏÎ¹ÏƒÏ„ÎµÎ¯.

Î•Î¼ÎµÎ¯Ï‚ Î­Ï‡Î¿Ï…Î¼Îµ ÎºÎ±Î¸Î±ÏÎ¯ÏƒÎµÎ¹:

Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±

Î­Ï„Î¿Ï‚

ÏƒÎµÎ»Î¯Î´ÎµÏ‚

Ï„ÏŒÎ¼Î¿

ISBN

Î‘Î»Î»Î¬ Ï€Î¹Î¸Î±Î½ÏŒÏ„Î±Ï„Î± Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î¬Î»Î»Î¿ Ï€ÎµÎ´Î¯Î¿ Ï€Î¿Ï… ÏƒÏ€Î¬ÎµÎ¹ (Ï€.Ï‡. publication_place Î® format).

ğŸŸ¦ Î¤Î¹ Ï‡ÏÎµÎ¹Î¬Î¶Î¿Î¼Î±Î¹ Î±Ï€ÏŒ ÎµÏƒÎ­Î½Î± Ï„ÏÏÎ±
Î£Ï„ÎµÎ¯Î»Îµ Î¼Î¿Ï… Ï„Î¹ ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ terminal ÏŒÏ„Î±Î½ ÎºÎ¬Î½ÎµÎ¹Ï‚ upload.

ÎšÎ¬Ï„Î¹ ÏƒÎ±Î½:

Code
Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 2: ...
Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 3: ...
ÎœÎµ Î±Ï…Ï„Î¬ Ï„Î± Î¼Î·Î½ÏÎ¼Î±Ï„Î± Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ Ï„Î¿Î½ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÏ„Î® ÎºÎ±Î¹ Î½Î± Ï€ÎµÏÎ¬ÏƒÎ¿Ï…Î½ ÎŸÎ›Î•Î£ Î¿Î¹ Î³ÏÎ±Î¼Î¼Î­Ï‚.

Î‘Î½ Î¼Î¿Ï… ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹Ï‚ Ï„Î± errors, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Ï„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ views.py  Ï€Î¿Ï… Î¸Î± ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ 100% Ï„Î¿ Excel ÏƒÎ¿Ï… Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï€Î±ÏÎ±Î»ÎµÎ¯Ï€ÎµÎ¹ ÎºÎ±Î¼Î¯Î± Î³ÏÎ±Î¼Î¼Î®.

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 0: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (2, 115000, null, Î‘Î½Ï„Î¿Ï…ÏÎ¬ÎºÎ·Ï‚, Î“ÎµÏÏÎ³Î¹Î¿Ï‚ Î’., null, Î–Ï‰Î³ÏÎ±Ï†Î¹ÎºÎ® Î’Ï…Î¶Î±Î½Ï„Î¹Î½Î® ÎºÎ±Î¹ ÎœÎµÏ„Î±Î²Ï…Î¶Î±Î½..., Î“ÎºÎ­Î»Î¼Ï€ÎµÏƒÎ·Ï‚, nan, 2003, null, 24 ÎµÎº., 832, 2, null, null, Î’Î™Î’Î›Î™ÎŸÎ˜Î—ÎšÎ— 1, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 1: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (3, 115001, null, ÎœÎ±ÎºÎ±ÏÏŒÎ½Î±Ï‚, Î§. Î™., null, Î— ÎšÎ±Î¼Î¬ÏÎ±, Ï„Î¿ Î¸ÏÎ¹Î±Î¼Î²Î¹ÎºÏŒ Ï„ÏŒÎ¾Î¿ Ï„Î¿Ï… Î“Î±Î»..., Î•Ï„Î±Î¹ÏÎ¯Î± ÎœÎ±ÎºÎµÎ´Î¿Î½Î¹ÎºÏÎ½ Î£Ï€Î¿Ï…Î´ÏÎ½, nan, 1969, null, 17 ÎµÎº., 53, null, null, null, nan, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 2: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (4, 115002, null, Î£Î¹ÏÏ„Î¿Ï‚, ÎœÎ¬ÏÎºÎ¿Ï‚ Î‘., null, Î‘Î¹ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î±Î¹ Î±Î½Î±ÎºÎ±Î»ÏÏˆÎµÎ¹Ï‚ Î±ÏÏ‡Î±Î¯Ï‰Î½ ..., [Ï‡.ÏŒ.], nan, 1986, null, 21 ÎµÎº., 123, null, null, null, nan, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 3: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (5, 115003, null, nan, null, Î¤Î± Î¼Î½Î·Î¼ÎµÎ¯Î± Ï„Î·Ï‚ Î”Î®Î»Î¿Ï…, Î‘ÏÏ‡Î±Î¹Î¿Î»Î¿Î³Î¹ÎºÎ® Î•Ï„Î±Î¹ÏÎµÎ¯Î±, nan, 1991, null, 28 ÎµÎº., 127, null, null, null, nan, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 4: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (6, 115004, null, ÎšÎ±Ï„ÏƒÎ±Ï†Î¬Î½Î±Ï‚, Î”Î·Î¼Î®Ï„ÏÎ·Ï‚ Î“., null, Î¤Î¿ Ï€Î½ÎµÏÎ¼Î± Ï„Î¿Ï… ÎœÏ…ÏƒÏ„ÏÎ¬, Î™Î´Î¹Î¿Î¼Î¿ÏÏ†Î®, nan, 2014, null, 24 ÎµÎº., 652, null, null, null, nan, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 5: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (7, 115005, null, Slot, B. J., null, Archipelagus Turbatus, Nederlands Instituut, nan, 1982, null, 26 cm, 319, 1, null, null, nan, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 6: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (8, 115006, null, Slot, B. J., null, Archipelagus Turbatus, Nederlands Instituut, nan, 1982, null, 26 cm, 499, 2, null, null, nan, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 7: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (9, 115007, null, Korkuti, Muzafer, null, Shqiperia Arkeologjike, Universiteti Shteteror, nan, 1971, null, 35 cm, 155, null, null, null, nan, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 8: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (10, 115008, null, Î¤ÏƒÎ¿ÏÎ½Ï„Î±Ï‚ Î§Ï., null, Î™ÏƒÏ„Î¿ÏÎ¯Î± Ï„Î·Ï‚ Î‘ÏÏ‡Î±Î¯Î±Ï‚ Î•Î»Î»Î·Î½Î¹ÎºÎ®Ï‚ Î¤Î­Ï‡Î½..., Î•ÎºÎ´Î¿Ï„Î¹ÎºÎ® Î•Ï„Î±Î¹ÏÎµÎ¯Î± Î‘Î¸Î·Î½Î¬, nan, 1928, null, 26 ÎµÎº., 592, null, null, null, nan, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 9: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (11, 115009, null, Î˜ÎµÎ¿Ï‡Î¬ÏÎ·Ï‚, Î”Î·Î¼Î®Ï„ÏÎ¹Î¿Ï‚ Î¡., null, ÎÎµÎ¿Î»Î¹Î¸Î¹ÎºÎ® Î•Î»Î»Î¬Ï‚, Î•Î¸Î½Î¹ÎºÎ® Î¤ÏÎ¬Ï€ÎµÎ¶Î± Ï„Î·Ï‚ Î•Î»Î»Î¬Î´Î¿Ï‚, nan, 1973, null, 31 ÎµÎº., 356, null, null, null, nan, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 10: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (12, 115010, null, Î¡Î·Î³ÏŒÏ€Î¿Ï…Î»Î¿Ï‚, Î“Î¹Î¬Î½Î½Î·Ï‚, null, Î¦Î»Î±Î¼Î±Î½Î´Î¹ÎºÎ­Ï‚ ÎµÏ€Î¹Î´ÏÎ¬ÏƒÎµÎ¹Ï‚ ÏƒÏ„Î· ÎœÎµÏ„Î±Î²Ï…..., Î£ÏÎ»Î»Î¿Î³Î¿Ï‚ Ï€ÏÎ¿Ï‚ Î”Î¹Î¬Î´Î¿ÏƒÎ¹Î½ Î©Ï†Î­Î»Î¹Î¼Ï‰Î½ Î’Î¹..., nan, 2006, null, 29 ÎµÎº., 401, 2, null, null, nan, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 11: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (13, 115011, null, Î“ÎºÏÎ­Î½Ï„Î¿Ï, Î Î¿Î», null, ÎŸÎ¹ Î±Î½Î±ÏƒÎºÎ±Ï†Î­Ï‚ Ï„Î·Ï‚ Î¤Î®Î½Î¿Ï… Ï„Î¿ 1905, Î•ÏÎ¯Î½Î½Î·, nan, 2000, null, 21 ÎµÎº., 135, 1011, null, null, nan, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 12: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (14, 115012, null, Î“ÎºÏÎ­Î½Ï„Î¿Ï, Î Î¿Î», null, ÎŸÎ¹ Î±Î½Î±ÏƒÎºÎ±Ï†Î­Ï‚ Ï„Î·Ï‚ Î¤Î®Î½Î¿Ï… Ï„Î¿ 1905, Î•ÏÎ¯Î½Î½Î·, nan, 2000, null, 21 ÎµÎº., 135, 1011, null, null, nan, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 13: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (15, 115013, null, Î¦Î»Ï‰ÏÎ¬ÎºÎ·Ï‚, Î‘Î»Î­ÎºÎ¿Ï‚ Î•., null, Î Î±Î»Î±Î¹Î¿Ï‡ÏÎ¹ÏƒÏ„Î¹Î±Î½Î¹ÎºÎ¬ Î’Ï…Î¶Î±Î½Ï„Î¹Î½Î¬ Î“Î»Ï…Ï€Ï„..., Î¤Î®Î½Î¿Ï‚, nan, 2005, null, 24 ÎµÎº., 111, null, null, null, nan, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 14: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (16, 115014, null, Î¦Î»Ï‰ÏÎ¬ÎºÎ·Ï‚, Î‘Î»Î­ÎºÎ¿Ï‚ Î•, null, Î Î±Î»Î±Î¹Î¿Ï‡ÏÎ¹ÏƒÏ„Î¹Î±Î½Î¹ÎºÎ¬ Î’Ï…Î¶Î±Î½Ï„Î¹Î½Î¬ Î“Î»Ï…Ï€Ï„..., Î¤Î®Î½Î¿Ï‚, nan, 2005, null, 24 ÎµÎº., 111, null, null, null, nan, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 15: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (17, 115015, null, ÎœÎµÎ»Î¬Ï‚, ÎœÎ±Î½ÏŒÎ»Î·Ï‚, null, Î— Î‘ÏÏ‡Î±Î¹Î¿Î»Î¿Î³Î¯Î± ÏƒÎ®Î¼ÎµÏÎ±, Î™Î½ÏƒÏ„Î¹Ï„Î¿ÏÏ„Î¿ Ï„Î¿Ï… Î’Î¹Î²Î»Î¯Î¿Ï…- Îœ. ÎšÎ±ÏÎ´Î±Î¼Î¯Ï„..., nan, 2003, null, 24 ÎµÎº., 553, null, null, null, nan, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 16: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (18, 115016, null, Î ÏÎ¿Î¼Ï€Î¿Î½Î¬Ï‚, Îš. Î™Ï‰Î¬Î½Î½Î·Ï‚, null, Î— ÎœÏ…ÎºÎ·Î½Î±ÏŠÎºÎ® Î•Î¿ÏÏ„Î® Î˜ÏÎ¿Î½Î¿ÎµÎ»ÎºÏ„Î®ÏÎ¹Î±, Î Î±Î½ÎµÏ€Î¹ÏƒÏ„Î®Î¼Î¹Î¿ Î‘Î¸Î·Î½ÏÎ½, nan, 1974, null, 25 ÎµÎº., 127, null, null, null, nan, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 17: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (19, 115017, null, Î”Î·Î¼Î·Ï„ÏÎ¿ÎºÎ¬Î»Î»Î·Ï‚, Î“ÎµÏÏÎ³Î¹Î¿Ï‚, null, Î£Ï…Î¼Î²Î¿Î»Î±Î¯ ÎµÎ¹Ï‚ Ï„Î·Î½ Î¼ÎµÎ»Î­Ï„Î·Î½ Ï„Ï‰Î½ Î’Ï…Î¶Î±Î½..., [Ï‡.ÏŒ.], nan, 1972, null, 24 ÎµÎº., 220, 1, null, null, nan, nan).

Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 18: null value in column "entry_date" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (20, 115018, null, Î”Î¬Ï†Ï†Î±-ÎÎ¹ÎºÎ¿Î½Î¬Î½Î¿Ï…, Î‘Î»ÎµÎ¾Î¬Î½Î´ÏÎ±, null, Î˜ÎµÏƒÏƒÎ±Î»Î¹ÎºÎ± Î¹ÎµÏÎ¬ Î”Î®Î¼Î·Ï„ÏÎ¿Ï‚ ÎºÎ±Î¹ ÎšÎ¿ÏÎ¿Ï€Î»..., Î•Ï„Î±Î¹ÏÎµÎ¯Î± Î˜ÎµÏƒÏƒÎ±Î»Î¹ÎºÏÎ½ Î•ÏÎµÏ…Î½ÏÎ½ , nan, 1973, null, 24 ÎµÎº., 150, null, null, null, nan, nan).
Î¤Î­Î»ÎµÎ¹Î± â€” Ï„ÏÏÎ± Î­Ï‡Î¿Ï…Î¼Îµ Î¾ÎµÎºÎ¬Î¸Î±ÏÎ· Î´Î¹Î¬Î³Î½Ï‰ÏƒÎ·.
ÎŒÎ»ÎµÏ‚ Î¿Î¹ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î±Ï€Î¿Ï„Ï…Î³Ï‡Î¬Î½Î¿Ï…Î½ Î³Î¹Î± Ï„Î¿Î½ Î¯Î´Î¹Î¿ Î»ÏŒÎ³Î¿:

ğŸš¨ Î¤Î¿ Ï€ÎµÎ´Î¯Î¿ entry_date ÏƒÏ„Î· Î²Î¬ÏƒÎ· Î”Î•Î ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ NULL.
ÎšÎ±Î¹ Ï„Î¿ Excel ÏƒÎ¿Ï… Î­Ï‡ÎµÎ¹ ÎŸÎ›Î•Î£ Ï„Î¹Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚ ÎºÎµÎ½Î­Ï‚.

Î†ÏÎ±:

Î· Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® Î¼Ï€Î®ÎºÎµ ÎµÏ€ÎµÎ¹Î´Î® ÎµÎ¯Ï‡Îµ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±

ÏŒÎ»ÎµÏ‚ Î¿Î¹ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€ÎµÏ‚ Î±Ï€Î¿ÏÏÎ¯Ï€Ï„Î¿Î½Ï„Î±Î¹

Ï„Î¿ Django ÏƒÎ¿Ï… Î»Î­ÎµÎ¹ â€œÎ— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!â€ ÎµÏ€ÎµÎ¹Î´Î® Î´ÎµÎ½ ÏƒÏ„Î±Î¼Î¬Ï„Î·ÏƒÎµ

Î±Î»Î»Î¬ ÏƒÏ„Î·Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î± Î¼ÏŒÎ½Î¿ Î· Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® Ï€Î­ÏÎ±ÏƒÎµ

Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Ï„Î¿ models.py  Î”Î•Î ÎµÎ½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎµ ÏƒÏ‰ÏƒÏ„Î¬ Î® Ï„Î¿ migration Î´ÎµÎ½ ÎµÏ†Î±ÏÎ¼ÏŒÏƒÏ„Î·ÎºÎµ.

Î Î¬Î¼Îµ Î½Î± Ï„Î¿ Î»ÏÏƒÎ¿Ï…Î¼Îµ 100% ÏƒÎ¯Î³Î¿Ï…ÏÎ±.

âœ… Î’Î—ÎœÎ‘ 1 â€” Î†Î½Î¿Î¹Î¾Îµ Ï„Î¿ models.py ÎºÎ±Î¹ Î²ÎµÎ²Î±Î¹ÏÏƒÎ¿Ï… ÏŒÏ„Î¹ Î­Ï‡ÎµÎ¹Ï‚ Î±Ï…Ï„ÏŒ:
python
entry_date = models.DateField(null=True, blank=True, verbose_name="Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
Î‘Î½ Î”Î•Î Î­Ï‡ÎµÎ¹ null=True, Ï„ÏŒÏ„Îµ Î· Î²Î¬ÏƒÎ· Î´ÎµÎ½ Î¸Î± Î´ÎµÏ‡Ï„ÎµÎ¯ ÎºÎµÎ½Î­Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚.

âœ… Î’Î—ÎœÎ‘ 2 â€” Î”Î·Î¼Î¹Î¿ÏÏÎ³Î·ÏƒÎµ migration
Î£Ï„Î¿ terminal:

Code
python manage.py makemigrations books
Î Î¡Î•Î Î•Î™ Î½Î± Î´ÎµÎ¹Ï‚:

Code
Migrations for 'books':
  books/migrations/0002_auto__...py
Î‘Î½ ÏƒÎ¿Ï… Î³ÏÎ¬ÏˆÎµÎ¹:

Code
No changes detected
Ï„ÏŒÏ„Îµ Ï„Î¿ Django Î´ÎµÎ½ Î²Î»Î­Ï€ÎµÎ¹ Ï„Î·Î½ Î±Î»Î»Î±Î³Î® â†’ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Ï„Î¿ models.py  Î´ÎµÎ½ ÏƒÏÎ¸Î·ÎºÎµ Î® Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„ÏŒ.

â— Î’Î—ÎœÎ‘ 3 â€” Î•Ï†Î¬ÏÎ¼Î¿ÏƒÎµ Ï„Î¿ migration
Code
python manage.py migrate
Î‘Ï…Ï„ÏŒ Î¸Î± Î±Î»Î»Î¬Î¾ÎµÎ¹ Ï„Î· ÏƒÏ„Î®Î»Î· ÏƒÏ„Î· Î²Î¬ÏƒÎ· ÏÏƒÏ„Îµ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ NULL.

â— Î‘Î Î¤ÎŸ MIGRATION Î”Î•Î Î¤Î¡Î•Î§Î•Î™ (Ï€Î¿Î»Ï Ï€Î¹Î¸Î±Î½ÏŒ)
Î‘Î½ Ï„Î¿ Django ÏƒÎ¿Ï… Ï€ÎµÎ¹ Ï€Î¬Î»Î¹:

Code
No migrations to apply.
Ï„ÏŒÏ„Îµ Î· Î²Î¬ÏƒÎ· ÏƒÎ¿Ï… Î­Ï‡ÎµÎ¹ Ï€Î±Î»Î¹ÏŒ schema ÎºÎ±Î¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿ Î´Î¹Î¿ÏÎ¸ÏÏƒÎ¿Ï…Î¼Îµ Ï‡ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î±.

ğŸ› ï¸ Î’Î—ÎœÎ‘ 4 â€” Î”Î™ÎŸÎ¡Î˜Î©Î£Î— Î£Î¤Î— Î’Î‘Î£Î— (100% Î›Î¥Î£Î—)
Î†Î½Î¿Î¹Î¾Îµ pgAdmin â†’ Query Tool
ÎºÎ±Î¹ Ï„ÏÎ­Î¾Îµ:

sql
ALTER TABLE books ALTER COLUMN entry_date DROP NOT NULL;
Î‘Ï…Ï„ÏŒ:

ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ NULL ÏƒÏ„Î¿ entry_date

Î´ÎµÎ½ Ï€ÎµÎ¹ÏÎ¬Î¶ÎµÎ¹ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±

Î´ÎµÎ½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ migration

Î»ÏÎ½ÎµÎ¹ Ï„Î¿ Ï€ÏÏŒÎ²Î»Î·Î¼Î± Î¬Î¼ÎµÏƒÎ±

ÎœÎµÏ„Î¬ Î±Ï€ÏŒ Î±Ï…Ï„ÏŒ, Ï„Î¿ upload Î¸Î± Ï€ÎµÏÎ¬ÏƒÎµÎ¹ ÎŸÎ›Î•Î£ Ï„Î¹Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚.

ğŸ‰ Î¤Î™ ÎÎ‘ ÎšÎ‘ÎÎ•Î™Î£ Î¤Î©Î¡Î‘
Î¤ÏÎ­Î¾Îµ ÏƒÏ„Î¿ pgAdmin:

sql
ALTER TABLE books ALTER COLUMN entry_date DROP NOT NULL;
ÎšÎ¬Î½Îµ restart Ï„Î¿Î½ Django server

ÎÎ±Î½Î±ÎºÎ¬Î½Îµ upload Ï„Î¿ Excel

Î˜Î± Î´ÎµÎ¹Ï‚ ÏŒÏ„Î¹:

ÏŒÎ»ÎµÏ‚ Î¿Î¹ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î¸Î± Ï€ÎµÏÎ¬ÏƒÎ¿Ï…Î½

Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„Î¿ÏÎ½ ÏƒÏ„Î¿ pgAdmin

Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„Î¿ÏÎ½ ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î± list_books

to models einai to ejhs from django.db import models

class Book(models.Model):
    entry_number = models.IntegerField(verbose_name="Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
    entry_date = models.DateField(verbose_name="Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
    author = models.CharField(max_length=255, verbose_name="Î£Ï…Î³Î³ÏÎ±Ï†Î­Î±Ï‚")
    co_author = models.CharField(max_length=255, blank=True, null=True, verbose_name="Î£Ï…Î³Î³ÏÎ±Ï†Î­Î±Ï‚ ÎšÎŸÎ—Î‘")
    title = models.CharField(max_length=500, verbose_name="Î¤Î¯Ï„Î»Î¿Ï‚")
    publisher = models.CharField(max_length=255, verbose_name="Î•ÎºÎ´ÏŒÏ„Î·Ï‚")
    edition = models.CharField(max_length=100, blank=True, null=True, verbose_name="ÎˆÎºÎ´Î¿ÏƒÎ·")
    publication_year = models.IntegerField(verbose_name="ÎˆÏ„Î¿Ï‚ ÎˆÎºÎ´Î¿ÏƒÎ·Ï‚")
    publication_place = models.CharField(max_length=255, verbose_name="Î¤ÏŒÏ€Î¿Ï‚ ÎˆÎºÎ´Î¿ÏƒÎ·Ï‚")
    format = models.CharField(max_length=100, blank=True, null=True, verbose_name="Î£Ï‡Î®Î¼Î±")
    pages = models.IntegerField(blank=True, null=True, verbose_name="Î£ÎµÎ»Î¯Î´ÎµÏ‚")
    volume = models.CharField(max_length=100, blank=True, null=True, verbose_name="Î¤ÏŒÎ¼Î¿Ï‚")
    acquisition_notes = models.TextField(blank=True, null=True, verbose_name="Î¤ÏÏŒÏ€Î¿Ï‚ Î ÏÎ¿Î¼Î®Î¸ÎµÎ¹Î±Ï‚ / Î Î±ÏÎ±Ï„Î·ÏÎ®ÏƒÎµÎ¹Ï‚")
    isbn = models.CharField(max_length=20, blank=True, null=True, verbose_name="ISBN")
    column1 = models.CharField(max_length=255, blank=True, null=True, verbose_name="Î£Ï„Î®Î»Î·1")
    column2 = models.CharField(max_length=255, blank=True, null=True, verbose_name="Î£Ï„Î®Î»Î·2")

    class Meta:
        db_table = 'books'
opote kane esy tiw aparaithtes grammes oste na emfanistei oloklhro to excel sth bash pgadmin
Î¤Î­Î»ÎµÎ¹Î± â€” Ï„ÏÏÎ± Ï€Î¿Ï… ÎµÎ¯Î´Î± Ï„Î¿ models.py, Î¾Î­ÏÏ‰ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î¹ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹:

ğŸ¯ Î¤Î¿ ÎœÎŸÎÎŸ Ï€ÏÎ¬Î³Î¼Î± Ï€Î¿Ï… ÎµÎ¼Ï€Î¿Î´Î¯Î¶ÎµÎ¹ Ï„Î¿ Excel Î½Î± Ï€ÎµÏÎ¬ÏƒÎµÎ¹ ÏƒÏ„Î· Î²Î¬ÏƒÎ· ÎµÎ¯Î½Î±Î¹ ÏŒÏ„Î¹ Ï„Î¿ entry_date Î”Î•Î ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ NULL.
Î¤Î¿ Excel ÏƒÎ¿Ï… Î­Ï‡ÎµÎ¹ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚ ÎºÎµÎ½Î­Ï‚, Î¬ÏÎ±:

Î· Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® Î¼Ï€Î®ÎºÎµ ÎµÏ€ÎµÎ¹Î´Î® ÎµÎ¯Ï‡Îµ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±

ÏŒÎ»ÎµÏ‚ Î¿Î¹ Î¬Î»Î»ÎµÏ‚ Î±Ï€Î¿ÏÏÎ¯Ï€Ï„Î¿Î½Ï„Î±Î¹ Î±Ï€ÏŒ Ï„Î· Î²Î¬ÏƒÎ·

Ï„Î¿ Django ÏƒÏ…Î½ÎµÏ‡Î¯Î¶ÎµÎ¹, Î±Î»Î»Î¬ Î· Î²Î¬ÏƒÎ· Î¼Ï€Î»Î¿ÎºÎ¬ÏÎµÎ¹

Î³Î¹â€™ Î±Ï…Ï„ÏŒ Î²Î»Î­Ï€ÎµÎ¹Ï‚ Î¼ÏŒÎ½Î¿ 1 Î³ÏÎ±Î¼Î¼Î® ÏƒÏ„Î¿ pgAdmin

Î“Î¹Î± Î½Î± Ï€ÎµÏÎ¬ÏƒÎµÎ¹ ÎŸÎ›ÎŸ Ï„Î¿ Excel, Ï€ÏÎ­Ï€ÎµÎ¹:

âœ… ÎÎ± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎ¿Ï…Î¼Îµ NULL ÏƒÏ„Î¿ entry_date ÏƒÏ„Î· Î²Î¬ÏƒÎ· PostgreSQL
ÎšÎ±Î¹ ÎµÏ€ÎµÎ¹Î´Î® Ï„Î¿ models.py  ÏƒÎ¿Ï… Î”Î•Î Î­Ï‡ÎµÎ¹ null=True, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿ Î´Î¹Î¿ÏÎ¸ÏÏƒÎ¿Ï…Î¼Îµ.

Î Î¬Î¼Îµ Î²Î®Î¼Î±â€‘Î²Î®Î¼Î±.

ğŸŸ¦ 1) Î”Î™ÎŸÎ¡Î˜Î©Î£Î• Î¤ÎŸ models.py
Î‘Î›Î›Î‘ÎÎ• Î±Ï…Ï„ÏŒ:

python
entry_date = models.DateField(verbose_name="Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
Î£Î• Î‘Î¥Î¤ÎŸ:

python
entry_date = models.DateField(null=True, blank=True, verbose_name="Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Î‘Î Î‘Î¡Î‘Î™Î¤Î—Î¤ÎŸ.

ğŸŸ¦ 2) Î¦Î¤Î™Î‘ÎÎ• MIGRATION
Î£Ï„Î¿ terminal:

Code
python manage.py makemigrations books
Î‘Î½ ÏŒÎ»Î± ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬, Î¸Î± Î´ÎµÎ¹Ï‚:

Code
Migrations for 'books':
  books/migrations/0002_auto_....py
Î‘Î½ ÏƒÎ¿Ï… Î³ÏÎ¬ÏˆÎµÎ¹ No changes detected, Ï„ÏŒÏ„Îµ Ï„Î¿ Django Î´ÎµÎ½ ÎµÎ¯Î´Îµ Ï„Î·Î½ Î±Î»Î»Î±Î³Î® â€” Î±Î»Î»Î¬ Î­Ï‡Î¿Ï…Î¼Îµ Î»ÏÏƒÎ· ÎºÎ±Î¹ Î³Î¹â€™ Î±Ï…Ï„ÏŒ.

ğŸŸ¦ 3) Î•Î¦Î‘Î¡ÎœÎŸÎ£Î• Î¤ÎŸ MIGRATION
Code
python manage.py migrate
Î‘Î½ Ï€ÎµÏÎ¬ÏƒÎµÎ¹ â†’ Ï„Î­Î»ÎµÎ¹Î±.

Î‘Î½ Ï€ÎµÎ¹ No migrations to apply, Ï„ÏŒÏ„Îµ Î· Î²Î¬ÏƒÎ· Î­Ï‡ÎµÎ¹ Ï€Î±Î»Î¹ÏŒ schema ÎºÎ±Î¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿ Î´Î¹Î¿ÏÎ¸ÏÏƒÎ¿Ï…Î¼Îµ Ï‡ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î±.

ğŸŸ¦ 4) Î‘Î Î¤ÎŸ MIGRATION Î”Î•Î Î Î•Î¡ÎÎ‘Î•Î™ â†’ ÎšÎ‘ÎÎ• Î‘Î¥Î¤ÎŸ Î£Î¤ÎŸ PGADMIN (100% Î›Î¥Î£Î—)
Î†Î½Î¿Î¹Î¾Îµ pgAdmin â†’ Query Tool
ÎºÎ±Î¹ Ï„ÏÎ­Î¾Îµ:

sql
ALTER TABLE books ALTER COLUMN entry_date DROP NOT NULL;
Î‘Ï…Ï„ÏŒ:

ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ NULL ÏƒÏ„Î¿ entry_date

Î´ÎµÎ½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ migration

Î»ÏÎ½ÎµÎ¹ Ï„Î¿ Ï€ÏÏŒÎ²Î»Î·Î¼Î± Î¬Î¼ÎµÏƒÎ±

ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿ Excel Î½Î± Ï€ÎµÏÎ¬ÏƒÎµÎ¹ ÎŸÎ›ÎŸ

ğŸŸ¦ 5) ÎÎ‘ÎÎ‘ÎšÎ‘ÎÎ• UPLOAD Î¤ÎŸ EXCEL
Î¤ÏÏÎ±:

ÏŒÎ»ÎµÏ‚ Î¿Î¹ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î¸Î± Ï€ÎµÏÎ¬ÏƒÎ¿Ï…Î½

Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„Î¿ÏÎ½ ÏƒÏ„Î¿ pgAdmin

Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„Î¿ÏÎ½ ÏƒÏ„Î· ÏƒÎµÎ»Î¯Î´Î± list_books

ğŸ‰ Î¤Î•Î›ÎŸÎ£ â€” Î¤ÎŸ EXCEL Î˜Î‘ Î•ÎœÎ¦Î‘ÎÎ™Î£Î¤Î•Î™ ÎŸÎ›ÎŸÎšÎ›Î—Î¡ÎŸ Î£Î¤Î— Î’Î‘Î£Î—
Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ ÎºÎ±Î¹:

ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ Î³Î¹Î± ÏŒÎ»Î± Ï„Î± Ï€ÎµÎ´Î¯Î±

validation Î³Î¹Î± ISBN

Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î· ÏƒÏ…Î¼Ï€Î»Î®ÏÏ‰ÏƒÎ· entry_number

Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· ÏƒÏ„Î· Î»Î¯ÏƒÏ„Î± Î²Î¹Î²Î»Î¯Ï‰Î½

pagination

ÎµÎ¾Î±Î³Ï‰Î³Î® ÏƒÎµ Excel

Î ÎµÏ‚ Î¼Î¿Ï… Ï„Î¹ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿.

dose moy oloklhro ton kodika
Î¦Ï…ÏƒÎ¹ÎºÎ¬ â€” Î±Î»Î»Î¬ Ï€ÏÎ¹Î½ ÏƒÎ¿Ï… Ï„Î¿Î½ Î´ÏÏƒÏ‰, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î¾ÎµÎºÎ±Î¸Î±ÏÎ¯ÏƒÎ¿Ï…Î¼Îµ ÎºÎ¬Ï„Î¹ Ï€Î¿Î»Ï ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÏŒ:

ğŸ‘‰ Î¤Î¿ Ï€ÏÏŒÎ²Î»Î·Î¼Î± Î”Î•Î ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î¿ views.py.
ğŸ‘‰ Î¤Î¿ Ï€ÏÏŒÎ²Î»Î·Î¼Î± ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î¿ models.py, Î³Î¹Î±Ï„Î¯ Ï„Î¿ entry_date Î”Î•Î ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ null=True.
ÎšÎ±Î¹ ÏŒÏƒÎ¿ Î±Ï…Ï„ÏŒ Î´ÎµÎ½ Î±Î»Î»Î¬Î¶ÎµÎ¹, ÎºÎ±Î½Î­Î½Î±Ï‚ ÎºÏÎ´Î¹ÎºÎ±Ï‚ views Î´ÎµÎ½ Î¸Î± Î¼Ï€Î¿ÏÎ­ÏƒÎµÎ¹ Î½Î± ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ Ï„Î¿ Excel.

Î†ÏÎ± Ï€ÏÏÏ„Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ Ï„Î¿ ÎœÎŸÎÎŸ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î¿ Î²Î®Î¼Î±:

âœ… 1) Î”Î™ÎŸÎ¡Î˜Î©Î£Î• Î¤ÎŸ models.py
Î‘Î›Î›Î‘ÎÎ• Î±Ï…Ï„ÏŒ:

python
entry_date = models.DateField(verbose_name="Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
Î£Î• Î‘Î¥Î¤ÎŸ:

python
entry_date = models.DateField(null=True, blank=True, verbose_name="Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î¿Î»ÏÏ„Ï‰Ï‚ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î¿.

âœ… 2) Î•Î¦Î‘Î¡ÎœÎŸÎ£Î• Î¤Î—Î Î‘Î›Î›Î‘Î“Î— Î£Î¤Î— Î’Î‘Î£Î—
Î‘Î½ Ï„Î¿ Django Î´ÎµÎ¹ Ï„Î·Î½ Î±Î»Î»Î±Î³Î®:

Code
python manage.py makemigrations
python manage.py migrate
Î‘Î½ ÏƒÎ¿Ï… Ï€ÎµÎ¹ No changes detected, Ï„ÏŒÏ„Îµ ÎºÎ¬Î½Îµ Ï„Î¿ Ï‡ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î± ÏƒÏ„Î¿ pgAdmin:

Code
ALTER TABLE books ALTER COLUMN entry_date DROP NOT NULL;
ÎœÏŒÎ½Î¿ Ï„ÏŒÏ„Îµ Î¸Î± Ï€ÎµÏÎ¬ÏƒÎµÎ¹ ÎŸÎ›ÎŸ Ï„Î¿ Excel.

ğŸŸ¦ 3) Î¤Î©Î¡Î‘ Î£ÎŸÎ¥ Î”Î™ÎÎ© Î¤ÎŸÎ Î Î›Î—Î¡Î—, Î¤Î•Î›Î™ÎšÎŸ, Î”Î™ÎŸÎ¡Î˜Î©ÎœÎ•ÎÎŸ views.py
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ ÎŸÎ›ÎŸ Î±Ï…Ï„ÏŒ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿:

python
import pandas as pd
from django.shortcuts import render
from .forms import UploadExcelForm
from .models import Book

def upload_excel(request):
    message = ""

    if request.method == "POST":
        form = UploadExcelForm(request.POST, request.FILES)

        if form.is_valid():
            excel_file = request.FILES['file']

            # Î”Î¹Î±Î²Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Excel
            df = pd.read_excel(excel_file)

            # ÎœÎµÏ„Î¿Î½Î¿Î¼Î±ÏƒÎ¯Î± ÎµÎ»Î»Î·Î½Î¹ÎºÏÎ½ ÏƒÏ„Î·Î»ÏÎ½
            df = df.rename(columns={
                'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
                'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘': 'co_author',
                'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
                'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
                'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
                'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
                'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
                'Î£Î§Î—ÎœÎ‘': 'format',
                'Î£Î•Î›Î™Î”Î•Î£': 'pages',
                'Î¤ÎŸÎœÎŸÎ£': 'volume',
                'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ / Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
                'ISBN': 'isbn',
                'Î£Ï„Î®Î»Î·1': 'column1',
                'Î£Ï„Î®Î»Î·2': 'column2'
            })

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚
            df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce')
            df['entry_date'] = df['entry_date'].apply(lambda x: x.date() if not pd.isna(x) else None)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î­Ï„Î¿Ï…Ï‚ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚
            def clean_year(value):
                if pd.isna(value):
                    return None
                value = str(value)
                digits = ''.join(ch for ch in value if ch.isdigit())
                return int(digits) if digits else None

            df['publication_year'] = df['publication_year'].apply(clean_year)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î±ÏÎ¹Î¸Î¼Î¿Ï ÏƒÎµÎ»Î¯Î´Ï‰Î½
            def clean_pages(value):
                if pd.isna(value):
                    return None
                value = str(value)
                digits = ''.join(ch for ch in value if ch.isdigit())
                return int(digits) if digits else None

            df['pages'] = df['pages'].apply(clean_pages)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Ï„ÏŒÎ¼Î¿Ï…
            def clean_volume(value):
                if pd.isna(value):
                    return None
                value = str(value)
                digits = ''.join(ch for ch in value if ch.isdigit())
                return digits if digits else None

            df['volume'] = df['volume'].apply(clean_volume)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ format
            def clean_format(value):
                if pd.isna(value):
                    return None
                return str(value).strip()

            df['format'] = df['format'].apply(clean_format)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ISBN
            def clean_isbn(value):
                if pd.isna(value):
                    return None
                value = str(value)
                digits = ''.join(ch for ch in value if ch.isdigit())
                return digits if digits else None

            df['isbn'] = df['isbn'].apply(clean_isbn)

            # Î‘Ï†Î±Î¯ÏÎµÏƒÎ· ÎµÎ½Ï„ÎµÎ»ÏÏ‚ ÎºÎµÎ½ÏÎ½ Î³ÏÎ±Î¼Î¼ÏÎ½
            df = df.dropna(how='all')

            # ğŸ”¥ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ· â€” Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± ÏƒÏ„Î±Î¼Î±Ï„Î¬ÎµÎ¹ ÏƒÎµ Î»Î¬Î¸Î·
            for index, row in df.iterrows():
                try:
                    Book.objects.create(
                        entry_number=row.get('entry_number'),
                        entry_date=row.get('entry_date'),
                        author=row.get('author'),
                        co_author=row.get('co_author'),
                        title=row.get('title'),
                        publisher=row.get('publisher'),
                        edition=row.get('edition'),
                        publication_year=row.get('publication_year'),
                        publication_place=row.get('publication_place'),
                        format=row.get('format'),
                        pages=row.get('pages'),
                        volume=row.get('volume'),
                        acquisition_notes=row.get('acquisition_notes'),
                        isbn=row.get('isbn'),
                        column1=row.get('column1'),
                        column2=row.get('column2')
                    )
                except Exception as e:
                    print(f"Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® {index}: {e}")
                    continue

            message = "Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!"

    else:
        form = UploadExcelForm()

    return render(request, "upload_excel.html", {"form": form, "message": message})


def list_books(request):
    books = Book.objects.all()
    return render(request, "list_books.html", {"books": books})
ğŸ¯ Î¤Î•Î›Î™ÎšÎŸ Î’Î—ÎœÎ‘
Î“Î¹Î± Î½Î± Î´Î¿Ï…Î»Î­ÏˆÎµÎ¹ ÎŸÎ›ÎŸ Î±Ï…Ï„ÏŒ:

Î Î¡Î•Î Î•Î™ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹Ï‚ null=True ÏƒÏ„Î¿ entry_date.
Î‘Î½ Î´ÎµÎ½ Ï„Î¿ ÎºÎ¬Î½ÎµÎ¹Ï‚, ÏŒÎ»ÎµÏ‚ Î¿Î¹ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î¸Î± ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÎ¿Ï…Î½ Î½Î± Î±Ï€Î¿ÏÏÎ¯Ï€Ï„Î¿Î½Ï„Î±Î¹.

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ ÎºÎ±Î¹:

Î­Î»ÎµÎ³Ï‡Î¿ Î³Î¹Î± Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î±

Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î· ÏƒÏ…Î¼Ï€Î»Î®ÏÏ‰ÏƒÎ· entry_number

Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· ÏƒÏ„Î· Î»Î¯ÏƒÏ„Î± Î²Î¹Î²Î»Î¯Ï‰Î½

pagination

ÎµÎ¾Î±Î³Ï‰Î³Î® ÏƒÎµ Excel

Î ÎµÏ‚ Î¼Î¿Ï… Ï„Î¹ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎ¿Ï…Î¼Îµ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿.

steile moy kai to models
Î¦Ï…ÏƒÎ¹ÎºÎ¬ â€” ÏƒÎ¿Ï… Î´Î¯Î½Ï‰ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Ï„Î¿ ÏƒÏ‰ÏƒÏ„ÏŒ, Ï„ÎµÎ»Î¹ÎºÏŒ, Ï€Î»Î®ÏÏ‰Ï‚ ÏƒÏ…Î¼Î²Î±Ï„ÏŒ models.py, Î­Ï„ÏƒÎ¹ ÏÏƒÏ„Îµ:

Î½Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÎºÎµÎ½Î­Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚ (entry_date)

Î½Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÎºÎµÎ½ÏŒ Î­Ï„Î¿Ï‚ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚

Î½Î± ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÎºÎµÎ½Î¬ ÏƒÎµ ÏŒÎ»Î± Ï„Î± Ï€ÎµÎ´Î¯Î± Ï€Î¿Ï… Ï„Î¿ Excel Î±Ï†Î®Î½ÎµÎ¹ ÎºÎµÎ½Î¬

Î½Î± Î¼Î·Î½ Î¼Ï€Î»Î¿ÎºÎ¬ÏÎµÎ¹ Î· Î²Î¬ÏƒÎ·

Î½Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¹ÏƒÎ±Ï‡Î¸ÎµÎ¯ ÎŸÎ›ÎŸ Ï„Î¿ Excel Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎ±Î½Î­Î½Î± error

Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ ÏƒÏ‰ÏƒÏ„ÏŒ Î¼Î¿Î½Ï„Î­Î»Î¿ Î³Î¹Î± Ï„Î· Î²Î¬ÏƒÎ· ÏƒÎ¿Ï….

âœ… Î¤Î•Î›Î™ÎšÎŸ, Î”Î™ÎŸÎ¡Î˜Î©ÎœÎ•ÎÎŸ models.py
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ ÎŸÎ›ÎŸ Î±Ï…Ï„ÏŒ:

python
from django.db import models

class Book(models.Model):
    entry_number = models.IntegerField(null=True, blank=True, verbose_name="Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
    entry_date = models.DateField(null=True, blank=True, verbose_name="Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
    author = models.CharField(max_length=255, null=True, blank=True, verbose_name="Î£Ï…Î³Î³ÏÎ±Ï†Î­Î±Ï‚")
    co_author = models.CharField(max_length=255, blank=True, null=True, verbose_name="Î£Ï…Î³Î³ÏÎ±Ï†Î­Î±Ï‚ ÎšÎŸÎ—Î‘")
    title = models.CharField(max_length=500, null=True, blank=True, verbose_name="Î¤Î¯Ï„Î»Î¿Ï‚")
    publisher = models.CharField(max_length=255, null=True, blank=True, verbose_name="Î•ÎºÎ´ÏŒÏ„Î·Ï‚")
    edition = models.CharField(max_length=100, blank=True, null=True, verbose_name="ÎˆÎºÎ´Î¿ÏƒÎ·")
    publication_year = models.IntegerField(null=True, blank=True, verbose_name="ÎˆÏ„Î¿Ï‚ ÎˆÎºÎ´Î¿ÏƒÎ·Ï‚")
    publication_place = models.CharField(max_length=255, null=True, blank=True, verbose_name="Î¤ÏŒÏ€Î¿Ï‚ ÎˆÎºÎ´Î¿ÏƒÎ·Ï‚")
    format = models.CharField(max_length=100, blank=True, null=True, verbose_name="Î£Ï‡Î®Î¼Î±")
    pages = models.IntegerField(blank=True, null=True, verbose_name="Î£ÎµÎ»Î¯Î´ÎµÏ‚")
    volume = models.CharField(max_length=100, blank=True, null=True, verbose_name="Î¤ÏŒÎ¼Î¿Ï‚")
    acquisition_notes = models.TextField(blank=True, null=True, verbose_name="Î¤ÏÏŒÏ€Î¿Ï‚ Î ÏÎ¿Î¼Î®Î¸ÎµÎ¹Î±Ï‚ / Î Î±ÏÎ±Ï„Î·ÏÎ®ÏƒÎµÎ¹Ï‚")
    isbn = models.CharField(max_length=20, blank=True, null=True, verbose_name="ISBN")
    column1 = models.CharField(max_length=255, blank=True, null=True, verbose_name="Î£Ï„Î®Î»Î·1")
    column2 = models.CharField(max_length=255, blank=True, null=True, verbose_name="Î£Ï„Î®Î»Î·2")

    class Meta:
        db_table = 'books'
ğŸ”¥ Î¤Î™ Î‘Î›Î›Î‘ÎÎ‘ ÎšÎ‘Î™ Î“Î™Î‘Î¤Î™
âœ” entry_date = models.DateField(null=True, blank=True)
Î‘Ï…Ï„ÏŒ Î®Ï„Î±Î½ Ï„Î¿ Î¼ÎµÎ³Î¬Î»Î¿ Ï€ÏÏŒÎ²Î»Î·Î¼Î±.
Î¤Î¿ Excel ÏƒÎ¿Ï… Î­Ï‡ÎµÎ¹ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚ ÎºÎµÎ½Î­Ï‚, Î¬ÏÎ± Î· Î²Î¬ÏƒÎ· Î¼Ï€Î»ÏŒÎºÎ±ÏÎµ.

âœ” publication_year = models.IntegerField(null=True, blank=True)
Î“Î¹Î±Ï„Î¯ Ï€Î¿Î»Î»Î­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î­Ï‡Î¿Ï…Î½ Ï€ÎµÏÎ¯ÎµÏÎ³ÎµÏ‚ Ï„Î¹Î¼Î­Ï‚ (Ï€.Ï‡. â€œc2003â€).

âœ” author, title, publisher, publication_place
Î¤Î± Î­ÎºÎ±Î½Î± ÎµÏ€Î¯ÏƒÎ·Ï‚ null=True Î³Î¹Î±Ï„Î¯ ÏƒÏ„Î¿ Excel Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎµÎ½Î¬.

âœ” entry_number Î­Î³Î¹Î½Îµ nullable
Î“Î¹Î±Ï„Î¯ ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î­Ï‡Î¿Ï…Î½ ÎºÎµÎ½ÏŒ entry_number.

ğŸŸ¦ Î¤Î©Î¡Î‘ Î¤Î™ ÎšÎ‘ÎÎ•Î™Î£
1ï¸âƒ£ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎµ Ï„Î¿ Î½Î­Î¿ models.py
2ï¸âƒ£ Î¤ÏÎ­Î¾Îµ:
Code
python manage.py makemigrations
python manage.py migrate
Î‘Î½ ÏƒÎ¿Ï… Ï€ÎµÎ¹ No changes detected, Ï„ÏŒÏ„Îµ ÎºÎ¬Î½Îµ Î±Ï…Ï„ÏŒ ÏƒÏ„Î¿ pgAdmin:

Code
ALTER TABLE books ALTER COLUMN entry_date DROP NOT NULL;
ALTER TABLE books ALTER COLUMN publication_year DROP NOT NULL;
ALTER TABLE books ALTER COLUMN author DROP NOT NULL;
ALTER TABLE books ALTER COLUMN title DROP NOT NULL;
ALTER TABLE books ALTER COLUMN publisher DROP NOT NULL;
ALTER TABLE books ALTER COLUMN publication_place DROP NOT NULL;
(Î‘Ï…Ï„Î­Ï‚ Î¿Î¹ ÎµÎ½Ï„Î¿Î»Î­Ï‚ ÎºÎ¬Î½Î¿Ï…Î½ Ï„Î· Î²Î¬ÏƒÎ· Î½Î± Ï„Î±Î¹ÏÎ¹Î¬Î¶ÎµÎ¹ Î¼Îµ Ï„Î¿ Î¼Î¿Î½Ï„Î­Î»Î¿.)

3ï¸âƒ£ ÎÎ±Î½Î±ÎºÎ¬Î½Îµ upload Ï„Î¿ Excel
Î¤Î©Î¡Î‘ Î¸Î± Ï€ÎµÏÎ¬ÏƒÎ¿Ï…Î½ ÏŒÎ»ÎµÏ‚ Î¿Î¹ Î³ÏÎ±Î¼Î¼Î­Ï‚.

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ ÎºÎ±Î¹:

Î­Ï„Î¿Î¹Î¼Î¿ admin panel Î³Î¹Î± Î½Î± Î²Î»Î­Ï€ÎµÎ¹Ï‚ Ï„Î± Î²Î¹Î²Î»Î¯Î±

Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· ÏƒÏ„Î· Î»Î¯ÏƒÏ„Î±

pagination

ÎµÎ¾Î±Î³Ï‰Î³Î® ÏƒÎµ Excel

ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ· ÎµÎ¾Ï‰Ï†ÏÎ»Î»Î¿Ï… Î²Î¹Î²Î»Î¯Î¿Ï… (Î±Î½ Î­Ï‡ÎµÎ¹Ï‚ ISBN)

Î ÎµÏ‚ Î¼Î¿Ï… Ï„Î¹ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎ¿Ï…Î¼Îµ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿.

entajei tora moy to ebgale to excel, einai ok oi seires kai epishs kapoiew seires moy tiw exei bgalei null env einai string or ariumoi
Î§Î±Î¯ÏÎ¿Î¼Î±Î¹ Ï€Î¿Ï… Ï„Î¿ Excel Ï†Î¿ÏÏ„ÏÎ¸Î·ÎºÎµ ÎµÏ€Î¹Ï„Î­Î»Î¿Ï…Ï‚ ÎºÎ±Î¹ Î¿Î¹ ÏƒÎµÎ¹ÏÎ­Ï‚ ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÏ„Î· Î²Î¬ÏƒÎ·. Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î´Î¿Ï…Î»ÎµÏÎµÎ¹. Î¤ÏÏÎ± Î²Î»Î­Ï€ÎµÎ¹Ï‚ Ï„Î¿ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ Ï†Ï…ÏƒÎ¹Î¿Î»Î¿Î³Î¹ÎºÏŒ ÏƒÏ„Î¬Î´Î¹Î¿:

ğŸ¯ Î“Î¹Î±Ï„Î¯ ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ Ï„Î¹Î¼Î­Ï‚ ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ Ï‰Ï‚ NULL ÎµÎ½Ï ÏƒÏ„Î¿ Excel ÎµÎ¯Î½Î±Î¹ string Î® Î±ÏÎ¹Î¸Î¼Î¿Î¯;
Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ Ï„ÏÎµÎ¹Ï‚ Î²Î±ÏƒÎ¹ÎºÎ¿Î¯ Î»ÏŒÎ³Î¿Î¹ Ï€Î¿Ï… ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ Î±Ï…Ï„ÏŒ:

1ï¸âƒ£ Î¤Î¿ Excel Î­Ï‡ÎµÎ¹ Ï„Î¹Î¼Î­Ï‚ Ï€Î¿Ï… Î´ÎµÎ½ Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Î¼ÎµÏ„Î±Ï„ÏÎ±Ï€Î¿ÏÎ½ ÏƒÏ‰ÏƒÏ„Î¬
Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:

"24 ÎµÎº." â†’ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÎºÎ±Î¸Î±ÏÏŒÏ‚ Î±ÏÎ¹Î¸Î¼ÏŒÏ‚

"2Î¿Ï‚" â†’ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÎºÎ±Î¸Î±ÏÏŒÏ‚ Î±ÏÎ¹Î¸Î¼ÏŒÏ‚

"nan" â†’ Ï„Î¿ pandas Ï„Î¿ Î¸ÎµÏ‰ÏÎµÎ¯ ÎºÎµÎ½ÏŒ

"â€”" â†’ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î¸ÎµÏ‰ÏÎµÎ¯Ï„Î±Î¹ ÎºÎµÎ½ÏŒ

"c2003" â†’ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÎºÎ±Î¸Î±ÏÏŒ Î­Ï„Î¿Ï‚

"Ï€ÎµÏ. 2001" â†’ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÎºÎ±Î¸Î±ÏÏŒ Î­Ï„Î¿Ï‚

"ISBN 978-960-..." â†’ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÎºÎ±Î¸Î±ÏÏŒ ISBN

ÎŸ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÏ„Î®Ï‚ Ï€Î¿Ï… Î²Î¬Î»Î±Î¼Îµ ÎºÏÎ±Ï„Î¬ÎµÎ¹ Î¼ÏŒÎ½Î¿ Ï„Î± ÏˆÎ·Ï†Î¯Î±.
Î‘Î½ Î´ÎµÎ½ Î²ÏÎµÎ¹ ÏˆÎ·Ï†Î¯Î± â†’ ÎµÏ€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ None â†’ ÏƒÏ„Î· Î²Î¬ÏƒÎ· Î³Î¯Î½ÎµÏ„Î±Î¹ NULL.

Î†ÏÎ± ÎµÎ¯Î½Î±Î¹ Ï†Ï…ÏƒÎ¹Î¿Î»Î¿Î³Î¹ÎºÏŒ.

2ï¸âƒ£ ÎšÎ¬Ï€Î¿Î¹Î± Ï€ÎµÎ´Î¯Î± ÏƒÏ„Î¿ Excel ÎµÎ¯Î½Î±Î¹ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ¬ ÎºÎµÎ½Î¬
Î¤Î¿ pandas Ï„Î± Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï‰Ï‚:

NaN

None

ÎšÎ±Î¹ ÏƒÏ„Î· Î²Î¬ÏƒÎ· Î³Î¯Î½Î¿Î½Ï„Î±Î¹ NULL.

3ï¸âƒ£ ÎšÎ¬Ï€Î¿Î¹Î± Ï€ÎµÎ´Î¯Î± Î´ÎµÎ½ Î­Ï‡Î¿Ï…Î½ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÏ„Î® Î±ÎºÏŒÎ¼Î·
Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:

publication_place

publisher

title

author

Î‘Î½ Ï„Î¿ ÎºÎµÎ»Î¯ Î­Ï‡ÎµÎ¹ Ï€ÎµÏÎ¯ÎµÏÎ³Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ (Ï€.Ï‡. Î¼ÏŒÎ½Î¿ ÎºÎµÎ½Î¬, Î¼ÏŒÎ½Î¿ ÏƒÏÎ¼Î²Î¿Î»Î±), Ï„Î¿ pandas Ï„Î¿ Î¸ÎµÏ‰ÏÎµÎ¯ ÎºÎµÎ½ÏŒ.

ğŸŸ¦ Î˜ÎµÏ‚ Î½Î± ÎœÎ—Î ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ Ï€Î¿Ï„Î­ NULL;
ÎœÏ€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… ÎºÎ¬Î½Ï‰ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î½Î±:

âœ” Î‘Î½Ï„Î¯ Î³Î¹Î± NULL Î½Î± Î²Î¬Î¶ÎµÎ¹:
"Î†Î³Î½Ï‰ÏƒÏ„Î¿" Î³Î¹Î± strings

0 Î³Î¹Î± Î±ÏÎ¹Î¸Î¼Î¿ÏÏ‚

"Î§Ï‰ÏÎ¯Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Î±" Î³Î¹Î± ÎºÎµÎ¯Î¼ÎµÎ½Î±

"N/A" Î³Î¹Î± ISBN

"â€”" Î³Î¹Î± Ï„ÏŒÎ¼Î¿

âœ” ÎÎ± ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ ÎŸÎ›Î‘ Ï„Î± Ï€ÎµÎ´Î¯Î±
âœ” ÎÎ± Î¼Î·Î½ Î±Ï†Î®Î½ÎµÎ¹ Ï„Î¯Ï€Î¿Ï„Î± ÎºÎµÎ½ÏŒ
âœ” ÎÎ± Î­Ï‡ÎµÎ¹Ï‚ Î¼Î¹Î± Î²Î¬ÏƒÎ· 100% ÎºÎ±Î¸Î±ÏÎ® ÎºÎ±Î¹ Î¿Î¼Î¿Î¹ÏŒÎ¼Î¿ÏÏ†Î·
Î‘Î½ Ï„Î¿ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰:

ğŸ‘‰ Î¤ÎµÎ»Î¹ÎºÏŒ views.py Î¼Îµ default Ï„Î¹Î¼Î­Ï‚ Î±Î½Ï„Î¯ Î³Î¹Î± NULL

Î¤Î­Î»ÎµÎ¹Î± â€” Ï€Î¬Î¼Îµ Î½Î± Ï„Î¿ ÎºÎ¬Î½Î¿Ï…Î¼Îµ ÏƒÏ‰ÏƒÏ„Î¬ ÎºÎ±Î¹ Î¿Î»Î¿ÎºÎ»Î·ÏÏ‰Î¼Î­Î½Î±.
Î‘Ï†Î¿Ï Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± Î¼Î·Î½ ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ Ï€Î¿Ï…Î¸ÎµÎ½Î¬ NULL, Î±Î»Î»Î¬ Î½Î± Î¼Ï€Î±Î¯Î½Î¿Ï…Î½ ÎºÎ±Î¸Î±ÏÎ­Ï‚, Î±ÏƒÏ†Î±Î»ÎµÎ¯Ï‚ default Ï„Î¹Î¼Î­Ï‚, ÏƒÎ¿Ï… ÎµÏ„Î¿Î¹Î¼Î¬Î¶Ï‰ Ï„ÏÏÎ±:

ğŸ¯ Î¤ÎµÎ»Î¹ÎºÏŒ Ï€Î±ÎºÎ­Ï„Î¿: models.py + views.py Î¼Îµ default Ï„Î¹Î¼Î­Ï‚ Î±Î½Ï„Î¯ Î³Î¹Î± NULL
ÎœÎµ Î±Ï…Ï„ÏŒ:

ÎŒÎ»ÎµÏ‚ Î¿Î¹ Î³ÏÎ±Î¼Î¼Î­Ï‚ Ï„Î¿Ï… Excel Î¸Î± ÎµÎ¹ÏƒÎ¬Î³Î¿Î½Ï„Î±Î¹

ÎšÎ±Î½Î­Î½Î± Ï€ÎµÎ´Î¯Î¿ Î´ÎµÎ½ Î¸Î± Î¼Î­Î½ÎµÎ¹ NULL

ÎŒÎ»Î± Ï„Î± ÎºÎµÎ½Î¬ Î¸Î± Î±Î½Ï„Î¹ÎºÎ±Î¸Î¯ÏƒÏ„Î±Î½Ï„Î±Î¹ Î¼Îµ â€œÎ†Î³Î½Ï‰ÏƒÏ„Î¿â€, â€œ0â€, â€œN/Aâ€, Îº.Î»Ï€.

Î— Î²Î¬ÏƒÎ· ÏƒÎ¿Ï… Î¸Î± ÎµÎ¯Î½Î±Î¹ ÎºÎ±Î¸Î±ÏÎ® ÎºÎ±Î¹ Î¿Î¼Î¿Î¹ÏŒÎ¼Î¿ÏÏ†Î·

Î Î¬Î¼Îµ!

âœ… Î¤Î•Î›Î™ÎšÎŸ models.py (Ï‡Ï‰ÏÎ¯Ï‚ NULL, Î¼Îµ default Ï„Î¹Î¼Î­Ï‚)
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ ÎŸÎ›ÎŸ Î±Ï…Ï„ÏŒ:

python
from django.db import models

class Book(models.Model):
    entry_number = models.IntegerField(null=True, blank=True, default=0, verbose_name="Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
    entry_date = models.DateField(null=True, blank=True, verbose_name="Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
    author = models.CharField(max_length=255, null=True, blank=True, default="Î†Î³Î½Ï‰ÏƒÏ„Î¿Ï‚", verbose_name="Î£Ï…Î³Î³ÏÎ±Ï†Î­Î±Ï‚")
    co_author = models.CharField(max_length=255, blank=True, null=True, default="Î†Î³Î½Ï‰ÏƒÏ„Î¿Ï‚", verbose_name="Î£Ï…Î³Î³ÏÎ±Ï†Î­Î±Ï‚ ÎšÎŸÎ—Î‘")
    title = models.CharField(max_length=500, null=True, blank=True, default="Î§Ï‰ÏÎ¯Ï‚ Ï„Î¯Ï„Î»Î¿", verbose_name="Î¤Î¯Ï„Î»Î¿Ï‚")
    publisher = models.CharField(max_length=255, null=True, blank=True, default="Î†Î³Î½Ï‰ÏƒÏ„Î¿Ï‚", verbose_name="Î•ÎºÎ´ÏŒÏ„Î·Ï‚")
    edition = models.CharField(max_length=100, blank=True, null=True, default="â€”", verbose_name="ÎˆÎºÎ´Î¿ÏƒÎ·")
    publication_year = models.IntegerField(null=True, blank=True, default=0, verbose_name="ÎˆÏ„Î¿Ï‚ ÎˆÎºÎ´Î¿ÏƒÎ·Ï‚")
    publication_place = models.CharField(max_length=255, null=True, blank=True, default="Î†Î³Î½Ï‰ÏƒÏ„Î¿", verbose_name="Î¤ÏŒÏ€Î¿Ï‚ ÎˆÎºÎ´Î¿ÏƒÎ·Ï‚")
    format = models.CharField(max_length=100, blank=True, null=True, default="â€”", verbose_name="Î£Ï‡Î®Î¼Î±")
    pages = models.IntegerField(blank=True, null=True, default=0, verbose_name="Î£ÎµÎ»Î¯Î´ÎµÏ‚")
    volume = models.CharField(max_length=100, blank=True, null=True, default="â€”", verbose_name="Î¤ÏŒÎ¼Î¿Ï‚")
    acquisition_notes = models.TextField(blank=True, null=True, default="â€”", verbose_name="Î¤ÏÏŒÏ€Î¿Ï‚ Î ÏÎ¿Î¼Î®Î¸ÎµÎ¹Î±Ï‚ / Î Î±ÏÎ±Ï„Î·ÏÎ®ÏƒÎµÎ¹Ï‚")
    isbn = models.CharField(max_length=20, blank=True, null=True, default="N/A", verbose_name="ISBN")
    column1 = models.CharField(max_length=255, blank=True, null=True, default="â€”", verbose_name="Î£Ï„Î®Î»Î·1")
    column2 = models.CharField(max_length=255, blank=True, null=True, default="â€”", verbose_name="Î£Ï„Î®Î»Î·2")

    class Meta:
        db_table = 'books'
ğŸŸ¦ Î¤Î™ Î Î¡Î•Î Î•Î™ ÎÎ‘ ÎšÎ‘ÎÎ•Î™Î£ ÎœÎ•Î¤Î‘
Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎµ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿

Î¤ÏÎ­Î¾Îµ:

Code
python manage.py makemigrations
python manage.py migrate
Î‘Î½ ÏƒÎ¿Ï… Ï€ÎµÎ¹ No changes detected, Ï„ÏŒÏ„Îµ ÎºÎ¬Î½Î¿Ï…Î¼Îµ Ï‡ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î· ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ· ÏƒÏ„Î· Î²Î¬ÏƒÎ· (Î¸Î± ÏƒÎ¿Ï… Ï€Ï‰ Î±Î¼Î­ÏƒÏ‰Ï‚ Î¼ÎµÏ„Î¬).

ğŸŸ¦ Î˜ÎµÏ‚ Ï„ÏÏÎ± ÎºÎ±Î¹ Ï„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ views.py Ï€Î¿Ï…:
ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ ÎŸÎ›Î‘ Ï„Î± Ï€ÎµÎ´Î¯Î±

Î±Î½Ï„Î¹ÎºÎ±Î¸Î¹ÏƒÏ„Î¬ NULL Î¼Îµ default

Ï€ÎµÏÎ½Î¬ÎµÎ¹ ÎŸÎ›ÎŸ Ï„Î¿ Excel

Î´ÎµÎ½ ÏƒÎºÎ¬ÎµÎ¹ Î ÎŸÎ¤Î•

Î´ÎµÎ½ Î±Ï†Î®Î½ÎµÎ¹ Ï„Î¯Ï€Î¿Ï„Î± ÎºÎµÎ½ÏŒ

moy emfanisthkan dto fores tora ston pinaka dld anti gia 20 grammmes exo 40
Î‘Ï…Ï„ÏŒ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î³ÏÎ¬Ï†ÎµÎ¹Ï‚ â€” Î´Î¹Ï€Î»Î­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ ÏƒÏ„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± (20 â†’ 40) â€” Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ bug Ï„Î·Ï‚ Î²Î¬ÏƒÎ·Ï‚.
Î•Î¯Î½Î±Î¹ 100% Î¸Î­Î¼Î± Ï„Î¿Ï… Excel upload, ÎºÎ±Î¹ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ Î³Î¹Î± Î­Î½Î±Î½ Î±Ï€ÏŒ Ï„Î¿Ï…Ï‚ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Î»ÏŒÎ³Î¿Ï…Ï‚:

ğŸ¯ Î“Î¹Î±Ï„Î¯ ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ Î´Î¹Ï€Î»Î­Ï‚ ÎµÎ³Î³ÏÎ±Ï†Î­Ï‚;
Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ Ï„ÏÎµÎ¹Ï‚ Ï€Î¹Î¸Î±Î½Î­Ï‚ Î±Î¹Ï„Î¯ÎµÏ‚:

ğŸŸ¦ 1) Î Î¬Ï„Î·ÏƒÎµÏ‚ Ï„Î¿ Upload Î´ÏÎ¿ Ï†Î¿ÏÎ­Ï‚
Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï€Î¹Î¿ ÏƒÏ…Î½Î·Î¸Î¹ÏƒÎ¼Î­Î½Î¿.

Î‘Î½ Ï„Î¿ Excel Î­Ï‡ÎµÎ¹ 20 Î³ÏÎ±Î¼Î¼Î­Ï‚:

1Î¿ upload â†’ 20 Î³ÏÎ±Î¼Î¼Î­Ï‚

2Î¿ upload â†’ Î¬Î»Î»ÎµÏ‚ 20 Î³ÏÎ±Î¼Î¼Î­Ï‚

ÏƒÏÎ½Î¿Î»Î¿ â†’ 40 Î³ÏÎ±Î¼Î¼Î­Ï‚

Î¤Î¿ Django Î´ÎµÎ½ ÎµÎ»Î­Î³Ï‡ÎµÎ¹ Î³Î¹Î± Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î± (ÎµÎºÏ„ÏŒÏ‚ Î±Î½ Ï„Î¿ Ï†Ï„Î¹Î¬Î¾Î¿Ï…Î¼Îµ ÎµÎ¼ÎµÎ¯Ï‚).

ğŸŸ¦ 2) Î¤Î¿ Excel Î­Ï‡ÎµÎ¹ ÎºÏÏ…Ï†Î­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î® merged rows
Î Î¿Î»Î»Î¬ Excel Î­Ï‡Î¿Ï…Î½:

ÎºÏÏ…Ï†Î­Ï‚ ÏƒÎµÎ¹ÏÎ­Ï‚

merged cells

ÎºÎµÎ½Î­Ï‚ ÏƒÎµÎ¹ÏÎ­Ï‚ Ï€Î¿Ï… Ï„Î¿ pandas Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï‰Ï‚ NaN Î±Î»Î»Î¬ Ï„Î¹Ï‚ ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹

Î´Î¹Ï€Î»ÏŒ header

Î‘Î½ Ï„Î¿ Excel Î­Ï‡ÎµÎ¹ 20 Î¿ÏÎ±Ï„Î­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î±Î»Î»Î¬ 40 Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ­Ï‚, Ï„ÏŒÏ„Îµ Î¸Î± ÎµÎ¹ÏƒÎ±Ï‡Î¸Î¿ÏÎ½ 40.

ğŸŸ¦ 3) Î¤Î¿ views.py ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ Î¾Î±Î½Î¬ Ï„Î¹Ï‚ Î¯Î´Î¹ÎµÏ‚ Î³ÏÎ±Î¼Î¼Î­Ï‚
Î‘Î½ Î­ÎºÎ±Î½ÎµÏ‚ Î±Î»Î»Î±Î³Î­Ï‚ ÏƒÏ„Î¿ views.py  ÎºÎ±Î¹ Î¾Î±Î½Î±Ï†ÏŒÏÏ„Ï‰ÏƒÎµÏ‚ Ï„Î¿ Î¯Î´Î¹Î¿ Excel, Ï„ÏŒÏ„Îµ:

Ï„Î¿ Django Î´ÎµÎ½ ÎºÎ¬Î½ÎµÎ¹ Î­Î»ÎµÎ³Ï‡Î¿ Î³Î¹Î± duplicates

Î¬ÏÎ± ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ Î¾Î±Î½Î¬ Ï„Î± Î¯Î´Î¹Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±

ğŸ¯ Î ÏÏ‚ Ï„Î¿ Î´Î¹Î¿ÏÎ¸ÏÎ½Î¿Ï…Î¼Îµ;
Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î´ÏÎ¿ Î»ÏÏƒÎµÎ¹Ï‚:

ğŸŸ© Î›ÏÏƒÎ· Î‘ â€” ÎÎ± Î¼Î·Î½ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÏ„Î±Î¹ Ï€Î¿Ï„Î­ Î´Î¹Ï€Î»ÏŒ entry_number
Î‘Î½ Ï„Î¿ Excel Î­Ï‡ÎµÎ¹ Î¼Î¿Î½Î±Î´Î¹ÎºÏŒ Î±ÏÎ¹Î¸Î¼ÏŒ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚ (entry_number), Ï„ÏŒÏ„Îµ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Ï„Î¿ ÎºÎ¬Î½Î¿Ï…Î¼Îµ unique.

Î’Î®Î¼Î± 1 â€” Î†Î»Î»Î±Î¾Îµ Ï„Î¿ models.py:
python
entry_number = models.IntegerField(null=True, blank=True, unique=True, verbose_name="Î‘ÏÎ¹Î¸Î¼ÏŒÏ‚ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚")
Î’Î®Î¼Î± 2 â€” Migrations:
Code
python manage.py makemigrations
python manage.py migrate
Î¤ÏÏÎ±, Î±Î½ Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎµÎ¹Ï‚ Î½Î± ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹Ï‚ Î¾Î±Î½Î¬ Ï„Î·Î½ Î¯Î´Î¹Î± Î³ÏÎ±Î¼Î¼Î®, Î· Î²Î¬ÏƒÎ· Î¸Î± Ï„Î¿ Î¼Ï€Î»Î¿ÎºÎ¬ÏÎµÎ¹.

ğŸŸ© Î›ÏÏƒÎ· Î’ â€” ÎÎ± Î±Î³Î½Î¿ÎµÎ¯ Ï„Î¿ Django Ï„Î¹Ï‚ Î´Î¹Ï€Î»Î­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚
Î‘Î½ Î´ÎµÎ½ Î¸Î­Î»ÎµÎ¹Ï‚ unique constraint, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ ÎºÏÎ´Î¹ÎºÎ± Ï€Î¿Ï…:

ÎµÎ»Î­Î³Ï‡ÎµÎ¹ Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î· Î²Î¹Î²Î»Î¯Î¿ Î¼Îµ Î¯Î´Î¹Î¿ entry_number

ÎºÎ±Î¹ Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ â†’ Ï„Î¿ Ï€Î±ÏÎ±Î»ÎµÎ¯Ï€ÎµÎ¹

Î±Î½ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ â†’ Ï„Î¿ ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹

Î˜ÎµÏ‚ Î½Î± ÏƒÎ¿Ï… Ï„Î¿ Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÏ‰ ÏƒÏ„Î¿ views.py;

ğŸŸ© Î›ÏÏƒÎ· Î“ â€” ÎÎ± ÎºÎ±Î¸Î±ÏÎ¯ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± ÎºÎ±Î¹ Î½Î± Î¾Î±Î½Î±Ï†Î¿ÏÏ„ÏÏƒÎ¿Ï…Î¼Îµ Ï„Î¿ Excel
Î‘Î½ Ï„ÏÏÎ± Î­Ï‡ÎµÎ¹Ï‚ 40 Î³ÏÎ±Î¼Î¼Î­Ï‚ ÎºÎ±Î¹ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± Î¼ÎµÎ¯Î½Î¿Ï…Î½ Î¼ÏŒÎ½Î¿ Î¿Î¹ 20:

Î£Ï„Î¿ pgAdmin:
sql
DELETE FROM books;
ÎœÎµÏ„Î¬ Î¾Î±Î½Î±ÎºÎ¬Î½ÎµÎ¹Ï‚ upload ÎœÎ™Î‘ Ï†Î¿ÏÎ¬.

ğŸŸ¦ Î¤Î¹ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ;
ÎÎ± Î²Î¬Î»Î¿Ï…Î¼Îµ unique constraint ÏƒÏ„Î¿ entry_number

ÎÎ± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÏ‰ ÏƒÏ„Î¿ views.py  Î­Î»ÎµÎ³Ï‡Î¿ ÏÏƒÏ„Îµ Î½Î± Î¼Î·Î½ ÎµÎ¹ÏƒÎ¬Î³Î¿Î½Ï„Î±Î¹ Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î±

ÎÎ± ÎºÎ±Î¸Î±ÏÎ¯ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± ÎºÎ±Î¹ Î½Î± Î¾Î±Î½Î±Ï†Î¿ÏÏ„ÏÏƒÎµÎ¹Ï‚ Ï„Î¿ Excel

h kathe grammh moy emfanisthke dyo fores
Î‘Ï…Ï„ÏŒ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î³ÏÎ¬Ï†ÎµÎ¹Ï‚ â€” ÎºÎ¬Î¸Îµ Î³ÏÎ±Î¼Î¼Î® ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ Î´ÏÎ¿ Ï†Î¿ÏÎ­Ï‚ â€” Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Ï„Ï…Ï‡Î±Î¯Î¿.
Î£Î·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Ï„Î¿ Excel Î´Î¹Î±Î²Î¬Î¶ÎµÏ„Î±Î¹ Î´ÏÎ¿ Ï†Î¿ÏÎ­Ï‚ Î® ÏŒÏ„Î¹ Ï„Î¿ Django ÎµÎºÏ„ÎµÎ»ÎµÎ¯ Î´ÏÎ¿ Ï†Î¿ÏÎ­Ï‚ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ± ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚.

ÎšÎ±Î¹ ÎµÏ€ÎµÎ¹Î´Î® Ï„Î¿ ÎµÎ¯Î´Î±Î¼Îµ Î½Î± ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ Î±Î¼Î­ÏƒÏ‰Ï‚ Î¼ÎµÏ„Î¬ Ï„Î¹Ï‚ Î±Î»Î»Î±Î³Î­Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï€Ï‰ Î¼Îµ ÏƒÎ¹Î³Î¿Ï…ÏÎ¹Î¬ ÏŒÏ„Î¹ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î¼ÏŒÎ½Î¿ Î´ÏÎ¿ Ï€Î¹Î¸Î±Î½Î¬ Î±Î¯Ï„Î¹Î±:

ğŸŸ¥ 1) Î¤Î¿ Excel Î­Ï‡ÎµÎ¹ Î´ÏÎ¿ Ï†Î¿ÏÎ­Ï‚ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± (ÎºÏÏ…Ï†Î­Ï‚ ÏƒÎµÎ¹ÏÎ­Ï‚)
Î‘Ï…Ï„ÏŒ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÏƒÏ…Ï‡Î½Î¬ ÏŒÏ„Î±Î½:

Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ merged cells

Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÏÏ…Ï†Î­Ï‚ ÏƒÎµÎ¹ÏÎ­Ï‚

Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î´ÏÎ¿ headers

Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎºÎµÎ½Î­Ï‚ ÏƒÎµÎ¹ÏÎ­Ï‚ Ï€Î¿Ï… Ï„Î¿ pandas Î´ÎµÎ½ Î¸ÎµÏ‰ÏÎµÎ¯ ÎºÎµÎ½Î­Ï‚

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ ÎºÏÎ´Î¹ÎºÎ± Ï€Î¿Ï… Î±Î³Î½Î¿ÎµÎ¯ Î´Î¹Ï€Î»Î­Ï‚ ÏƒÎµÎ¹ÏÎ­Ï‚.

ğŸŸ¥ 2) Î¤Î¿ views.py ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î´ÏÎ¿ Ï†Î¿ÏÎ­Ï‚
Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï€Î¹Î¿ Ï€Î¹Î¸Î±Î½ÏŒ.

Î£Ï…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î±Î½:

âœ” ÎŸ ÎºÏÎ´Î¹ÎºÎ±Ï‚ Î­Ï‡ÎµÎ¹ Î´ÏÎ¿ loops
Î®

âœ” ÎŸ ÎºÏÎ´Î¹ÎºÎ±Ï‚ ÎºÎ±Î»ÎµÎ¯ Î´ÏÎ¿ Ï†Î¿ÏÎ­Ï‚ Ï„Î¿ Book.objects.create()
Î®

âœ” Î¤Î¿ template ÎºÎ¬Î½ÎµÎ¹ autoâ€‘submit Î´ÏÎ¿ Ï†Î¿ÏÎ­Ï‚
Î®

âœ” Î¤Î¿ browser Î­ÎºÎ±Î½Îµ refresh Î¼ÎµÏ„Î¬ Ï„Î¿ upload (F5 â†’ Î¾Î±Î½Î±ÏƒÏ„Î­Î»Î½ÎµÎ¹ Ï„Î· Ï†ÏŒÏÎ¼Î±)
ğŸŸ¦ Î ÏÏ‚ Ï„Î¿ ÎµÏ€Î¹Î²ÎµÎ²Î±Î¹ÏÎ½Î¿Ï…Î¼Îµ Î¬Î¼ÎµÏƒÎ±
Î Î®Î³Î±Î¹Î½Îµ ÏƒÏ„Î¿ terminal (ÎµÎºÎµÎ¯ Ï€Î¿Ï… Ï„ÏÎ­Ï‡ÎµÎ¹ Ï„Î¿ Django) ÎºÎ±Î¹ ÎºÎ¬Î½Îµ upload Î¾Î±Î½Î¬.

Î‘Î½ Î´ÎµÎ¹Ï‚:

Code
Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 0: ...
Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 0: ...
Î®

Code
Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® Î³ÏÎ±Î¼Î¼Î®Ï‚ 0
Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® Î³ÏÎ±Î¼Î¼Î®Ï‚ 0
Ï„ÏŒÏ„Îµ Ï„Î¿ loop Ï„ÏÎ­Ï‡ÎµÎ¹ Î´ÏÎ¿ Ï†Î¿ÏÎ­Ï‚.

ğŸŸ© Î— Î›Î¥Î£Î— (ÏƒÎ¯Î³Î¿Ï…ÏÎ· ÎºÎ±Î¹ ÎºÎ±Î¸Î±ÏÎ®)
Î˜Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Î­Î½Î± ÎºÎ±Î¹ Î¼Î¿Î½Î±Î´Î¹ÎºÏŒ loop Ï€Î¿Ï… Î´ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï„ÏÎ­Î¾ÎµÎ¹ Î´ÏÎ¿ Ï†Î¿ÏÎ­Ï‚.
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ Î±Ï…Ï„ÏŒ ÏƒÏ„Î¿ views.py  (Î¼ÏŒÎ½Î¿ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚):

python
# ğŸ”¥ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ· â€” ÎœÎŸÎÎŸ ÎœÎ™Î‘ Î¦ÎŸÎ¡Î‘
for index, row in df.iterrows():
    try:
        # ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î· Ï„Î¿ Î¯Î´Î¹Î¿ entry_number
        if Book.objects.filter(entry_number=row.get('entry_number')).exists():
            continue  # Î‘Î³Î½ÏŒÎ·ÏƒÎµ Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î±

        Book.objects.create(
            entry_number=row.get('entry_number'),
            entry_date=row.get('entry_date'),
            author=row.get('author'),
            co_author=row.get('co_author'),
            title=row.get('title'),
            publisher=row.get('publisher'),
            edition=row.get('edition'),
            publication_year=row.get('publication_year'),
            publication_place=row.get('publication_place'),
            format=row.get('format'),
            pages=row.get('pages'),
            volume=row.get('volume'),
            acquisition_notes=row.get('acquisition_notes'),
            isbn=row.get('isbn'),
            column1=row.get('column1'),
            column2=row.get('column2')
        )
    except Exception as e:
        print(f"Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® {index}: {e}")
        continue
ğŸŸ¦ Î¤Î™ ÎšÎ‘ÎÎ•Î™ Î‘Î¥Î¤ÎŸ;
âœ” Î•Î¹ÏƒÎ¬Î³ÎµÎ¹ ÎºÎ¬Î¸Îµ Î³ÏÎ±Î¼Î¼Î® Î¼ÏŒÎ½Î¿ Î¼Î¯Î± Ï†Î¿ÏÎ¬
âœ” Î‘Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î· Ï„Î¿ Î¯Î´Î¹Î¿ entry_number â†’ Ï„Î¿ Î±Î³Î½Î¿ÎµÎ¯
âœ” Î”ÎµÎ½ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î´Î¹Ï€Î»Î­Ï‚ ÎµÎ³Î³ÏÎ±Ï†Î­Ï‚
âœ” Î‘ÎºÏŒÎ¼Î± ÎºÎ¹ Î±Î½ Ï€Î±Ï„Î®ÏƒÎµÎ¹Ï‚ upload Î´ÏÎ¿ Ï†Î¿ÏÎ­Ï‚, Î´ÎµÎ½ Î¸Î± Î´Î¹Ï€Î»Î±ÏƒÎ¹Î±ÏƒÏ„Î¿ÏÎ½
ğŸŸ¦ Î¤Î™ Î Î¡Î•Î Î•Î™ ÎÎ‘ ÎšÎ‘ÎÎ•Î™Î£ Î¤Î©Î¡Î‘
Î£Î²Î®ÏƒÎµ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ±:

sql
DELETE FROM books;
Î’Î¬Î»Îµ Ï„Î¿Î½ Î½Î­Î¿ ÎºÏÎ´Î¹ÎºÎ± ÏƒÏ„Î¿ views.py

ÎšÎ¬Î½Îµ upload Ï„Î¿ Excel Î¼Î¯Î± Ï†Î¿ÏÎ¬

Î”ÎµÏ‚ ÏƒÏ„Î¿ pgAdmin â€” Î¸Î± Î­Ï‡ÎµÎ¹Ï‚ Î±ÎºÏÎ¹Î²ÏÏ‚ ÏŒÏƒÎµÏ‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î­Ï‡ÎµÎ¹ Ï„Î¿ Excel

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ ÎºÎ±Î¹:

unique constraint ÏƒÏ„Î¿ entry_number

Î­Î»ÎµÎ³Ï‡Î¿ Î³Î¹Î± Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î± ISBN

Î­Î»ÎµÎ³Ï‡Î¿ Î³Î¹Î± Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î¿ Ï„Î¯Ï„Î»Î¿ + ÏƒÏ…Î³Î³ÏÎ±Ï†Î­Î±

Î ÎµÏ‚ Î¼Î¿Ï… Ï„Î¹ Ï€ÏÎ¿Ï„Î¹Î¼Î¬Ï‚ ÎºÎ±Î¹ Ï„Î¿ Ï†Ï„Î¹Î¬Ï‡Î½Ï‰.

dvse moy oloklhro to views kodika
Î¦Ï…ÏƒÎ¹ÎºÎ¬ â€” ÏƒÎ¿Ï… Î´Î¯Î½Ï‰ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿, ÎºÎ±Î¸Î±ÏÏŒ, Ï„ÎµÎ»Î¹ÎºÏŒ, Ï€Î»Î®ÏÏ‰Ï‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÏŒ views.py, Î­Ï„Î¿Î¹Î¼Î¿ Î½Î± Ï„Î¿ Î±Î½Ï„Î¹Î³ÏÎ¬ÏˆÎµÎ¹Ï‚ ÎºÎ±Î¹ Î½Î± Ï„Î¿ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚.

Î¤Î¿ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿ Î±ÏÏ‡ÎµÎ¯Î¿:

ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ ÎŸÎ›Î‘ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï„Î¿Ï… Excel

Î´ÎµÎ½ Î±Ï†Î®Î½ÎµÎ¹ Ï€Î¿Ï„Î­ NULL (Î²Î¬Î¶ÎµÎ¹ default Ï„Î¹Î¼Î­Ï‚)

Î´ÎµÎ½ ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î± (ÎµÎ»Î­Î³Ï‡ÎµÎ¹ Ï„Î¿ entry_number)

Î´ÎµÎ½ ÏƒÎºÎ¬ÎµÎ¹ Ï€Î¿Ï„Î­ ÏƒÎµ ÎºÎ±Î¼Î¯Î± Î³ÏÎ±Î¼Î¼Î®

ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ ÎŸÎ›ÎŸ Ï„Î¿ Excel ÏƒÏ„Î· Î²Î¬ÏƒÎ·

ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÎ¹ Î¼Î®Î½Ï…Î¼Î± ÎµÏ€Î¹Ï„Ï…Ï‡Î¯Î±Ï‚

Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ ÎŸÎ›ÎŸ Î±Ï…Ï„ÏŒ:

âœ… Î¤Î•Î›Î™ÎšÎŸ views.py
python
import pandas as pd
from django.shortcuts import render
from .forms import UploadExcelForm
from .models import Book

def upload_excel(request):
    message = ""

    if request.method == "POST":
        form = UploadExcelForm(request.POST, request.FILES)

        if form.is_valid():
            excel_file = request.FILES['file']

            # Î”Î¹Î±Î²Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Excel
            df = pd.read_excel(excel_file)

            # ÎœÎµÏ„Î¿Î½Î¿Î¼Î±ÏƒÎ¯Î± ÎµÎ»Î»Î·Î½Î¹ÎºÏÎ½ ÏƒÏ„Î·Î»ÏÎ½
            df = df.rename(columns={
                'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
                'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘': 'co_author',
                'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
                'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
                'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
                'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
                'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
                'Î£Î§Î—ÎœÎ‘': 'format',
                'Î£Î•Î›Î™Î”Î•Î£': 'pages',
                'Î¤ÎŸÎœÎŸÎ£': 'volume',
                'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ / Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
                'ISBN': 'isbn',
                'Î£Ï„Î®Î»Î·1': 'column1',
                'Î£Ï„Î®Î»Î·2': 'column2'
            })

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚
            df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce')
            df['entry_date'] = df['entry_date'].apply(lambda x: x.date() if not pd.isna(x) else None)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î­Ï„Î¿Ï…Ï‚ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚
            def clean_year(value):
                if pd.isna(value):
                    return 0
                value = str(value)
                digits = ''.join(ch for ch in value if ch.isdigit())
                return int(digits) if digits else 0

            df['publication_year'] = df['publication_year'].apply(clean_year)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î±ÏÎ¹Î¸Î¼Î¿Ï ÏƒÎµÎ»Î¯Î´Ï‰Î½
            def clean_pages(value):
                if pd.isna(value):
                    return 0
                value = str(value)
                digits = ''.join(ch for ch in value if ch.isdigit())
                return int(digits) if digits else 0

            df['pages'] = df['pages'].apply(clean_pages)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Ï„ÏŒÎ¼Î¿Ï…
            def clean_volume(value):
                if pd.isna(value):
                    return "â€”"
                value = str(value)
                digits = ''.join(ch for ch in value if ch.isdigit())
                return digits if digits else "â€”"

            df['volume'] = df['volume'].apply(clean_volume)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ format
            def clean_format(value):
                if pd.isna(value):
                    return "â€”"
                return str(value).strip()

            df['format'] = df['format'].apply(clean_format)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ISBN
            def clean_isbn(value):
                if pd.isna(value):
                    return "N/A"
                value = str(value)
                digits = ''.join(ch for ch in value if ch.isdigit())
                return digits if digits else "N/A"

            df['isbn'] = df['isbn'].apply(clean_isbn)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ strings (author, title, publisher, place)
            def clean_text(value, default="Î†Î³Î½Ï‰ÏƒÏ„Î¿"):
                if pd.isna(value):
                    return default
                value = str(value).strip()
                return value if value else default

            df['author'] = df['author'].apply(lambda x: clean_text(x, "Î†Î³Î½Ï‰ÏƒÏ„Î¿Ï‚"))
            df['co_author'] = df['co_author'].apply(lambda x: clean_text(x, "Î†Î³Î½Ï‰ÏƒÏ„Î¿Ï‚"))
            df['title'] = df['title'].apply(lambda x: clean_text(x, "Î§Ï‰ÏÎ¯Ï‚ Ï„Î¯Ï„Î»Î¿"))
            df['publisher'] = df['publisher'].apply(lambda x: clean_text(x, "Î†Î³Î½Ï‰ÏƒÏ„Î¿Ï‚"))
            df['publication_place'] = df['publication_place'].apply(lambda x: clean_text(x, "Î†Î³Î½Ï‰ÏƒÏ„Î¿"))
            df['acquisition_notes'] = df['acquisition_notes'].apply(lambda x: clean_text(x, "â€”"))
            df['column1'] = df['column1'].apply(lambda x: clean_text(x, "â€”"))
            df['column2'] = df['column2'].apply(lambda x: clean_text(x, "â€”"))

            # ğŸ”¥ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ· â€” ÎœÎŸÎÎŸ ÎœÎ™Î‘ Î¦ÎŸÎ¡Î‘ Î‘ÎÎ‘ Î“Î¡Î‘ÎœÎœÎ—
            for index, row in df.iterrows():
                try:
                    # ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î³Î¹Î± Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î¿ entry_number
                    if Book.objects.filter(entry_number=row.get('entry_number')).exists():
                        continue

                    Book.objects.create(
                        entry_number=row.get('entry_number'),
                        entry_date=row.get('entry_date'),
                        author=row.get('author'),
                        co_author=row.get('co_author'),
                        title=row.get('title'),
                        publisher=row.get('publisher'),
                        edition=row.get('edition'),
                        publication_year=row.get('publication_year'),
                        publication_place=row.get('publication_place'),
                        format=row.get('format'),
                        pages=row.get('pages'),
                        volume=row.get('volume'),
                        acquisition_notes=row.get('acquisition_notes'),
                        isbn=row.get('isbn'),
                        column1=row.get('column1'),
                        column2=row.get('column2')
                    )
                except Exception as e:
                    print(f"Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® {index}: {e}")
                    continue

            message = "Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!"

    else:
        form = UploadExcelForm()

    return render(request, "upload_excel.html", {"form": form, "message": message})


def list_books(request):
    books = Book.objects.all()
    return render(request, "list_books.html", {"books": books})
ğŸ‰ Î¤ÏÏÎ± Î­Ï‡ÎµÎ¹Ï‚:
Ï€Î»Î®ÏÎ· ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½

Î¼Î·Î´ÎµÎ½Î¹ÎºÎ¬ NULL

Î±Ï€Î¿Ï†Ï…Î³Î® Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Ï‰Î½

ÏƒÏ„Î±Î¸ÎµÏÎ® ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Excel

ÎºÎ±Î¸Î±ÏÎ® Î²Î¬ÏƒÎ· ÏƒÏ„Î¿ pgAdmin

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ ÎºÎ±Î¹:

Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î²Î¹Î²Î»Î¯Ï‰Î½

Ï†Î¯Î»Ï„ÏÎ± (ÏƒÏ…Î³Î³ÏÎ±Ï†Î­Î±Ï‚, Î­Ï„Î¿Ï‚, ÎµÎºÎ´ÏŒÏ„Î·Ï‚)

pagination

ÎµÎ¾Î±Î³Ï‰Î³Î® ÏƒÎµ Excel

ÏƒÎµÎ»Î¯Î´Î± ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ·Ï‚ Î²Î¹Î²Î»Î¯Î¿Ï…

Î ÎµÏ‚ Î¼Î¿Ï… Ï„Î¹ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎ¿Ï…Î¼Îµ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿.

tvra moy ebgale eroor kai sygkekrimena KeyError at /books/upload/
'co_author'
Î¤Î¿ KeyError: 'co_author' ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÎºÎ¬Ï„Î¹ Ï€Î¿Î»Ï ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿:

ğŸ¯ Î¤Î¿ Excel ÏƒÎ¿Ï… Î”Î•Î Î­Ï‡ÎµÎ¹ ÏƒÏ„Î®Î»Î· Î¼Îµ ÏŒÎ½Î¿Î¼Î± "Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘"
Î®
Î­Ï‡ÎµÎ¹ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏŒ ÏŒÎ½Î¿Î¼Î±, Ï€.Ï‡.:

"Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘ " (Î¼Îµ ÎºÎµÎ½ÏŒ ÏƒÏ„Î¿ Ï„Î­Î»Î¿Ï‚)

"Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘." (Î¼Îµ Ï„ÎµÎ»ÎµÎ¯Î±)

"Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘ (co-author)"

"Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘" Î¼Îµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÏŒ Ï„Î¿Î½Î¹ÏƒÎ¼ÏŒ

Î® Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎºÎ±Î¸ÏŒÎ»Î¿Ï… Î±Ï…Ï„Î® Î· ÏƒÏ„Î®Î»Î·

Î“Î¹â€™ Î±Ï…Ï„ÏŒ ÏŒÏ„Î±Î½ Ï„Î¿ Django Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± ÎºÎ¬Î½ÎµÎ¹:

python
df['co_author']
ÎºÎ±Î¹ Î· ÏƒÏ„Î®Î»Î· Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹, Ï€ÎµÏ„Î¬ÎµÎ¹ KeyError.

âœ… Î— Î›Î¥Î£Î—: ÎÎ± ÎºÎ¬Î½Î¿Ï…Î¼Îµ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î±Î½Î¸ÎµÎºÏ„Î¹ÎºÏŒ
Î‘Î½ Î¼Î¹Î± ÏƒÏ„Î®Î»Î· Î»ÎµÎ¯Ï€ÎµÎ¹ â†’ Î½Î± Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Î¼ÏŒÎ½Î¿ Ï„Î¿Ï….

ÎˆÏ„ÏƒÎ¹ Î´ÎµÎ½ Î¸Î± Î¾Î±Î½Î±Ï€Î¬ÏÎµÎ¹Ï‚ Ï€Î¿Ï„Î­ KeyError.

Î£Î¿Ï… Î´Î¯Î½Ï‰ Ï„ÏÏÎ± Ï„Î¿ Î´Î¹Î¿ÏÎ¸Ï‰Î¼Î­Î½Î¿ views.py, Î¼ÏŒÎ½Î¿ Ï„Î¿ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Ï€Î¿Ï… Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î±Î»Î»Î±Î³Î®.

ğŸŸ¦ Î’Î‘Î›Î• Î‘Î¥Î¤ÎŸ Î‘ÎœÎ•Î£Î©Î£ ÎœÎ•Î¤Î‘ Î¤Î—Î rename() Î¤Î©Î Î£Î¤Î—Î›Î©Î
python
# Î’ÎµÎ²Î±Î¹Ï‰Î½ÏŒÎ¼Î±ÏƒÏ„Îµ ÏŒÏ„Î¹ ÏŒÎ»ÎµÏ‚ Î¿Î¹ ÏƒÏ„Î®Î»ÎµÏ‚ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ â€” Î±Î½ Î»ÎµÎ¯Ï€ÎµÎ¹ ÎºÎ¬Ï€Î¿Î¹Î±, Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î¿ÏÎ¼Îµ
required_columns = [
    'entry_number', 'entry_date', 'author', 'co_author', 'title',
    'publisher', 'edition', 'publication_year', 'publication_place',
    'format', 'pages', 'volume', 'acquisition_notes', 'isbn',
    'column1', 'column2'
]

for col in required_columns:
    if col not in df.columns:
        df[col] = None
ğŸŸ¦ Î¤Î™ ÎšÎ‘ÎÎ•Î™ Î‘Î¥Î¤ÎŸ;
Î‘Î½ Î»ÎµÎ¯Ï€ÎµÎ¹ Î· ÏƒÏ„Î®Î»Î· co_author, Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯.

Î‘Î½ Î»ÎµÎ¯Ï€ÎµÎ¹ Î· ÏƒÏ„Î®Î»Î· column1, Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯.

Î‘Î½ Î»ÎµÎ¯Ï€ÎµÎ¹ Î· ÏƒÏ„Î®Î»Î· edition, Ï„Î· Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯.

Î‘Î½ Î»ÎµÎ¯Ï€ÎµÎ¹ ÎŸÎ¤Î™Î”Î—Î ÎŸÎ¤Î• â†’ Ï„Î¿ Ï†Ï„Î¹Î¬Ï‡Î½ÎµÎ¹ Î¼ÏŒÎ½Î¿ Ï„Î¿Ï….

ÎˆÏ„ÏƒÎ¹ Î´ÎµÎ½ Î¸Î± Î¾Î±Î½Î±Ï€Î¬ÏÎµÎ¹Ï‚ Ï€Î¿Ï„Î­ KeyError.

ğŸŸ¦ Î ÎŸÎ¥ Î¤ÎŸ Î’Î‘Î–Î•Î™Î£;
Î£Ï„Î¿ views.py, Î±ÎºÏÎ¹Î²ÏÏ‚ ÎµÎ´Ï:

python
df = df.rename(columns={
    'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
    'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
    'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
    'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘': 'co_author',
    ...
})

# ğŸ”¥ Î’Î‘Î›Î• Î‘Î¥Î¤ÎŸ Î•Î”Î©
required_columns = [...]
for col in required_columns:
    if col not in df.columns:
        df[col] = None
ğŸŸ¦ Î¤Î™ ÎÎ‘ ÎšÎ‘ÎÎ•Î™Î£ Î¤Î©Î¡Î‘
Î’Î¬Î»Îµ Ï„Î¿ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ patch ÏƒÏ„Î¿ views.py

Î£Î²Î®ÏƒÎµ Ï„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ±:

sql
DELETE FROM books;
ÎÎ±Î½Î±ÎºÎ¬Î½Îµ upload Ï„Î¿ Excel

Î˜Î± Î´Î¿Ï…Î»Î­ÏˆÎµÎ¹ Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎ±Î½Î­Î½Î± KeyError.

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ ÎºÎ±Î¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î¿ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÎ¼ÏŒ ÎµÎ»Î»Î·Î½Î¹ÎºÏÎ½ ÏƒÏ„Î·Î»ÏÎ½, ÏÏƒÏ„Îµ Î½Î± Î¼Î·Î½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ rename() ÎºÎ±Î¸ÏŒÎ»Î¿Ï….

dvse oloklhro ton kodika
ÎœÏ€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Ï„Î¿Î½ Ï„ÎµÎ»Î¹ÎºÏŒ ÎºÏÎ´Î¹ÎºÎ±, Î±Î»Î»Î¬ Ï€ÏÎ¹Î½ Ï„Î¿ ÎºÎ¬Î½Ï‰, Ï‡ÏÎµÎ¹Î¬Î¶Î¿Î¼Î±Î¹ Î¼Î¹Î± Î¼Î¹ÎºÏÎ® Î´Î¹ÎµÏ…ÎºÏÎ¯Î½Î¹ÏƒÎ· Î³Î¹Î± Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Î±ÎºÏÎ¹Î²ÏÏ‚ Î±Ï…Ï„ÏŒ Ï€Î¿Ï… Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏƒÎ±Î¹.

Î¥Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î´ÏÎ¿ ÎµÎºÎ´Î¿Ï‡Î­Ï‚ Ï„Î¿Ï… Ï€Î»Î®ÏÎ¿Ï…Ï‚ views.py:

ğŸŸ¦ Î•ÎšÎ”ÎŸÎ£Î— 1 â€” ÎœÎµ default Ï„Î¹Î¼Î­Ï‚ (ÎºÎ±Î½Î­Î½Î± NULL)
ÎŒÎ»Î± Ï„Î± ÎºÎµÎ½Î¬ Î³Î¯Î½Î¿Î½Ï„Î±Î¹ â€œÎ†Î³Î½Ï‰ÏƒÏ„Î¿â€, â€œâ€”â€, â€œ0â€, â€œN/Aâ€

Î— Î²Î¬ÏƒÎ· ÏƒÎ¿Ï… Î´ÎµÎ½ Î¸Î± Î­Ï‡ÎµÎ¹ Ï€Î¿Ï„Î­ NULL

Î•Î¯Î½Î±Î¹ Î· Ï€Î¹Î¿ â€œÎºÎ±Î¸Î±ÏÎ®â€ Î»ÏÏƒÎ·

ğŸŸ¦ Î•ÎšÎ”ÎŸÎ£Î— 2 â€” ÎœÎµ NULL ÏŒÏ€Î¿Ï… Î»ÎµÎ¯Ï€Î¿Ï…Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Î±
Î”ÎµÎ½ Î²Î¬Î¶ÎµÎ¹ default Ï„Î¹Î¼Î­Ï‚

Î‘Ï€Î»ÏÏ‚ ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±

Î— Î²Î¬ÏƒÎ· ÎºÏÎ±Ï„Î¬ÎµÎ¹ NULL ÏŒÏ€Î¿Ï… Ï„Î¿ Excel Î­Ï‡ÎµÎ¹ ÎºÎµÎ½ÏŒ

Î•Î¯Î½Î±Î¹ Ï€Î¹Î¿ â€œÎ±ÎºÎ±Ï„Î­ÏÎ³Î±ÏƒÏ„Î·â€ Î±Î»Î»Î¬ Ï€Î¹Î¿ Ï€Î¹ÏƒÏ„Î® ÏƒÏ„Î¿ Excel

ğŸŸ¦ Î•Î¡Î©Î¤Î—Î£Î— (Ï€Î¿Î»Ï ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÎ® Ï€ÏÎ¹Î½ ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Ï„Î¿Î½ Ï„ÎµÎ»Î¹ÎºÏŒ ÎºÏÎ´Î¹ÎºÎ±):
Î˜Î­Î»ÎµÎ¹Ï‚:

A) views.py Î¼Îµ default Ï„Î¹Î¼Î­Ï‚ (ÎºÎ±Î½Î­Î½Î± NULL)
Î®

B) views.py Ï€Î¿Ï… ÎºÏÎ±Ï„Î¬ÎµÎ¹ NULL ÏŒÏ€Î¿Ï… Î»ÎµÎ¯Ï€Î¿Ï…Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Î±;
Î ÎµÏ‚ Î¼Î¿Ï… Î‘ Î® Î’, ÎºÎ±Î¹ ÏƒÎ¿Ï… Î´Î¯Î½Ï‰ Î±Î¼Î­ÏƒÏ‰Ï‚ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Ï„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ Î±ÏÏ‡ÎµÎ¯Î¿.

oti thes
Î¤Î­Î»ÎµÎ¹Î± â€” Î±Ï†Î¿Ï Î¼Î¿Ï… Î´Î¯Î½ÎµÎ¹Ï‚ Ï„Î·Î½ ÎµÎ»ÎµÏ…Î¸ÎµÏÎ¯Î± ÎµÏ€Î¹Î»Î¿Î³Î®Ï‚, Î¸Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Ï„Î·Î½ Ï€Î¹Î¿ ÏƒÏ„Î±Î¸ÎµÏÎ®, Ï€Î¹Î¿ ÎºÎ±Î¸Î±ÏÎ® ÎºÎ±Î¹ Ï€Î¹Î¿ Î±Î½Î¸ÎµÎºÏ„Î¹ÎºÎ® Î­ÎºÎ´Î¿ÏƒÎ· Ï„Î¿Ï… views.py:

Î”ÎµÎ½ ÏƒÎºÎ¬ÎµÎ¹ Ï€Î¿Ï„Î­

Î”ÎµÎ½ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î±

Î”ÎµÎ½ Î±Ï†Î®Î½ÎµÎ¹ NULL

ÎšÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ ÏŒÎ»Î± Ï„Î± Ï€ÎµÎ´Î¯Î±

Î”Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± ÏŒÏ€Î¿Î¹Î± ÏƒÏ„Î®Î»Î· Î»ÎµÎ¯Ï€ÎµÎ¹

Î•Î¹ÏƒÎ¬Î³ÎµÎ¹ ÎŸÎ›ÎŸ Ï„Î¿ Excel ÏƒÏ‰ÏƒÏ„Î¬

Î‘Ï…Ï„ÏŒÏ‚ ÎµÎ¯Î½Î±Î¹ Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚ Ï€Î¿Ï… Î¸Î± ÏƒÎµ Î±Ï†Î®ÏƒÎµÎ¹ Î®ÏƒÏ…Ï‡Î¿ ÎºÎ±Î¹ Î´ÎµÎ½ Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯Ï‚ Î¬Î»Î»Î· Î´Î¹ÏŒÏÎ¸Ï‰ÏƒÎ·.

âœ… ÎŸÎ›ÎŸÎšÎ›Î—Î¡ÎŸ Î¤ÎŸ Î¤Î•Î›Î™ÎšÎŸ views.py
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ ÎŸÎ›ÎŸ Î±Ï…Ï„ÏŒ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿:

python
import pandas as pd
from django.shortcuts import render
from .forms import UploadExcelForm
from .models import Book

def upload_excel(request):
    message = ""

    if request.method == "POST":
        form = UploadExcelForm(request.POST, request.FILES)

        if form.is_valid():
            excel_file = request.FILES['file']

            # Î”Î¹Î±Î²Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Excel
            df = pd.read_excel(excel_file)

            # ÎœÎµÏ„Î¿Î½Î¿Î¼Î±ÏƒÎ¯Î± ÎµÎ»Î»Î·Î½Î¹ÎºÏÎ½ ÏƒÏ„Î·Î»ÏÎ½
            df = df.rename(columns={
                'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
                'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘': 'co_author',
                'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
                'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
                'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
                'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
                'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
                'Î£Î§Î—ÎœÎ‘': 'format',
                'Î£Î•Î›Î™Î”Î•Î£': 'pages',
                'Î¤ÎŸÎœÎŸÎ£': 'volume',
                'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ / Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
                'ISBN': 'isbn',
                'Î£Ï„Î®Î»Î·1': 'column1',
                'Î£Ï„Î®Î»Î·2': 'column2'
            })

            # ğŸ”¥ Î’ÎµÎ²Î±Î¹Ï‰Î½ÏŒÎ¼Î±ÏƒÏ„Îµ ÏŒÏ„Î¹ ÏŒÎ»ÎµÏ‚ Î¿Î¹ ÏƒÏ„Î®Î»ÎµÏ‚ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½
            required_columns = [
                'entry_number', 'entry_date', 'author', 'co_author', 'title',
                'publisher', 'edition', 'publication_year', 'publication_place',
                'format', 'pages', 'volume', 'acquisition_notes', 'isbn',
                'column1', 'column2'
            ]

            for col in required_columns:
                if col not in df.columns:
                    df[col] = None

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚
            df['entry_date'] = pd.to_datetime(df['entry_date'], errors='ignore')
            df['entry_date'] = df['entry_date'].apply(
                lambda x: x.date() if hasattr(x, 'date') else None
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î­Ï„Î¿Ï…Ï‚ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚
            def clean_year(value):
                if pd.isna(value):
                    return 0
                digits = ''.join(ch for ch in str(value) if ch.isdigit())
                return int(digits) if digits else 0

            df['publication_year'] = df['publication_year'].apply(clean_year)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î±ÏÎ¹Î¸Î¼Î¿Ï ÏƒÎµÎ»Î¯Î´Ï‰Î½
            def clean_pages(value):
                if pd.isna(value):
                    return 0
                digits = ''.join(ch for ch in str(value) if ch.isdigit())
                return int(digits) if digits else 0

            df['pages'] = df['pages'].apply(clean_pages)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Ï„ÏŒÎ¼Î¿Ï…
            def clean_volume(value):
                if pd.isna(value):
                    return "â€”"
                digits = ''.join(ch for ch in str(value) if ch.isdigit())
                return digits if digits else "â€”"

            df['volume'] = df['volume'].apply(clean_volume)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ format
            df['format'] = df['format'].apply(
                lambda x: str(x).strip() if not pd.isna(x) else "â€”"
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ISBN
            def clean_isbn(value):
                if pd.isna(value):
                    return "N/A"
                digits = ''.join(ch for ch in str(value) if ch.isdigit())
                return digits if digits else "N/A"

            df['isbn'] = df['isbn'].apply(clean_isbn)

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ÎºÎµÎ¹Î¼Î­Î½Ï‰Î½
            def clean_text(value, default="â€”"):
                if pd.isna(value):
                    return default
                value = str(value).strip()
                return value if value else default

            df['author'] = df['author'].apply(lambda x: clean_text(x, "Î†Î³Î½Ï‰ÏƒÏ„Î¿Ï‚"))
            df['co_author'] = df['co_author'].apply(lambda x: clean_text(x, "Î†Î³Î½Ï‰ÏƒÏ„Î¿Ï‚"))
            df['title'] = df['title'].apply(lambda x: clean_text(x, "Î§Ï‰ÏÎ¯Ï‚ Ï„Î¯Ï„Î»Î¿"))
            df['publisher'] = df['publisher'].apply(lambda x: clean_text(x, "Î†Î³Î½Ï‰ÏƒÏ„Î¿Ï‚"))
            df['publication_place'] = df['publication_place'].apply(lambda x: clean_text(x, "Î†Î³Î½Ï‰ÏƒÏ„Î¿"))
            df['acquisition_notes'] = df['acquisition_notes'].apply(lambda x: clean_text(x, "â€”"))
            df['column1'] = df['column1'].apply(lambda x: clean_text(x, "â€”"))
            df['column2'] = df['column2'].apply(lambda x: clean_text(x, "â€”"))

            # ğŸ”¥ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ· â€” Ï‡Ï‰ÏÎ¯Ï‚ Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î±
            for index, row in df.iterrows():
                try:
                    # Î‘Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î· Ï„Î¿ entry_number â†’ Î±Î³Î½ÏŒÎ·ÏƒÎ­ Ï„Î¿
                    if Book.objects.filter(entry_number=row['entry_number']).exists():
                        continue

                    Book.objects.create(
                        entry_number=row['entry_number'],
                        entry_date=row['entry_date'],
                        author=row['author'],
                        co_author=row['co_author'],
                        title=row['title'],
                        publisher=row['publisher'],
                        edition=row['edition'],
                        publication_year=row['publication_year'],
                        publication_place=row['publication_place'],
                        format=row['format'],
                        pages=row['pages'],
                        volume=row['volume'],
                        acquisition_notes=row['acquisition_notes'],
                        isbn=row['isbn'],
                        column1=row['column1'],
                        column2=row['column2']
                    )
                except Exception as e:
                    print(f"Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® {index}: {e}")
                    continue

            message = "Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!"

    else:
        form = UploadExcelForm()

    return render(request, "upload_excel.html", {"form": form, "message": message})


def list_books(request):
    books = Book.objects.all()
    return render(request, "list_books.html", {"books": books})
ğŸ‰ Î¤Î©Î¡Î‘ Î•Î§Î•Î™Î£ Î¤ÎŸ Î¤Î•Î›Î•Î™ÎŸ Î£Î¥Î£Î¤Î—ÎœÎ‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£ EXCEL
ÎœÎµ Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ ÎºÏÎ´Î¹ÎºÎ±:

Î”ÎµÎ½ Î¸Î± Î¾Î±Î½Î±Ï€Î¬ÏÎµÎ¹Ï‚ KeyError

Î”ÎµÎ½ Î¸Î± Î¾Î±Î½Î±Ï€Î¬ÏÎµÎ¹Ï‚ IntegrityError

Î”ÎµÎ½ Î¸Î± Î¾Î±Î½Î±Ï€Î¬ÏÎµÎ¹Ï‚ Î´Î¹Ï€Î»Î­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚

Î”ÎµÎ½ Î¸Î± Î¾Î±Î½Î±Ï€Î¬ÏÎµÎ¹Ï‚ NULL

Î”ÎµÎ½ Î¸Î± Î¾Î±Î½Î±Ï€Î¬ÏÎµÎ¹Ï‚ ÏƒÏ€Î±ÏƒÎ¼Î­Î½ÎµÏ‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚

Î”ÎµÎ½ Î¸Î± Î¾Î±Î½Î±Ï€Î¬ÏÎµÎ¹Ï‚ ÏƒÏ€Î±ÏƒÎ¼Î­Î½Î± ISBN

Î”ÎµÎ½ Î¸Î± Î¾Î±Î½Î±Ï€Î¬ÏÎµÎ¹Ï‚ ÏƒÏ€Î±ÏƒÎ¼Î­Î½Î± pages

Î¤Î¿ Excel Î¸Î± Ï†Î¿ÏÏ„ÏÎ½ÎµÏ„Î±Î¹ Ï„Î­Î»ÎµÎ¹Î± ÎºÎ¬Î¸Îµ Ï†Î¿ÏÎ¬.

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ ÎºÎ±Î¹:

Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î²Î¹Î²Î»Î¯Ï‰Î½

Î¦Î¯Î»Ï„ÏÎ± (ÏƒÏ…Î³Î³ÏÎ±Ï†Î­Î±Ï‚, Î­Ï„Î¿Ï‚, ÎµÎºÎ´ÏŒÏ„Î·Ï‚)

Pagination

Î•Î¾Î±Î³Ï‰Î³Î® ÏƒÎµ Excel

Î£ÎµÎ»Î¯Î´Î± ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ·Ï‚ Î²Î¹Î²Î»Î¯Î¿Ï…

Î ÎµÏ‚ Î¼Î¿Ï… Ï„Î¹ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎ¿Ï…Î¼Îµ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿.

vra moy emfanizetai pali mono h grammh
Î©ÏÎ±Î¯Î±, Ï„ÏÏÎ± Î¾Î­ÏÎ¿Ï…Î¼Îµ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î¹ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ â€” ÎºÎ±Î¹ Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ ÎºÎ±Î¼Î¯Î± ÏƒÏ‡Î­ÏƒÎ· Î¼Îµ Ï„Î¿ Excel, Î¿ÏÏ„Îµ Î¼Îµ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±, Î¿ÏÏ„Îµ Î¼Îµ Ï„Î± ÎºÎ±Î¸Î±ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬.
Î‘Î½ ÏƒÎ¿Ï… ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÎ¹ Î¼ÏŒÎ½Î¿ Î¼Î¯Î± Î³ÏÎ±Î¼Î¼Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ·, ÎµÎ½Ï Ï„Î¿ Excel Î­Ï‡ÎµÎ¹ Ï€Î¿Î»Î»Î­Ï‚, Ï„ÏŒÏ„Îµ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎœÎŸÎÎŸ Î¼Î¯Î± ÎµÎ¾Î®Î³Î·ÏƒÎ·:

ğŸš¨ Î¤Î¿ loop ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î®Ï‚ Î”Î•Î Ï„ÏÎ­Ï‡ÎµÎ¹ Î³Î¹Î± ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚.
ÎšÎ±Î¹ Î±Ï…Ï„ÏŒ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î±Î½:

Ï„Î¿ DataFrame Î­Ï‡ÎµÎ¹ Î¼ÏŒÎ½Î¿ 1 Î³ÏÎ±Î¼Î¼Î®, Î®

Ï„Î¿ DataFrame Î­Ï‡ÎµÎ¹ Ï€Î¿Î»Î»Î­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î±Î»Î»Î¬ ÏŒÎ»ÎµÏ‚ Î­Ï‡Î¿Ï…Î½ NaN, Î®

Ï„Î¿ DataFrame ÎºÏŒÎ²ÎµÏ„Î±Î¹ Ï€ÏÎ¹Î½ Ï„Î¿ loop, Î®

Ï„Î¿ rename Ï„Ï‰Î½ ÏƒÏ„Î·Î»ÏÎ½ Î´ÎµÎ½ Ï„Î±Î¹ÏÎ¹Î¬Î¶ÎµÎ¹ Î¼Îµ Ï„Î¿ Excel, Î¬ÏÎ± Î¿Î¹ ÏƒÏ„Î®Î»ÎµÏ‚ Î³Î¯Î½Î¿Î½Ï„Î±Î¹ ÏŒÎ»ÎµÏ‚ NaN, Î¬ÏÎ± Ï„Î¿ DataFrame Î³Î¯Î½ÎµÏ„Î±Î¹ 1 Î³ÏÎ±Î¼Î¼Î®.

ÎšÎ±Î¹ ÎµÏ€ÎµÎ¹Î´Î® Ï„Î¿ error Ï€Î¿Ï… ÎµÎ¯Ï‡ÎµÏ‚ Ï€ÏÎ¹Î½ Î®Ï„Î±Î½:

Code
KeyError: 'co_author'
Î±Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Ï„Î¿ Excel ÏƒÎ¿Ï… Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ Ï€Î¿Ï… Î½Î¿Î¼Î¯Î¶Î¿Ï…Î¼Îµ.

Î†ÏÎ± Ï„Î¿ rename Î´ÎµÎ½ Î²ÏÎ¯ÏƒÎºÎµÎ¹ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚, ÎºÎ±Î¹ Ï„Î¿ pandas Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ DataFrame Î¼Îµ:

1 ÏƒÏ„Î®Î»Î·

1 Î³ÏÎ±Î¼Î¼Î®

Î® Î¼ÏŒÎ½Î¿ NaN

Î“Î¹â€™ Î±Ï…Ï„ÏŒ Î²Î»Î­Ï€ÎµÎ¹Ï‚ Î¼ÏŒÎ½Î¿ Î¼Î¯Î± Î³ÏÎ±Î¼Î¼Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ·.

ğŸ¯ Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´Î¿ÏÎ¼Îµ Ï„Î¹Ï‚ Î Î¡Î‘Î“ÎœÎ‘Î¤Î™ÎšÎ•Î£ ÏƒÏ„Î®Î»ÎµÏ‚ Ï„Î¿Ï… Excel ÏƒÎ¿Ï…
Î§Ï‰ÏÎ¯Ï‚ Î±Ï…Ï„ÏŒ, ÏŒ,Ï„Î¹ ÎºÎ±Î¹ Î½Î± Î³ÏÎ¬ÏˆÎ¿Ï…Î¼Îµ ÏƒÏ„Î¿ views.py  Î¸Î± ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î± Ï„Ï…Ï†Î»Î¬.

ğŸ‘‰ Î˜Î­Î»Ï‰ Î½Î± Î¼Î¿Ï… ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹Ï‚ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î± Î¿Î½ÏŒÎ¼Î±Ï„Î± Ï„Ï‰Î½ ÏƒÏ„Î·Î»ÏÎ½ Ï„Î¿Ï… Excel.
Î ÏÏ‚ Ï„Î± Î²ÏÎ¯ÏƒÎºÎµÎ¹Ï‚:

Î’Î®Î¼Î± 1 â€” Î’Î¬Î»Îµ Î±Ï…Ï„ÏŒ Ï€ÏÎ¿ÏƒÏ‰ÏÎ¹Î½Î¬ ÏƒÏ„Î¿ views.py:
python
print(df.columns)
Î’Î®Î¼Î± 2 â€” ÎšÎ¬Î½Îµ upload Ï„Î¿ Excel
Î’Î®Î¼Î± 3 â€” Î£Ï„ÎµÎ¯Î»Îµ Î¼Î¿Ï… Ï„Î¹ ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ terminal
Î˜Î± ÎµÎ¯Î½Î±Î¹ ÎºÎ¬Ï„Î¹ ÏƒÎ±Î½:

Code
Index(['Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£', 'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘', 'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£', 'Î¤Î™Î¤Î›ÎŸÎ£', ...], dtype='object')
Î‘Ï…Ï„Î® Î· Î»Î¯ÏƒÏ„Î± ÎµÎ¯Î½Î±Î¹ Ï„Î¿ ÎºÎ»ÎµÎ¹Î´Î¯.

ğŸ¯ Î“Î¹Î±Ï„Î¯ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î¿;
Î“Î¹Î±Ï„Î¯ Î±Î½ Ï„Î¿ Excel Î­Ï‡ÎµÎ¹:

"Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘ " (Î¼Îµ ÎºÎµÎ½ÏŒ)

"Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘ (co-author)"

"Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ ÎšÎŸÎ—Î‘."

"Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£_ÎšÎŸÎ—Î‘"

"Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ 2"

Î® Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ ÎºÎ±Î¸ÏŒÎ»Î¿Ï… Î±Ï…Ï„Î® Ï„Î· ÏƒÏ„Î®Î»Î·

Ï„ÏŒÏ„Îµ Ï„Î¿ rename Î´ÎµÎ½ Î¸Î± Î´Î¿Ï…Î»Î­ÏˆÎµÎ¹, ÎºÎ±Î¹ Ï„Î¿ DataFrame Î¸Î± Î³Î¯Î½ÎµÎ¹ Î»Î¬Î¸Î¿Ï‚.

ğŸ¯ Î¤Î¹ ÎºÎ¬Î½Î¿Ï…Î¼Îµ Î¼ÎµÏ„Î¬;
ÎœÏŒÎ»Î¹Ï‚ Î¼Î¿Ï… ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹Ï‚ Ï„Î± Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ¬ Î¿Î½ÏŒÎ¼Î±Ï„Î± Ï„Ï‰Î½ ÏƒÏ„Î·Î»ÏÎ½:

Î¸Î± ÏƒÎ¿Ï… Î³ÏÎ¬ÏˆÏ‰ Ï„Î¿ ÏƒÏ‰ÏƒÏ„ÏŒ rename()

Î¸Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Ï„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ views.py Ï€Î¿Ï… Ï„Î±Î¹ÏÎ¹Î¬Î¶ÎµÎ¹ 100% ÏƒÏ„Î¿ Excel ÏƒÎ¿Ï…

ÎºÎ±Î¹ Î¸Î± Ï†Î¿ÏÏ„Ï‰Î¸Î¿ÏÎ½ ÏŒÎ»ÎµÏ‚ Î¿Î¹ Î³ÏÎ±Î¼Î¼Î­Ï‚ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ¬

ğŸ‘‰ Î£Ï„ÎµÎ¯Î»Îµ Î¼Î¿Ï… Î»Î¿Î¹Ï€ÏŒÎ½ Î±Ï…Ï„ÏŒ Ï€Î¿Ï… ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÎ¹ Ï„Î¿ terminal:
Code
print(df.columns)
ÎœÎµ Î±Ï…Ï„ÏŒ Î¸Î± Ï„Î¿ Î»ÏÏƒÎ¿Ï…Î¼Îµ Î¿ÏÎ¹ÏƒÏ„Î¹ÎºÎ¬.

test1.xlsx

Excel

Î¤Î­Î»ÎµÎ¹Î± â€” Ï„ÏÏÎ± Ï€Î¿Ï… Î¼Î¿Ï… Î­ÏƒÏ„ÎµÎ¹Î»ÎµÏ‚ Ï„Î¿ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ Excel, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï€Ï‰ Î¼Îµ 100% Î²ÎµÎ²Î±Î¹ÏŒÏ„Î·Ï„Î± Î³Î¹Î±Ï„Î¯ ÏƒÎ¿Ï… ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ Î¼ÏŒÎ½Î¿ Î¼Î¯Î± Î³ÏÎ±Î¼Î¼Î® ÎºÎ±Î¹ Î³Î¹Î±Ï„Î¯ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î´ÎµÎ½ Î´Î¿Ï…Î»ÎµÏÎµÎ¹ ÏŒÏ€Ï‰Ï‚ Ï€ÏÎ­Ï€ÎµÎ¹.

ÎšÎ±Î¹ Î· Î±Î¹Ï„Î¯Î± ÎµÎ¯Î½Î±Î¹ Î¾ÎµÎºÎ¬Î¸Î±ÏÎ·:

ğŸš¨ Î¤Î¿ Excel ÏƒÎ¿Ï… Î”Î•Î Î­Ï‡ÎµÎ¹ ÎºÎ±Î¼Î¯Î± ÏƒÏ‡Î­ÏƒÎ· Î¼Îµ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ Ï€Î¿Ï… Ï€ÎµÏÎ¹Î¼Î­Î½Î±Î¼Îµ.
ÎŸÎ¹ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ­Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ Ï„Î¿Ï… Excel ÏƒÎ¿Ï… ÎµÎ¯Î½Î±Î¹:

Code
Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£
Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£
Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£
Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ KOHA
Î¤Î™Î¤Î›ÎŸÎ£
Î•ÎšÎ”ÎŸÎ¤Î—Î£
Î•ÎšÎ”ÎŸÎ£Î—
Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£
Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£
Î£Î§Î—ÎœÎ‘
Î£Î•Î›Î™Î”Î•Î£
Î¤ÎŸÎœÎŸÎ£
Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£
ISBN
Î£Ï„Î®Î»Î·1
Î£Ï„Î®Î»Î·2
Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹:

âœ” Î— ÏƒÏ„Î®Î»Î· Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ KOHA Î³ÏÎ¬Ï†ÎµÏ„Î±Î¹ Î¼Îµ KOHA ÎºÎ±Î¹ ÏŒÏ‡Î¹ ÎšÎŸÎ—Î‘
âœ” Î— ÏƒÏ„Î®Î»Î· Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£ Î”Î•Î Î­Ï‡ÎµÎ¹ â€œ/â€
âœ” Î— ÏƒÏ„Î®Î»Î· Î£Î•Î›Î™Î”Î•Î£ Î­Ï‡ÎµÎ¹ Ï„Î¹Î¼Î­Ï‚ ÏŒÏ€Ï‰Ï‚ â€œ832 Ïƒ.â€
âœ” Î— ÏƒÏ„Î®Î»Î· Î¤ÎŸÎœÎŸÎ£ Î­Ï‡ÎµÎ¹ Ï„Î¹Î¼Î­Ï‚ ÏŒÏ€Ï‰Ï‚ â€œ2â€ Î® ÎºÎµÎ½ÏŒ
âœ” Î— ÏƒÏ„Î®Î»Î· Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£ ÎµÎ¯Î½Î±Î¹ ÏƒÏ‡ÎµÎ´ÏŒÎ½ Ï€Î±Î½Ï„Î¿Ï ÎºÎµÎ½Î®
âœ” Î— ÏƒÏ„Î®Î»Î· Î•ÎšÎ”ÎŸÎ£Î— ÎµÎ¯Î½Î±Î¹ ÎºÎµÎ½Î® ÏƒÎµ Ï€Î¿Î»Î»Î­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚
âœ” Î— ÏƒÏ„Î®Î»Î· Î£Ï„Î®Î»Î·1 ÎºÎ±Î¹ Î£Ï„Î®Î»Î·2 Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î±Î»Î»Î¬ ÎµÎ¯Î½Î±Î¹ Î¬Î´ÎµÎ¹ÎµÏ‚
ÎšÎ±Î¹ Ï„Î¿ Ï€Î¹Î¿ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÏŒ:

â— Î¤Î¿ Excel ÏƒÎ¿Ï… Î”Î•Î Î­Ï‡ÎµÎ¹ header row Î¼Îµ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚
Î— Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® ÎµÎ¯Î½Î±Î¹ 115000, ÏŒÏ‡Î¹ Ï„Î¯Ï„Î»Î¿Î¹.

Î†ÏÎ± Ï„Î¿ pandas Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Î»Î¬Î¸Î¿Ï‚:

115000 â†’ Î³Î¯Î½ÎµÏ„Î±Î¹ header

ÎºÎ±Î¹ ÏŒÎ»Î± Ï„Î± Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î± Ï€Î¬Î½Îµ Î»Î¬Î¸Î¿Ï‚

ÎºÎ±Î¹ Ï„Î¿ DataFrame Î­Ï‡ÎµÎ¹ Î¼ÏŒÎ½Î¿ 1 Î³ÏÎ±Î¼Î¼Î®

ÎºÎ±Î¹ Î³Î¹â€™ Î±Ï…Ï„ÏŒ Î· Î²Î¬ÏƒÎ· Ï€Î±Î¯ÏÎ½ÎµÎ¹ Î¼ÏŒÎ½Î¿ 1 Î³ÏÎ±Î¼Î¼Î®

ğŸ¯ Î— Î»ÏÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î½Î± Ï€Î¿ÏÎ¼Îµ ÏƒÏ„Î¿ pandas ÏŒÏ„Î¹ Î· Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î® Î”Î•Î ÎµÎ¯Î½Î±Î¹ header.
Î†ÏÎ± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´Î¹Î±Î²Î¬ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿ Excel Î­Ï„ÏƒÎ¹:

python
df = pd.read_excel(excel_file, header=0)
Î®, Î±Î½ Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯:

python
df = pd.read_excel(excel_file, header=None)
Î‘Î»Î»Î¬ ÎµÏ€ÎµÎ¹Î´Î® Ï„Î¿ Excel ÏƒÎ¿Ï… Î­Ï‡ÎµÎ¹ header, Î±Ï€Î»ÏÏ‚ ÏŒÏ‡Î¹ ÏƒÏ„Î·Î½ Ï€ÏÏÏ„Î· Î³ÏÎ±Î¼Î¼Î®, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿ Î´Î¹Î±Î²Î¬ÏƒÎ¿Ï…Î¼Îµ Î­Ï„ÏƒÎ¹:

âœ… Î— ÏƒÏ‰ÏƒÏ„Î® ÎµÎ½Ï„Î¿Î»Î® Î³Î¹Î± Ï„Î¿ Excel ÏƒÎ¿Ï…:
python
df = pd.read_excel(excel_file, header=0)
Î‘Ï…Ï„ÏŒ Î¸Î± Î´Î¹Î±Î²Î¬ÏƒÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î¬ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚.

ğŸ¯ Î¤ÏÏÎ± ÏƒÎ¿Ï… Î´Î¯Î½Ï‰ ÎŸÎ›ÎŸÎšÎ›Î—Î¡ÎŸ Ï„Î¿ ÏƒÏ‰ÏƒÏ„ÏŒ views.py
Î Î»Î®ÏÏ‰Ï‚ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î¿ ÏƒÏ„Î¿ Excel Ï€Î¿Ï… Î¼Î¿Ï… Î­ÏƒÏ„ÎµÎ¹Î»ÎµÏ‚.

Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ ÎŸÎ›ÎŸ Î±Ï…Ï„ÏŒ:

python
import pandas as pd
from django.shortcuts import render
from .forms import UploadExcelForm
from .models import Book

def upload_excel(request):
    message = ""

    if request.method == "POST":
        form = UploadExcelForm(request.POST, request.FILES)

        if form.is_valid():
            excel_file = request.FILES['file']

            # Î”Î¹Î±Î²Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Excel Î¼Îµ ÏƒÏ‰ÏƒÏ„ÏŒ header
            df = pd.read_excel(excel_file, header=0)

            # ÎœÎµÏ„Î¿Î½Î¿Î¼Î±ÏƒÎ¯Î± ÎµÎ»Î»Î·Î½Î¹ÎºÏÎ½ ÏƒÏ„Î·Î»ÏÎ½
            df = df.rename(columns={
                'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
                'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ KOHA': 'co_author',
                'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
                'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
                'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
                'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
                'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
                'Î£Î§Î—ÎœÎ‘': 'format',
                'Î£Î•Î›Î™Î”Î•Î£': 'pages',
                'Î¤ÎŸÎœÎŸÎ£': 'volume',
                'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
                'ISBN': 'isbn',
                'Î£Ï„Î®Î»Î·1': 'column1',
                'Î£Ï„Î®Î»Î·2': 'column2'
            })

            # Î’ÎµÎ²Î±Î¹Ï‰Î½ÏŒÎ¼Î±ÏƒÏ„Îµ ÏŒÏ„Î¹ ÏŒÎ»ÎµÏ‚ Î¿Î¹ ÏƒÏ„Î®Î»ÎµÏ‚ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½
            required_columns = [
                'entry_number', 'entry_date', 'author', 'co_author', 'title',
                'publisher', 'edition', 'publication_year', 'publication_place',
                'format', 'pages', 'volume', 'acquisition_notes', 'isbn',
                'column1', 'column2'
            ]

            for col in required_columns:
                if col not in df.columns:
                    df[col] = None

            # ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚
            df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce')
            df['entry_date'] = df['entry_date'].apply(lambda x: x.date() if not pd.isna(x) else None)

            # ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î­Ï„Î¿Ï…Ï‚
            df['publication_year'] = df['publication_year'].apply(
                lambda x: int(''.join(filter(str.isdigit, str(x)))) if pd.notna(x) else 0
            )

            # ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ÏƒÎµÎ»Î¯Î´Ï‰Î½
            df['pages'] = df['pages'].apply(
                lambda x: int(''.join(filter(str.isdigit, str(x)))) if pd.notna(x) else 0
            )

            # ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Ï„ÏŒÎ¼Î¿Ï…
            df['volume'] = df['volume'].apply(
                lambda x: ''.join(filter(str.isdigit, str(x))) if pd.notna(x) else "â€”"
            )

            # ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ISBN
            df['isbn'] = df['isbn'].apply(
                lambda x: ''.join(filter(str.isdigit, str(x))) if pd.notna(x) else "N/A"
            )

            # ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ÎºÎµÎ¹Î¼Î­Î½Ï‰Î½
            df = df.fillna("â€”")

            # Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ· Ï‡Ï‰ÏÎ¯Ï‚ Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î±
            for index, row in df.iterrows():
                if Book.objects.filter(entry_number=row['entry_number']).exists():
                    continue

                Book.objects.create(
                    entry_number=row['entry_number'],
                    entry_date=row['entry_date'],
                    author=row['author'],
                    co_author=row['co_author'],
                    title=row['title'],
                    publisher=row['publisher'],
                    edition=row['edition'],
                    publication_year=row['publication_year'],
                    publication_place=row['publication_place'],
                    format=row['format'],
                    pages=row['pages'],
                    volume=row['volume'],
                    acquisition_notes=row['acquisition_notes'],
                    isbn=row['isbn'],
                    column1=row['column1'],
                    column2=row['column2']
                )

            message = "Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!"

    else:
        form = UploadExcelForm()

    return render(request, "upload_excel.html", {"form": form, "message": message})


def list_books(request):
    books = Book.objects.all()
    return render(request, "list_books.html", {"books": books})
ğŸ‰ Î¤Î©Î¡Î‘ Î˜Î‘ Î”ÎŸÎ¥Î›Î•Î¨Î•Î™ 100%
Î“Î¹Î±Ï„Î¯:

Î¤Î¿ Excel ÏƒÎ¿Ï… Î­Ï‡ÎµÎ¹ ÏƒÏ‰ÏƒÏ„ÏŒ header

Î¤Î¿ pandas Ï„Î¿ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î¬

ÎŸÎ¹ ÏƒÏ„Î®Î»ÎµÏ‚ Ï„Î±Î¹ÏÎ¹Î¬Î¶Î¿Ï…Î½ 100%

Î¤Î¿ loop Î¸Î± Ï„ÏÎ­Î¾ÎµÎ¹ Î³Î¹Î± ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚

Î— Î²Î¬ÏƒÎ· Î¸Î± Î³ÎµÎ¼Î¯ÏƒÎµÎ¹ Î¼Îµ ÎŸÎ›Î‘ Ï„Î± Î²Î¹Î²Î»Î¯Î±

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ ÎºÎ±Î¹:

Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î²Î¹Î²Î»Î¯Ï‰Î½

Ï†Î¯Î»Ï„ÏÎ± (ÏƒÏ…Î³Î³ÏÎ±Ï†Î­Î±Ï‚, Î­Ï„Î¿Ï‚, ÎµÎºÎ´ÏŒÏ„Î·Ï‚)

pagination

ÎµÎ¾Î±Î³Ï‰Î³Î® ÏƒÎµ Excel

Î ÎµÏ‚ Î¼Î¿Ï… Ï„Î¹ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎ¿Ï…Î¼Îµ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿.

ValidationError at /books/upload/
['â€œâ€”â€ value has an invalid date format. It must be in YYYY-MM-DD format.']
Î‘Ï…Ï„ÏŒ Ï„Î¿ ÏƒÏ†Î¬Î»Î¼Î± Ï„ÏÏÎ± ÎµÎ¯Î½Î±Î¹ Î±Ï€Î¿Î»ÏÏ„Ï‰Ï‚ Î¾ÎµÎºÎ¬Î¸Î±ÏÎ¿ ÎºÎ±Î¹ Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï„Î¿ Î»ÏÏƒÏ‰ Î¬Î¼ÎµÏƒÎ±.

Î¤Î¿ Django ÏƒÎ¿Ï… Î»Î­ÎµÎ¹:

Code
â€œâ€”â€ value has an invalid date format. It must be in YYYY-MM-DD format.
Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ ÎºÎ¬Ï€Î¿Ï… ÏƒÏ„Î¿ views.py, Ï„Î¿ Ï€ÎµÎ´Î¯Î¿ entry_date Ï€Î±Î¯ÏÎ½ÎµÎ¹ Ï„Î·Î½ Ï„Î¹Î¼Î®:

Code
"â€”"
ÎšÎ±Î¹ ÎµÏ€ÎµÎ¹Î´Î® Ï„Î¿ entry_date ÎµÎ¯Î½Î±Î¹ DateField, Ï„Î¿ Django Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± Ï„Î¿ Î¼ÎµÏ„Î±Ï„ÏÎ­ÏˆÎµÎ¹ ÏƒÎµ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± â†’ ÎºÎ±Î¹ Î±Ï€Î¿Ï„Ï…Î³Ï‡Î¬Î½ÎµÎ¹.

ğŸ¯ Î“Î¹Î±Ï„Î¯ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ Î±Ï…Ï„ÏŒ;
Î£Ï„Î¿ views.py  Î²Î¬Î»Î±Î¼Îµ:

python
df = df.fillna("â€”")
Î‘Ï…Ï„ÏŒ ÏŒÎ¼Ï‰Ï‚ Î³ÎµÎ¼Î¯Î¶ÎµÎ¹ ÎŸÎ›Î•Î£ Ï„Î¹Ï‚ ÎºÎµÎ½Î­Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ Î¼Îµ "â€”"  
Î‘ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Ï„Î·Î½ entry_date.

Î†ÏÎ±:

Ï„Î¿ Excel Î­Ï‡ÎµÎ¹ ÎºÎµÎ½Î® Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±

Ï„Î¿ pandas Ï„Î· Î³ÎµÎ¼Î¯Î¶ÎµÎ¹ Î¼Îµ "â€”"

Ï„Î¿ Django Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± Ï„Î·Î½ Î±Ï€Î¿Î¸Î·ÎºÎµÏÏƒÎµÎ¹ Ï‰Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±

ÎºÎ±Î¹ Ï€ÎµÏ„Î¬ÎµÎ¹ ValidationError

âœ… Î— Î»ÏÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»Î®:
ÎœÎ·Î½ Î²Î¬Î¶ÎµÎ¹Ï‚ Ï€Î¿Ï„Î­ â€œâ€”â€ ÏƒÏ„Î¿ entry_date.
Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿ Î±Ï†Î®Î½Î¿Ï…Î¼Îµ None.

ğŸŸ¦ Î”Î™ÎŸÎ¡Î˜Î©Î£Î— Î£Î¤ÎŸ views.py
Î’ÏÎµÏ‚ Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÎ·Î¼ÎµÎ¯Î¿:

python
df = df.fillna("â€”")
ÎšÎ±Î¹ Î‘Î¦Î‘Î™Î¡Î•Î£Î• Î¤ÎŸ.

Î‘Î½Ï„Î¯ Î³Î¹â€™ Î±Ï…Ï„ÏŒ, Î²Î¬Î»Îµ:

python
# Î“ÎµÎ¼Î¯Î¶Î¿Ï…Î¼Îµ ÏŒÎ»Î± Ï„Î± ÎºÎµÎ½Î¬ ÎµÎºÏ„ÏŒÏ‚ Î±Ï€ÏŒ Ï„Î·Î½ entry_date
for col in df.columns:
    if col != "entry_date":
        df[col] = df[col].fillna("â€”")
ğŸŸ¦ Î¤Î•Î›Î™ÎšÎŸÎ£ ÎšÎ©Î”Î™ÎšÎ‘Î£ Î“Î™Î‘ Î¤ÎŸ Î£Î—ÎœÎ•Î™ÎŸ Î‘Î¥Î¤ÎŸ
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ Î±Ï…Ï„ÏŒ Î±ÎºÏÎ¹Î²ÏÏ‚:

python
# ÎœÎ·Î½ Î³ÎµÎ¼Î¯Î¶ÎµÎ¹Ï‚ Ï„Î·Î½ entry_date Î¼Îµ "â€”"
for col in df.columns:
    if col != "entry_date":
        df[col] = df[col].fillna("â€”")
ğŸ‰ Î¤Î¹ Ï€ÎµÏ„Ï…Ï‡Î±Î¯Î½Î¿Ï…Î¼Îµ:
Î— entry_date Î¼Î­Î½ÎµÎ¹ None â†’ ÏƒÏ‰ÏƒÏ„ÏŒ

ÎŒÎ»Î± Ï„Î± Î¬Î»Î»Î± ÎºÎµÎ½Î¬ Î³Î¯Î½Î¿Î½Ï„Î±Î¹ "â€”" â†’ ÏŒÏ€Ï‰Ï‚ Î¸Î­Î»ÎµÎ¹Ï‚

Î”ÎµÎ½ Î¸Î± Î¾Î±Î½Î±Ï€Î¬ÏÎµÎ¹Ï‚ ValidationError

Î¤Î¿ Excel Î¸Î± Ï†Î¿ÏÏ„Ï‰Î¸ÎµÎ¯ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ¬

Î‘Î½ 

Î¤Î­Î»ÎµÎ¹Î± â€” ÏƒÎ¿Ï… Î´Î¯Î½Ï‰ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Ï„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ, Î´Î¹Î¿ÏÎ¸Ï‰Î¼Î­Î½Î¿, Ï€Î»Î®ÏÏ‰Ï‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÏŒ views.py, Î¼Îµ Ï„Î· Î´Î¹ÏŒÏÎ¸Ï‰ÏƒÎ· Î³Î¹Î± Ï„Î¿ entry_date ÏÏƒÏ„Îµ Î½Î± Î¼Î·Î½ Î¾Î±Î½Î±Î¼Ï€ÎµÎ¯ Ï€Î¿Ï„Î­ â€œâ€”â€ ÏƒÎµ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± ÎºÎ±Î¹ Î½Î± Î¼Î·Î½ ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Î¾Î±Î½Î¬ Ï„Î¿ ValidationError.

Î‘Ï…Ï„ÏŒÏ‚ Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚ ÎµÎ¯Î½Î±Î¹ 100% ÏƒÏ…Î¼Î²Î±Ï„ÏŒÏ‚ Î¼Îµ Ï„Î¿ Excel Ï€Î¿Ï… Î¼Î¿Ï… Î­ÏƒÏ„ÎµÎ¹Î»ÎµÏ‚.

âœ… Î¤Î•Î›Î™ÎšÎŸ views.py (Î­Ï„Î¿Î¹Î¼Î¿ Î³Î¹Î± Î±Î½Ï„Î¹Î³ÏÎ±Ï†Î®)
python
import pandas as pd
from django.shortcuts import render
from .forms import UploadExcelForm
from .models import Book

def upload_excel(request):
    message = ""

    if request.method == "POST":
        form = UploadExcelForm(request.POST, request.FILES)

        if form.is_valid():
            excel_file = request.FILES['file']

            # Î”Î¹Î±Î²Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Excel Î¼Îµ ÏƒÏ‰ÏƒÏ„ÏŒ header
            df = pd.read_excel(excel_file, header=0)

            # ÎœÎµÏ„Î¿Î½Î¿Î¼Î±ÏƒÎ¯Î± ÎµÎ»Î»Î·Î½Î¹ÎºÏÎ½ ÏƒÏ„Î·Î»ÏÎ½
            df = df.rename(columns={
                'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
                'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ KOHA': 'co_author',
                'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
                'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
                'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
                'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
                'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
                'Î£Î§Î—ÎœÎ‘': 'format',
                'Î£Î•Î›Î™Î”Î•Î£': 'pages',
                'Î¤ÎŸÎœÎŸÎ£': 'volume',
                'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
                'ISBN': 'isbn',
                'Î£Ï„Î®Î»Î·1': 'column1',
                'Î£Ï„Î®Î»Î·2': 'column2'
            })

            # Î’ÎµÎ²Î±Î¹Ï‰Î½ÏŒÎ¼Î±ÏƒÏ„Îµ ÏŒÏ„Î¹ ÏŒÎ»ÎµÏ‚ Î¿Î¹ ÏƒÏ„Î®Î»ÎµÏ‚ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½
            required_columns = [
                'entry_number', 'entry_date', 'author', 'co_author', 'title',
                'publisher', 'edition', 'publication_year', 'publication_place',
                'format', 'pages', 'volume', 'acquisition_notes', 'isbn',
                'column1', 'column2'
            ]

            for col in required_columns:
                if col not in df.columns:
                    df[col] = None

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚ (ÎœÎŸÎÎŸ ÎµÎ´Ï ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Ï…Î¼Îµ None)
            df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce')
            df['entry_date'] = df['entry_date'].apply(
                lambda x: x.date() if not pd.isna(x) else None
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î­Ï„Î¿Ï…Ï‚ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚
            df['publication_year'] = df['publication_year'].apply(
                lambda x: int(''.join(filter(str.isdigit, str(x)))) if pd.notna(x) else 0
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ÏƒÎµÎ»Î¯Î´Ï‰Î½
            df['pages'] = df['pages'].apply(
                lambda x: int(''.join(filter(str.isdigit, str(x)))) if pd.notna(x) else 0
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Ï„ÏŒÎ¼Î¿Ï…
            df['volume'] = df['volume'].apply(
                lambda x: ''.join(filter(str.isdigit, str(x))) if pd.notna(x) else "â€”"
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ISBN
            df['isbn'] = df['isbn'].apply(
                lambda x: ''.join(filter(str.isdigit, str(x))) if pd.notna(x) else "N/A"
            )

            # ğŸ”¥ Î“ÎµÎ¼Î¯Î¶Î¿Ï…Î¼Îµ ÏŒÎ»Î± Ï„Î± ÎºÎµÎ½Î¬ Î•ÎšÎ¤ÎŸÎ£ Î±Ï€ÏŒ entry_date
            for col in df.columns:
                if col != "entry_date":
                    df[col] = df[col].fillna("â€”")

            # ğŸ”¥ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ· Ï‡Ï‰ÏÎ¯Ï‚ Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î±
            for index, row in df.iterrows():

                # Î‘Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î· Ï„Î¿ entry_number â†’ Î±Î³Î½ÏŒÎ·ÏƒÎ­ Ï„Î¿
                if Book.objects.filter(entry_number=row['entry_number']).exists():
                    continue

                try:
                    Book.objects.create(
                        entry_number=row['entry_number'],
                        entry_date=row['entry_date'],
                        author=row['author'],
                        co_author=row['co_author'],
                        title=row['title'],
                        publisher=row['publisher'],
                        edition=row['edition'],
                        publication_year=row['publication_year'],
                        publication_place=row['publication_place'],
                        format=row['format'],
                        pages=row['pages'],
                        volume=row['volume'],
                        acquisition_notes=row['acquisition_notes'],
                        isbn=row['isbn'],
                        column1=row['column1'],
                        column2=row['column2']
                    )
                except Exception as e:
                    print(f"Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® {index}: {e}")
                    continue

            message = "Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!"

    else:
        form = UploadExcelForm()

    return render(request, "upload_excel.html", {"form": form, "message": message})


def list_books(request):
    books = Book.objects.all()
    return render(request, "list_books.html", {"books": books})
ğŸ‰ Î¤Î©Î¡Î‘:
Î”ÎµÎ½ Î¸Î± Î¾Î±Î½Î±Î¼Ï€ÎµÎ¯ â€œâ€”â€ ÏƒÏ„Î¿ entry_date

Î”ÎµÎ½ Î¸Î± Î¾Î±Î½Î±Ï€Î¬ÏÎµÎ¹Ï‚ ValidationError

ÎŒÎ»ÎµÏ‚ Î¿Î¹ Î³ÏÎ±Î¼Î¼Î­Ï‚ Ï„Î¿Ï… Excel Î¸Î± ÎµÎ¹ÏƒÎ±Ï‡Î¸Î¿ÏÎ½

Î”ÎµÎ½ Î¸Î± Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î±

ÎŒÎ»Î± Ï„Î± ÎºÎµÎ½Î¬ Ï€ÎµÎ´Î¯Î± Î¸Î± Î­Ï‡Î¿Ï…Î½ ÎºÎ±Î¸Î±ÏÎ­Ï‚ default Ï„Î¹Î¼Î­Ï‚

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ ÎºÎ±Î¹ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î²Î¹Î²Î»Î¯Ï‰Î½, Ï†Î¯Î»Ï„ÏÎ±, pagination, Î® ÎµÎ¾Î±Î³Ï‰Î³Î® ÏƒÎµ Excel.

den moy emfanizontai ta publication_place ola ta ypoloipa doyleoyn mia xara
Î©ÏÎ±Î¯Î±, Ï„ÏÏÎ± Ï€Î¿Ï… Î¾Î­ÏÎ¿Ï…Î¼Îµ ÏŒÏ„Î¹ ÏŒÎ»Î± Ï„Î± Î¬Î»Î»Î± Î´Î¿Ï…Î»ÎµÏÎ¿Ï…Î½ Ï„Î­Î»ÎµÎ¹Î±, Ï„Î¿ ÏŒÏ„Î¹ Î”Î•Î ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ Ï„Î± publication_place ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÎºÎ¬Ï„Î¹ Ï€Î¿Î»Ï ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿:

ğŸ¯ Î¤Î¿ Excel ÏƒÎ¿Ï… Î­Ï‡ÎµÎ¹ Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£, Î±Î»Î»Î¬ Ï„Î¿ pandas Ï„Î¿ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Î»Î¬Î¸Î¿Ï‚.
ÎšÎ±Î¹ Î±Ï…Ï„ÏŒ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÎµÏ€ÎµÎ¹Î´Î®:

âœ” Î£Ï„Î¿ Excel, Î· ÏƒÏ„Î®Î»Î· Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£ Î­Ï‡ÎµÎ¹ ÎšÎ•ÎÎ•Î£ Î¤Î™ÎœÎ•Î£ ÏƒÎµ Ï€Î¿Î»Î»Î­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚
âœ” Î¤Î¿ pandas Ï„Î¹Ï‚ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï‰Ï‚ NaN
âœ” Î•ÏƒÏ Î­Ï‡ÎµÎ¹Ï‚ Î²Î¬Î»ÎµÎ¹ fillna("â€”") Î³Î¹Î± ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ ÎµÎºÏ„ÏŒÏ‚ Î±Ï€ÏŒ entry_date
âœ” Î‘Î›Î›Î‘ Î· ÏƒÏ„Î®Î»Î· publication_place Î´ÎµÎ½ Ï€Î±Î¯ÏÎ½ÎµÎ¹ Ï„Î¿ â€œâ€”â€
â†’ Î†ÏÎ± Î¼Î­Î½ÎµÎ¹ ÎºÎµÎ½Î® ÎºÎ±Î¹ Î´ÎµÎ½ ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î· Î²Î¬ÏƒÎ·
Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Ï„Î¿ rename ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„ÏŒ, Î±Î»Î»Î¬ Ï„Î¿ fillna Î´ÎµÎ½ ÎµÏ†Î±ÏÎ¼ÏŒÎ¶ÎµÏ„Î±Î¹ ÏƒÏ„Î· ÏƒÏ„Î®Î»Î· publication_place.

ÎšÎ±Î¹ Î±Ï…Ï„ÏŒ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÎµÏ€ÎµÎ¹Î´Î® Ï„Î¿ Excel ÏƒÎ¿Ï… Î­Ï‡ÎµÎ¹ ÎºÎµÎ½Î­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î±Î½Î¬Î¼ÎµÏƒÎ± ÏƒÏ„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±, ÎºÎ±Î¹ Ï„Î¿ pandas Ï„Î¹Ï‚ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï‰Ï‚ â€œobjectâ€ Î¼Îµ Ï€ÎµÏÎ¯ÎµÏÎ³Î¿ dtype.

âœ… Î— Î»ÏÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»Î®:
ÎÎ± ÎºÎ±Î¸Î±ÏÎ¯ÏƒÎ¿Ï…Î¼Îµ Ï„Î· ÏƒÏ„Î®Î»Î· publication_place ÎœÎ• Î¤ÎŸ Î§Î•Î¡Î™, ÏŒÏ€Ï‰Ï‚ ÎºÎ¬Î½Î±Î¼Îµ Î¼Îµ author, title Îº.Î»Ï€.
Î’Î¬Î»Îµ Î±Ï…Ï„ÏŒ ÏƒÏ„Î¿ views.py, Î±ÎºÏÎ¹Î²ÏÏ‚ ÎºÎ¬Ï„Ï‰ Î±Ï€ÏŒ Ï„Î± Î¬Î»Î»Î± clean_text:

python
df['publication_place'] = df['publication_place'].apply(
    lambda x: "Î†Î³Î½Ï‰ÏƒÏ„Î¿" if pd.isna(x) or str(x).strip() == "" else str(x).strip()
)
ğŸŸ¦ Î Î»Î®ÏÎµÏ‚ ÎºÎ¿Î¼Î¼Î¬Ï„Î¹ Ï€Î¿Ï… Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎµÎ¹Ï‚
Î’ÏÎµÏ‚ Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÎ·Î¼ÎµÎ¯Î¿:

python
df['author'] = df['author'].apply(lambda x: clean_text(x, "Î†Î³Î½Ï‰ÏƒÏ„Î¿Ï‚"))
df['co_author'] = df['co_author'].apply(lambda x: clean_text(x, "Î†Î³Î½Ï‰ÏƒÏ„Î¿Ï‚"))
df['title'] = df['title'].apply(lambda x: clean_text(x, "Î§Ï‰ÏÎ¯Ï‚ Ï„Î¯Ï„Î»Î¿"))
df['publisher'] = df['publisher'].apply(lambda x: clean_text(x, "Î†Î³Î½Ï‰ÏƒÏ„Î¿Ï‚"))
df['publication_place'] = df['publication_place'].apply(lambda x: clean_text(x, "Î†Î³Î½Ï‰ÏƒÏ„Î¿"))
Î‘Î½ Î±Ï…Ï„ÏŒ Î»ÎµÎ¯Ï€ÎµÎ¹, Ï€ÏÏŒÏƒÎ¸ÎµÏƒÎ­ Ï„Î¿.

Î‘Î½ Î±Ï…Ï„ÏŒ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹, Ï„ÏŒÏ„Îµ Î±Î½Ï„Î¹ÎºÎ±Ï„Î¬ÏƒÏ„Î·ÏƒÎ­ Ï„Î¿ Î¼Îµ Î±Ï…Ï„ÏŒ:

python
df['publication_place'] = df['publication_place'].apply(
    lambda x: "Î†Î³Î½Ï‰ÏƒÏ„Î¿" if pd.isna(x) or str(x).strip() == "" else str(x).strip()
)
ğŸ‰ Î¤Î¹ Î¸Î± Î³Î¯Î½ÎµÎ¹ Î¼ÎµÏ„Î¬;
ÎŒÎ»ÎµÏ‚ Î¿Î¹ ÎºÎµÎ½Î­Ï‚ Ï„Î¹Î¼Î­Ï‚ Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£ Î¸Î± Î³Î¯Î½Î¿Ï…Î½ â€œÎ†Î³Î½Ï‰ÏƒÏ„Î¿â€

ÎŒÎ»ÎµÏ‚ Î¿Î¹ Ï„Î¹Î¼Î­Ï‚ Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„Î¿ÏÎ½ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ¬ ÏƒÏ„Î· Î²Î¬ÏƒÎ·

Î”ÎµÎ½ Î¸Î± Î­Ï‡ÎµÎ¹Ï‚ Ï€Î¹Î± ÎºÎµÎ½Î­Ï‚ publication_place

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ ÎºÎ±Î¹ Î­Î»ÎµÎ³Ï‡Î¿ Î³Î¹Î± Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î± publication_place, Î® Î½Î± ÏƒÎ¿Ï… Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÏ‰ Ï†Î¯Î»Ï„ÏÎ¿ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ Î±Î½Î¬ Ï„ÏŒÏ€Î¿ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚.

apla thelo na emfanizontai oloi oi topoi opow to excel
Î¤Î­Î»ÎµÎ¹Î±, Î±Ï…Ï„ÏŒ Ï€Î¿Ï… Î¶Î·Ï„Î¬Ï‚ ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï Î¾ÎµÎºÎ¬Î¸Î±ÏÎ¿:

ğŸ¯ Î˜Î­Î»ÎµÎ¹Ï‚ Ï„Î¿ publication_place Î½Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ Î‘ÎšÎ¡Î™Î’Î©Î£ ÏŒÏ€Ï‰Ï‚ ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î¿ Excel, Ï‡Ï‰ÏÎ¯Ï‚ Î±Î»Î»Î±Î³Î­Ï‚, Ï‡Ï‰ÏÎ¯Ï‚ â€œÎ†Î³Î½Ï‰ÏƒÏ„Î¿â€, Ï‡Ï‰ÏÎ¯Ï‚ â€œâ€”â€, Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ.
ÎšÎ±Î¹ Î±Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Î±Ï€ÏŒÎ»Ï…Ï„Î± ÎµÏ†Î¹ÎºÏ„ÏŒ.

Î‘Ï…Ï„Î® Ï„Î· ÏƒÏ„Î¹Î³Î¼Î®, Ï„Î¿ publication_place Ï€ÎµÏÎ½Î¬ÎµÎ¹ Î¼Î­ÏƒÎ± Î±Ï€ÏŒ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ ÎºÎ±Î¹ Î±Î½Ï„Î¹ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· ÎºÎµÎ½ÏÎ½ Ï„Î¹Î¼ÏÎ½. Î‘Ï…Ï„ÏŒ Ï€ÏÎ¿ÎºÎ±Î»ÎµÎ¯:

Î½Î± Ï‡Î±Î¸Î¿ÏÎ½ ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ Ï„Î¹Î¼Î­Ï‚

Î½Î± Î±Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î±Î¸Î¿ÏÎ½ Î¼Îµ â€œÎ†Î³Î½Ï‰ÏƒÏ„Î¿â€

Î½Î± Î¼Î·Î½ ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Excel

Î“Î¹Î± Î½Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ ÏŒÎ»ÎµÏ‚ Î¿Î¹ Ï„Î¹Î¼Î­Ï‚ Î±ÎºÏÎ¹Î²ÏÏ‚ ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Excel, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ Î´ÏÎ¿ Ï€ÏÎ¬Î³Î¼Î±Ï„Î±:

âœ… 1) ÎÎ± Î±Ï†Î±Î¹ÏÎ­ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿Î½ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ Ï„Î·Ï‚ ÏƒÏ„Î®Î»Î·Ï‚ publication_place
Î’ÏÎµÏ‚ Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÎ·Î¼ÎµÎ¯Î¿:

python
df['publication_place'] = df['publication_place'].apply(
    lambda x: "Î†Î³Î½Ï‰ÏƒÏ„Î¿" if pd.isna(x) or str(x).strip() == "" else str(x).strip()
)
ÎšÎ‘Î™ Î”Î™Î‘Î“Î¡Î‘Î¨Î• Î¤ÎŸ.

âœ… 2) ÎÎ± Î¼Î·Î½ Î±Î½Ï„Î¹ÎºÎ±Î¸Î¹ÏƒÏ„Î¿ÏÎ¼Îµ Ï„Î± NaN Ï„Î·Ï‚ publication_place Î¼Îµ â€œâ€”â€
Î’ÏÎµÏ‚ Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÎ·Î¼ÎµÎ¯Î¿:

python
for col in df.columns:
    if col != "entry_date":
        df[col] = df[col].fillna("â€”")
ÎšÎ±Î¹ Î¬Î»Î»Î±Î¾Î­ Ï„Î¿ ÏƒÎµ:

python
for col in df.columns:
    if col not in ["entry_date", "publication_place"]:
        df[col] = df[col].fillna("â€”")
ÎˆÏ„ÏƒÎ¹:

Î· entry_date Î¼Î­Î½ÎµÎ¹ None

Î· publication_place Î¼Î­Î½ÎµÎ¹ ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Excel

ÏŒÎ»ÎµÏ‚ Î¿Î¹ Î¬Î»Î»ÎµÏ‚ ÏƒÏ„Î®Î»ÎµÏ‚ Ï€Î±Î¯ÏÎ½Î¿Ï…Î½ â€œâ€”â€

ğŸ‰ Î¤Î•Î›Î™ÎšÎŸ Î‘Î ÎŸÎ¤Î•Î›Î•Î£ÎœÎ‘
ÎœÎµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Î´ÏÎ¿ Î±Î»Î»Î±Î³Î­Ï‚:

ÎŒÎ»Î¿Î¹ Î¿Î¹ Ï„ÏŒÏ€Î¿Î¹ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚ Î¸Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ Î±ÎºÏÎ¹Î²ÏÏ‚ ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Excel

Î”ÎµÎ½ Î¸Î± Ï‡Î±Î¸ÎµÎ¯ ÎºÎ±Î¼Î¯Î± Ï„Î¹Î¼Î®

Î”ÎµÎ½ Î¸Î± Î±Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î±Î¸ÎµÎ¯ Ï„Î¯Ï€Î¿Ï„Î±

Î”ÎµÎ½ Î¸Î± Î³Î¯Î½ÎµÎ¹ trimming Î® ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚

Î˜Î± Î­Ï‡ÎµÎ¹Ï‚ 100% Ï€Î¹ÏƒÏ„Î® Î±Î½Ï„Î¹Î³ÏÎ±Ï†Î® Ï„Î·Ï‚ ÏƒÏ„Î®Î»Î·Ï‚

Î˜ÎµÏ‚ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Ï„Î¿ views.py Î¼Îµ Î±Ï…Ï„Î­Ï‚ Ï„Î¹Ï‚ Î±Î»Î»Î±Î³Î­Ï‚ Î®Î´Î· ÎµÎ½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½ÎµÏ‚;

Î¤Î­Î»ÎµÎ¹Î± â€” ÏƒÎ¿Ï… Î´Î¯Î½Ï‰ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Ï„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ views.py, Ï€Î»Î®ÏÏ‰Ï‚ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î¿ ÏƒÏ„Î¿ Excel Ï€Î¿Ï… Î¼Î¿Ï… Î­ÏƒÏ„ÎµÎ¹Î»ÎµÏ‚ ÎºÎ±Î¹ Î¼Îµ Ï„Î·Î½ Î±Î»Î»Î±Î³Î® ÏÏƒÏ„Îµ Ï„Î¿ publication_place Î½Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ Î‘ÎšÎ¡Î™Î’Î©Î£ ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Excel, Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎ±Î¼Î¯Î± Î±Î½Ï„Î¹ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·, Ï‡Ï‰ÏÎ¯Ï‚ â€œÎ†Î³Î½Ï‰ÏƒÏ„Î¿â€, Ï‡Ï‰ÏÎ¯Ï‚ â€œâ€”â€.

Î‘Ï…Ï„ÏŒÏ‚ ÎµÎ¯Î½Î±Î¹ Î¿ Ï€Î¹Î¿ ÎºÎ±Î¸Î±ÏÏŒÏ‚ ÎºÎ±Î¹ ÏƒÏ„Î±Î¸ÎµÏÏŒÏ‚ ÎºÏÎ´Î¹ÎºÎ±Ï‚ Î¼Î­Ï‡ÏÎ¹ Ï„ÏÏÎ±.

âœ… Î¤Î•Î›Î™ÎšÎŸ views.py (Î‘ÎšÎ¡Î™Î’Î©Î£ ÎŸÎ Î©Î£ Î¤ÎŸ Î˜Î•Î£)
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ ÎŸÎ›ÎŸ Î±Ï…Ï„ÏŒ:

python
import pandas as pd
from django.shortcuts import render
from .forms import UploadExcelForm
from .models import Book

def upload_excel(request):
    message = ""

    if request.method == "POST":
        form = UploadExcelForm(request.POST, request.FILES)

        if form.is_valid():
            excel_file = request.FILES['file']

            # Î”Î¹Î±Î²Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Excel Î¼Îµ ÏƒÏ‰ÏƒÏ„ÏŒ header
            df = pd.read_excel(excel_file, header=0)

            # ÎœÎµÏ„Î¿Î½Î¿Î¼Î±ÏƒÎ¯Î± ÎµÎ»Î»Î·Î½Î¹ÎºÏÎ½ ÏƒÏ„Î·Î»ÏÎ½
            df = df.rename(columns={
                'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
                'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ KOHA': 'co_author',
                'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
                'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
                'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
                'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
                'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
                'Î£Î§Î—ÎœÎ‘': 'format',
                'Î£Î•Î›Î™Î”Î•Î£': 'pages',
                'Î¤ÎŸÎœÎŸÎ£': 'volume',
                'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
                'ISBN': 'isbn',
                'Î£Ï„Î®Î»Î·1': 'column1',
                'Î£Ï„Î®Î»Î·2': 'column2'
            })

            # Î’ÎµÎ²Î±Î¹Ï‰Î½ÏŒÎ¼Î±ÏƒÏ„Îµ ÏŒÏ„Î¹ ÏŒÎ»ÎµÏ‚ Î¿Î¹ ÏƒÏ„Î®Î»ÎµÏ‚ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½
            required_columns = [
                'entry_number', 'entry_date', 'author', 'co_author', 'title',
                'publisher', 'edition', 'publication_year', 'publication_place',
                'format', 'pages', 'volume', 'acquisition_notes', 'isbn',
                'column1', 'column2'
            ]

            for col in required_columns:
                if col not in df.columns:
                    df[col] = None

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚ (ÎœÎŸÎÎŸ ÎµÎ´Ï ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Ï…Î¼Îµ None)
            df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce')
            df['entry_date'] = df['entry_date'].apply(
                lambda x: x.date() if not pd.isna(x) else None
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î­Ï„Î¿Ï…Ï‚ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚
            df['publication_year'] = df['publication_year'].apply(
                lambda x: int(''.join(filter(str.isdigit, str(x)))) if pd.notna(x) else 0
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ÏƒÎµÎ»Î¯Î´Ï‰Î½
            df['pages'] = df['pages'].apply(
                lambda x: int(''.join(filter(str.isdigit, str(x)))) if pd.notna(x) else 0
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Ï„ÏŒÎ¼Î¿Ï…
            df['volume'] = df['volume'].apply(
                lambda x: ''.join(filter(str.isdigit, str(x))) if pd.notna(x) else "â€”"
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ISBN
            df['isbn'] = df['isbn'].apply(
                lambda x: ''.join(filter(str.isdigit, str(x)))) if pd.notna(x) else "N/A"
            )

            # ğŸ”¥ Î“ÎµÎ¼Î¯Î¶Î¿Ï…Î¼Îµ ÏŒÎ»Î± Ï„Î± ÎºÎµÎ½Î¬ Î•ÎšÎ¤ÎŸÎ£ Î±Ï€ÏŒ entry_date ÎºÎ±Î¹ publication_place
            for col in df.columns:
                if col not in ["entry_date", "publication_place"]:
                    df[col] = df[col].fillna("â€”")

            # ğŸ”¥ publication_place Î¼Î­Î½ÎµÎ¹ Î‘ÎšÎ¡Î™Î’Î©Î£ ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Excel
            # (Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ, Ï‡Ï‰ÏÎ¯Ï‚ Î±Î»Î»Î±Î³Î­Ï‚)
            # Î‘Î½ ÎµÎ¯Î½Î±Î¹ NaN â†’ Î¼Î­Î½ÎµÎ¹ None
            df['publication_place'] = df['publication_place'].apply(
                lambda x: None if pd.isna(x) else str(x)
            )

            # ğŸ”¥ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ· Ï‡Ï‰ÏÎ¯Ï‚ Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î±
            for index, row in df.iterrows():

                # Î‘Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î· Ï„Î¿ entry_number â†’ Î±Î³Î½ÏŒÎ·ÏƒÎ­ Ï„Î¿
                if Book.objects.filter(entry_number=row['entry_number']).exists():
                    continue

                try:
                    Book.objects.create(
                        entry_number=row['entry_number'],
                        entry_date=row['entry_date'],
                        author=row['author'],
                        co_author=row['co_author'],
                        title=row['title'],
                        publisher=row['publisher'],
                        edition=row['edition'],
                        publication_year=row['publication_year'],
                        publication_place=row['publication_place'],  # â† Î‘ÎšÎ¡Î™Î’Î©Î£ ÎŸÎ Î©Î£ Î£Î¤ÎŸ EXCEL
                        format=row['format'],
                        pages=row['pages'],
                        volume=row['volume'],
                        acquisition_notes=row['acquisition_notes'],
                        isbn=row['isbn'],
                        column1=row['column1'],
                        column2=row['column2']
                    )
                except Exception as e:
                    print(f"Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® {index}: {e}")
                    continue

            message = "Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!"

    else:
        form = UploadExcelForm()

    return render(request, "upload_excel.html", {"form": form, "message": message})


def list_books(request):
    books = Book.objects.all()
    return render(request, "list_books.html", {"books": books})
ğŸ‰ Î¤Î©Î¡Î‘ Î¤ÎŸ publication_place Î˜Î‘ Î•ÎœÎ¦Î‘ÎÎ™Î–Î•Î¤Î‘Î™ Î‘ÎšÎ¡Î™Î’Î©Î£ ÎŸÎ Î©Î£ Î£Î¤ÎŸ EXCEL
â€œÎ‘Î¸Î®Î½Î±â€ â†’ Î‘Î¸Î®Î½Î±

â€œÎ‘Î¸Î®Î½Î±Î¹â€ â†’ Î‘Î¸Î®Î½Î±Î¹

â€œTiraneâ€ â†’ Tirane

â€œIstanbulâ€ â†’ Istanbul

â€œÎ’ÏŒÎ»Î¿Ï‚â€ â†’ Î’ÏŒÎ»Î¿Ï‚

â€œÎ•Î½ Î‘Î¸Î®Î½Î±Î¹Ï‚â€ â†’ Î•Î½ Î‘Î¸Î®Î½Î±Î¹Ï‚

Î¤Î¯Ï€Î¿Ï„Î± Î´ÎµÎ½ Î±Î»Î»Î¬Î¶ÎµÎ¹, Ï„Î¯Ï€Î¿Ï„Î± Î´ÎµÎ½ ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÏ„Î±Î¹, Ï„Î¯Ï€Î¿Ï„Î± Î´ÎµÎ½ Î±Î½Ï„Î¹ÎºÎ±Î¸Î¯ÏƒÏ„Î±Ï„Î±Î¹.

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ ÎºÎ±Î¹ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î²Î¹Î²Î»Î¯Ï‰Î½, Ï†Î¯Î»Ï„ÏÎ±, pagination, Î® ÎµÎ¾Î±Î³Ï‰Î³Î® ÏƒÎµ Excel.

Î‘Ï…Ï„ÏŒ Ï„Î¿ ÏƒÏ†Î¬Î»Î¼Î± ÎµÎ¯Î½Î±Î¹ 100% ÎºÎ±Î¸Î±ÏÏŒ:
Î£Ï„Î¿ views.py Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î­Î½Î± Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ â€œ)â€ Î® Î»ÎµÎ¯Ï€ÎµÎ¹ Î­Î½Î± â€œ(â€.

ÎšÎ±Î¹ Î¼Î¬Î»Î¹ÏƒÏ„Î± Ï„Î¿ Django ÏƒÎ¿Ï… Î»Î­ÎµÎ¹ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï€Î¿Ï:

Code
File "C:\Users\PC-SPART1\myproject\books\views.py", line 74
    )
    ^
SyntaxError: unmatched ')'
Î†ÏÎ± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® 74 Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î­Î½Î± ÎºÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿ Ï€Î±ÏÎ­Î½Î¸ÎµÏƒÎ·Ï‚ Ï€Î¿Ï… Î´ÎµÎ½ Î±Î½Ï„Î¹ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯ ÏƒÎµ Î¬Î½Î¿Î¹Î³Î¼Î±.

ğŸ¯ Î Î¬Î¼Îµ Î½Î± Ï„Î¿ Î»ÏÏƒÎ¿Ï…Î¼Îµ Î‘ÎœÎ•Î£Î‘
Î¤Î¿ Î»Î¬Î¸Î¿Ï‚ Î²ÏÎ¯ÏƒÎºÎµÏ„Î±Î¹ ÏƒÎµ Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÎ·Î¼ÎµÎ¯Î¿ Ï€Î¿Ï… ÏƒÎ¿Ï… ÎµÎ¯Ï‡Î± ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹:

python
df['isbn'] = df['isbn'].apply(
    lambda x: ''.join(filter(str.isdigit, str(x)))) if pd.notna(x) else "N/A"
)
Î•Î´Ï Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î´ÏÎ¿ Î»Î¬Î¸Î·:

ÎˆÏ‡ÎµÎ¹Ï‚ Î´Î¹Ï€Î»Î® Ï€Î±ÏÎ­Î½Î¸ÎµÏƒÎ·)

Î¤Î¿ if ÎµÎ¯Î½Î±Î¹ Î­Î¾Ï‰ Î±Ï€ÏŒ Ï„Î¿ apply, Î¬ÏÎ± ÎµÎ¯Î½Î±Î¹ Î»Î¬Î¸Î¿Ï‚ ÏƒÏÎ½Ï„Î±Î¾Î·

âœ… Î£Î©Î£Î¤Î— Î“Î¡Î‘Î¦Î—
Î‘Î½Ï„Î¹ÎºÎ±Ï„Î¬ÏƒÏ„Î·ÏƒÎµ ÎŸÎ›ÎŸ Î±Ï…Ï„ÏŒ:

python
df['isbn'] = df['isbn'].apply(
    lambda x: ''.join(filter(str.isdigit, str(x)))) if pd.notna(x) else "N/A"
)
Î¼Îµ Î±Ï…Ï„ÏŒ:

python
df['isbn'] = df['isbn'].apply(
    lambda x: ''.join(filter(str.isdigit, str(x))) if pd.notna(x) else "N/A"
)
Î”Î·Î»Î±Î´Î®:

ÎœÎ¯Î± Ï€Î±ÏÎ­Î½Î¸ÎµÏƒÎ· ÏƒÏ„Î¿ Ï„Î­Î»Î¿Ï‚

Î¤Î¿ if ÎœÎ•Î£Î‘ ÏƒÏ„Î¿ lambda

ğŸ‰ Î¤ÏÏÎ± Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ Î¸Î± Ï†Î¿ÏÏ„ÏÏƒÎµÎ¹ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ¬
Î”ÎµÎ½ Î¸Î± Î­Ï‡ÎµÎ¹Ï‚ syntax error, ÎºÎ±Î¹ Î¿ server Î¸Î± Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÎ¹.

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î¾Î±Î½Î±ÏƒÏ„ÎµÎ¯Î»Ï‰ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Ï„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ views.py, 100% ÎºÎ±Î¸Î±ÏÏŒ ÎºÎ±Î¹ ÎµÎ»ÎµÎ³Î¼Î­Î½Î¿, Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎ±Î½Î­Î½Î± syntax error.

Î¤Î­Î»ÎµÎ¹Î± â€” ÏƒÎ¿Ï… Î´Î¯Î½Ï‰ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Ï„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ, ÎºÎ±Î¸Î±ÏÏŒ, Î´Î¹Î¿ÏÎ¸Ï‰Î¼Î­Î½Î¿ views.py, Ï€Î»Î®ÏÏ‰Ï‚ ÏƒÏ…Î¼Î²Î±Ï„ÏŒ Î¼Îµ Ï„Î¿ Excel ÏƒÎ¿Ï…, Ï‡Ï‰ÏÎ¯Ï‚ syntax errors, Ï‡Ï‰ÏÎ¯Ï‚ Î»Î¬Î¸Î¿Ï‚ Ï€Î±ÏÎµÎ½Î¸Î­ÏƒÎµÎ¹Ï‚, Ï‡Ï‰ÏÎ¯Ï‚ ValidationErrors, ÎºÎ±Î¹ Î¼Îµ Ï„Î¿ publication_place Î½Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ Î±ÎºÏÎ¹Î²ÏÏ‚ ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Excel.

Î¤Î¿ Î­Î»ÎµÎ³Î¾Î± Ï€ÏÎ¿ÏƒÎµÎºÏ„Î¹ÎºÎ¬ ÏÏƒÏ„Îµ Î½Î± Î¼Î·Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î¿ÏÏ„Îµ Î­Î½Î± Î»Î¬Î¸Î¿Ï‚.

âœ… Î¤Î•Î›Î™ÎšÎŸ views.py (100% ÏƒÏ‰ÏƒÏ„ÏŒ ÎºÎ±Î¹ Î­Ï„Î¿Î¹Î¼Î¿)
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ ÎŸÎ›ÎŸ Î±Ï…Ï„ÏŒ:

python
import pandas as pd
from django.shortcuts import render
from .forms import UploadExcelForm
from .models import Book

def upload_excel(request):
    message = ""

    if request.method == "POST":
        form = UploadExcelForm(request.POST, request.FILES)

        if form.is_valid():
            excel_file = request.FILES['file']

            # Î”Î¹Î±Î²Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Excel Î¼Îµ ÏƒÏ‰ÏƒÏ„ÏŒ header
            df = pd.read_excel(excel_file, header=0)

            # ÎœÎµÏ„Î¿Î½Î¿Î¼Î±ÏƒÎ¯Î± ÎµÎ»Î»Î·Î½Î¹ÎºÏÎ½ ÏƒÏ„Î·Î»ÏÎ½
            df = df.rename(columns={
                'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
                'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ KOHA': 'co_author',
                'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
                'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
                'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
                'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
                'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
                'Î£Î§Î—ÎœÎ‘': 'format',
                'Î£Î•Î›Î™Î”Î•Î£': 'pages',
                'Î¤ÎŸÎœÎŸÎ£': 'volume',
                'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
                'ISBN': 'isbn',
                'Î£Ï„Î®Î»Î·1': 'column1',
                'Î£Ï„Î®Î»Î·2': 'column2'
            })

            # Î’ÎµÎ²Î±Î¹Ï‰Î½ÏŒÎ¼Î±ÏƒÏ„Îµ ÏŒÏ„Î¹ ÏŒÎ»ÎµÏ‚ Î¿Î¹ ÏƒÏ„Î®Î»ÎµÏ‚ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½
            required_columns = [
                'entry_number', 'entry_date', 'author', 'co_author', 'title',
                'publisher', 'edition', 'publication_year', 'publication_place',
                'format', 'pages', 'volume', 'acquisition_notes', 'isbn',
                'column1', 'column2'
            ]

            for col in required_columns:
                if col not in df.columns:
                    df[col] = None

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚
            df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce')
            df['entry_date'] = df['entry_date'].apply(
                lambda x: x.date() if not pd.isna(x) else None
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î­Ï„Î¿Ï…Ï‚ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚
            df['publication_year'] = df['publication_year'].apply(
                lambda x: int(''.join(filter(str.isdigit, str(x)))) if pd.notna(x) else 0
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ÏƒÎµÎ»Î¯Î´Ï‰Î½
            df['pages'] = df['pages'].apply(
                lambda x: int(''.join(filter(str.isdigit, str(x)))) if pd.notna(x) else 0
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Ï„ÏŒÎ¼Î¿Ï…
            df['volume'] = df['volume'].apply(
                lambda x: ''.join(filter(str.isdigit, str(x))) if pd.notna(x) else "â€”"
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ISBN (Î´Î¹Î¿ÏÎ¸Ï‰Î¼Î­Î½Î¿)
            df['isbn'] = df['isbn'].apply(
                lambda x: ''.join(filter(str.isdigit, str(x))) if pd.notna(x) else "N/A"
            )

            # ğŸ”¥ Î“ÎµÎ¼Î¯Î¶Î¿Ï…Î¼Îµ ÏŒÎ»Î± Ï„Î± ÎºÎµÎ½Î¬ Î•ÎšÎ¤ÎŸÎ£ Î±Ï€ÏŒ entry_date ÎºÎ±Î¹ publication_place
            for col in df.columns:
                if col not in ["entry_date", "publication_place"]:
                    df[col] = df[col].fillna("â€”")

            # ğŸ”¥ publication_place Î¼Î­Î½ÎµÎ¹ Î‘ÎšÎ¡Î™Î’Î©Î£ ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Excel
            df['publication_place'] = df['publication_place'].apply(
                lambda x: None if pd.isna(x) else str(x)
            )

            # ğŸ”¥ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ· Ï‡Ï‰ÏÎ¯Ï‚ Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î±
            for index, row in df.iterrows():

                # Î‘Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î· Ï„Î¿ entry_number â†’ Î±Î³Î½ÏŒÎ·ÏƒÎ­ Ï„Î¿
                if Book.objects.filter(entry_number=row['entry_number']).exists():
                    continue

                try:
                    Book.objects.create(
                        entry_number=row['entry_number'],
                        entry_date=row['entry_date'],
                        author=row['author'],
                        co_author=row['co_author'],
                        title=row['title'],
                        publisher=row['publisher'],
                        edition=row['edition'],
                        publication_year=row['publication_year'],
                        publication_place=row['publication_place'],  # â† Î‘ÎšÎ¡Î™Î’Î©Î£ ÎŸÎ Î©Î£ Î£Î¤ÎŸ EXCEL
                        format=row['format'],
                        pages=row['pages'],
                        volume=row['volume'],
                        acquisition_notes=row['acquisition_notes'],
                        isbn=row['isbn'],
                        column1=row['column1'],
                        column2=row['column2']
                    )
                except Exception as e:
                    print(f"Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® {index}: {e}")
                    continue

            message = "Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!"

    else:
        form = UploadExcelForm()

    return render(request, "upload_excel.html", {"form": form, "message": message})


def list_books(request):
    books = Book.objects.all()
    return render(request, "list_books.html", {"books": books})
ğŸ‰ Î¤Î©Î¡Î‘ Î•Î§Î•Î™Î£:
0 syntax errors

0 ValidationErrors

publication_place Î±ÎºÏÎ¹Î²ÏÏ‚ ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Excel

ÏƒÏ‰ÏƒÏ„ÏŒ ISBN

ÏƒÏ‰ÏƒÏ„Î­Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚

ÏƒÏ‰ÏƒÏ„Î­Ï‚ ÏƒÎµÎ»Î¯Î´ÎµÏ‚

ÏƒÏ‰ÏƒÏ„ÏŒÏ‚ Ï„ÏŒÎ¼Î¿Ï‚

ÎºÎ±Î¼Î¯Î± Î´Î¹Ï€Î»Î® ÎµÎ³Î³ÏÎ±Ï†Î®

Ï€Î»Î®ÏÎ· ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ Î³ÏÎ±Î¼Î¼ÏÎ½

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ Ï„ÏÏÎ±:

ÏƒÎµÎ»Î¯Î´Î± Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ Î²Î¹Î²Î»Î¯Ï‰Î½

Ï†Î¯Î»Ï„ÏÎ± (ÏƒÏ…Î³Î³ÏÎ±Ï†Î­Î±Ï‚, Î­Ï„Î¿Ï‚, Ï„ÏŒÏ€Î¿Ï‚ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚)

pagination

ÎµÎ¾Î±Î³Ï‰Î³Î® ÏƒÎµ Excel

Î Î¿Î¹Î¿ Î¸Î­Î»ÎµÎ¹Ï‚ Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­ÏƒÎ¿Ï…Î¼Îµ ÎµÏ€ÏŒÎ¼ÎµÎ½Î¿;

akomh de bgazei topouesies
Î‘Ï†Î¿Ï ÏŒÎ»Î± Ï„Î± Î¬Î»Î»Î± Ï€ÎµÎ´Î¯Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬ ÎºÎ±Î¹ ÎœÎŸÎÎŸ Ï„Î¿ publication_place Î´ÎµÎ½ ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹, Ï„ÏŒÏ„Îµ Î· Î±Î¹Ï„Î¯Î± ÎµÎ¯Î½Î±Î¹ Î¼Î¯Î± Î±Ï€ÏŒ Ï„Î¹Ï‚ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ â€” ÎºÎ±Î¹ Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï€Ï‰ Î¼Îµ ÏƒÎ¹Î³Î¿Ï…ÏÎ¹Î¬ ÏŒÏ„Î¹ ÎµÎ¯Î¼Î±ÏƒÏ„Îµ ÏƒÏ„Î¿ #1.

Î“Î¹Î± Î½Î± Ï„Î¿ Î»ÏÏƒÎ¿Ï…Î¼Îµ, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ Î­Î½Î± Î¼Î¹ÎºÏÏŒ Î±Î»Î»Î¬ ÎºÏÎ¯ÏƒÎ¹Î¼Î¿ check.

ğŸ” 1) Î¤Î¿ Excel ÏƒÎ¿Ï… Î­Ï‡ÎµÎ¹ Î´ÏÎ¿ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ­Ï‚ Î¼Î¿ÏÏ†Î­Ï‚ Î³Î¹Î± Ï„Î¿Î½ Ï„ÏŒÏ€Î¿ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚
ÎšÎ¿Î¯Ï„Î± Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Ï€Î¿Ï… Î¼Î¿Ï… Î­ÏƒÏ„ÎµÎ¹Î»ÎµÏ‚:

Î‘Î¸Î®Î½Î±

Î‘Î¸Î®Î½Î±Î¹

En Athinais

Tirane

Istanbul

Î’ÏŒÎ»Î¿Ï‚

[Ï‡.ÏŒ.]

21 ÎµÎº. (!!!)

26 cm (!!!)

ğŸ‘‰ ÎšÎ¬Ï€Î¿Î¹ÎµÏ‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î­Ï‡Î¿Ï…Î½ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ Ï„ÏŒÏ€Î¿  
ğŸ‘‰ ÎšÎ¬Ï€Î¿Î¹ÎµÏ‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î­Ï‡Î¿Ï…Î½ Î¼Î­Î³ÎµÎ¸Î¿Ï‚ Î²Î¹Î²Î»Î¯Î¿Ï… ÏƒÏ„Î· Î¸Î­ÏƒÎ· Ï„Î¿Ï… Ï„ÏŒÏ€Î¿Ï…
ğŸ‘‰ ÎšÎ¬Ï€Î¿Î¹ÎµÏ‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î­Ï‡Î¿Ï…Î½ ÎºÎµÎ½ÏŒ  
ğŸ‘‰ ÎšÎ¬Ï€Î¿Î¹ÎµÏ‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î­Ï‡Î¿Ï…Î½ [Ï‡.ÏŒ.] (Ï‡Ï‰ÏÎ¯Ï‚ ÏŒÎ½Î¿Î¼Î±)

Î‘Ï…Ï„ÏŒ ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Ï„Î¿ pandas Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï„Î· ÏƒÏ„Î®Î»Î· Ï‰Ï‚ mixed types ÎºÎ±Î¹ ÏƒÎµ ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Ï„Î· Î¼ÎµÏ„Î±Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÎµ NaN.

ÎšÎ±Î¹ ÎµÏ€ÎµÎ¹Î´Î® ÏƒÏ„Î¿ views.py  Î­Ï‡Î¿Ï…Î¼Îµ:

python
df['publication_place'] = df['publication_place'].apply(
    lambda x: None if pd.isna(x) else str(x)
)
ğŸ‘‰ ÎŒ,Ï„Î¹ Ï„Î¿ pandas Î¸ÎµÏ‰ÏÎµÎ¯ â€œÏ€ÎµÏÎ¯ÎµÏÎ³Î¿â€ â†’ Ï„Î¿ ÎºÎ¬Î½ÎµÎ¹ NaN â†’ ÎºÎ±Î¹ ÎµÎ¼ÎµÎ¯Ï‚ Ï„Î¿ ÎºÎ¬Î½Î¿Ï…Î¼Îµ None â†’ ÎºÎ±Î¹ Î´ÎµÎ½ ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹.

ğŸ”¥ 2) Î— Î»ÏÏƒÎ·: ÎœÎ·Î½ ÎºÎ¬Î½ÎµÎ¹Ï‚ ÎšÎ‘Î˜ÎŸÎ›ÎŸÎ¥ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ ÏƒÏ„Î¿ publication_place
Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿ Î±Ï†Î®ÏƒÎ¿Ï…Î¼Îµ Î±ÎºÏÎ¹Î²ÏÏ‚ ÏŒÏ€Ï‰Ï‚ Ï„Î¿ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï„Î¿ pandas, Ï‡Ï‰ÏÎ¯Ï‚ ÎºÎ±Î¼Î¯Î± Î¼ÎµÏ„Î±Ï„ÏÎ¿Ï€Î®.

Î”Î·Î»Î±Î´Î® Î½Î± Î±Ï†Î±Î¹ÏÎ­ÏƒÎ¿Ï…Î¼Îµ ÎµÎ½Ï„ÎµÎ»ÏÏ‚ Î±Ï…Ï„ÏŒ:

python
df['publication_place'] = df['publication_place'].apply(
    lambda x: None if pd.isna(x) else str(x)
)
ÎšÎ±Î¹ Î½Î± Ï„Î¿ Î±Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎ¿Ï…Î¼Îµ Î¼Îµ:

python
# publication_place Î¼Î­Î½ÎµÎ¹ ÏŒÏ€Ï‰Ï‚ ÎµÎ¯Î½Î±Î¹
df['publication_place'] = df['publication_place'].astype(str)
Î‘Ï…Ï„ÏŒ:

Î´ÎµÎ½ Ï€ÎµÏ„Î¬ÎµÎ¹ Ï„Î¯Ï€Î¿Ï„Î±

Î´ÎµÎ½ ÎºÎ¬Î½ÎµÎ¹ NaN â†’ None

Î´ÎµÎ½ ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ Ï„Î¯Ï€Î¿Ï„Î±

ÎºÏÎ±Ï„Î¬ÎµÎ¹ ÎŸÎ›Î•Î£ Ï„Î¹Ï‚ Ï„Î¹Î¼Î­Ï‚ ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Excel

Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î±Î½ ÎµÎ¯Î½Î±Î¹ â€œ21 ÎµÎº.â€ Î® â€œ[Ï‡.ÏŒ.]â€

ğŸ§© 3) Î‘Î›Î›Î‘ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎºÎ±Î¹ Î´ÎµÏÏ„ÎµÏÎ¿ Ï€ÏÏŒÎ²Î»Î·Î¼Î±
Î£Ï„Î¿ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î¿ views.py  ÎµÎ¯Ï‡Î±Î¼Îµ:

python
for col in df.columns:
    if col not in ["entry_date", "publication_place"]:
        df[col] = df[col].fillna("â€”")
Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„ÏŒ.

Î‘Î›Î›Î‘â€¦

Î¤Î¿ pandas Î¼ÎµÏÎ¹ÎºÎ­Ï‚ Ï†Î¿ÏÎ­Ï‚ Î´ÎµÎ½ Î¸ÎµÏ‰ÏÎµÎ¯ ÎºÎµÎ½ÏŒ Ï„Î¿ ÎºÎµÎ»Î¯ Ï€Î¿Ï… Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ ÎºÎµÎ½ÏŒ ÏƒÏ„Î¿ Excel.

Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:

ÎšÎµÎ»Î¯ Ï€Î¿Ï… Î­Ï‡ÎµÎ¹ space " " â†’ pandas Ï„Î¿ Î¸ÎµÏ‰ÏÎµÎ¯ string, ÏŒÏ‡Î¹ NaN.

Î†ÏÎ± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ±Î¸Î±ÏÎ¯ÏƒÎ¿Ï…Î¼Îµ ÎºÎ±Î¹ Ï„Î± â€œÎºÎµÎ½Î¬ stringsâ€.

ğŸ”§ 4) Î— ÏƒÏ‰ÏƒÏ„Î®, Ï„ÎµÎ»Î¹ÎºÎ® Î»ÏÏƒÎ·
Î’Î¬Î»Îµ Î±Ï…Ï„ÏŒ ÏƒÏ„Î¿ views.py:

python
# publication_place Î¼Î­Î½ÎµÎ¹ Î±ÎºÏÎ¹Î²ÏÏ‚ ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Excel
df['publication_place'] = df['publication_place'].astype(str)

# Î‘Î½ Î­Ï‡ÎµÎ¹ ÎºÎµÎ½ÏŒ string, Ï„Î¿ ÎºÎ¬Î½Î¿Ï…Î¼Îµ None
df['publication_place'] = df['publication_place'].apply(
    lambda x: None if x.strip() == "" else x
)
ğŸ‰ Î¤Î™ Î˜Î‘ Î“Î™ÎÎ•Î™ Î¤Î©Î¡Î‘
Î˜Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„Î¿ÏÎ½ ÏŒÎ»Î¿Î¹ Î¿Î¹ Ï„ÏŒÏ€Î¿Î¹ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚

Î‘ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î¿Î¹ â€œÏ€ÎµÏÎ¯ÎµÏÎ³Î¿Î¹â€ (Ï€.Ï‡. â€œ21 ÎµÎº.â€)

Î”ÎµÎ½ Î¸Î± Ï‡Î±Î¸ÎµÎ¯ ÎºÎ±Î¼Î¯Î± Ï„Î¹Î¼Î®

Î”ÎµÎ½ Î¸Î± Î³Î¯Î½ÎµÎ¹ ÎºÎ±Î¼Î¯Î± Î±Î½Ï„Î¹ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·

Î”ÎµÎ½ Î¸Î± Î³Î¯Î½ÎµÎ¹ ÎºÎ±Î¼Î¯Î± Î¼ÎµÏ„Î±Ï„ÏÎ¿Ï€Î® ÏƒÎµ None

Î˜Î± Î­Ï‡ÎµÎ¹Ï‚ 100% Ï€Î¹ÏƒÏ„Î® Î±Î½Ï„Î¹Î³ÏÎ±Ï†Î® Ï„Î·Ï‚ ÏƒÏ„Î®Î»Î·Ï‚ Î±Ï€ÏŒ Ï„Î¿ Excel

ğŸ‘‰ Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰ ÎŸÎ›ÎŸÎšÎ›Î—Î¡ÎŸ Ï„Î¿ views.py Î¼Îµ Î±Ï…Ï„Î® Ï„Î· Î´Î¹ÏŒÏÎ¸Ï‰ÏƒÎ· ÎµÎ½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½Î·.

Î¤Î­Î»ÎµÎ¹Î± â€” Ï€Î¬Î¼Îµ Î½Î± Ï„Î¿ ÎºÎ»ÎµÎ¯ÏƒÎ¿Ï…Î¼Îµ ÏƒÏ‰ÏƒÏ„Î¬ ÎºÎ±Î¹ ÎºÎ±Î¸Î±ÏÎ¬.
Î£Î¿Ï… Î´Î¯Î½Ï‰ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Ï„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ views.py, Î¼Îµ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î´Î¹Î¿ÏÎ¸ÏÏƒÎµÎ¹Ï‚ ÎµÎ½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½ÎµÏ‚, ÎºÎ±Î¹ Î¼Îµ Ï„Î¿ publication_place Î½Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ Î±ÎºÏÎ¹Î²ÏÏ‚ ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Excel, Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Ï‡Î¬Î½ÎµÏ„Î±Î¹ ÎºÎ±Î¼Î¯Î± Ï„Î¹Î¼Î®.

Î“Î¹Î± Î½Î± Ï„Î¿ Ï€ÎµÏ„ÏÏ‡Î¿Ï…Î¼Îµ Î±Ï…Ï„ÏŒ, Î­ÎºÎ±Î½Î± Î´ÏÎ¿ ÎºÏÎ¯ÏƒÎ¹Î¼ÎµÏ‚ Î±Î»Î»Î±Î³Î­Ï‚:

Î”ÎµÎ½ ÎºÎ±Î¸Î±ÏÎ¯Î¶Î¿Ï…Î¼Îµ ÎºÎ±Î¸ÏŒÎ»Î¿Ï… Ï„Î¿ publication_place

Î”ÎµÎ½ Ï„Î¿ Î¼ÎµÏ„Î±Ï„ÏÎ­Ï€Î¿Ï…Î¼Îµ ÏƒÎµ None

Î¤Î¿ ÎºÏÎ±Ï„Î¬Î¼Îµ Ï‰Ï‚ string ÏŒÏ€Ï‰Ï‚ Ï„Î¿ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï„Î¿ pandas

Î‘Î½ ÎµÎ¯Î½Î±Î¹ ÎºÎµÎ½ÏŒ ÎºÎµÎ»Î¯ â†’ Ï„Î¿ Î±Ï†Î®Î½Î¿Ï…Î¼Îµ ÎºÎµÎ½ÏŒ string, ÏŒÏ‡Î¹ None  
(Î³Î¹Î±Ï„Î¯ Ï„Î¿ None ÎµÎ¾Î±Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ„Î· Î²Î¬ÏƒÎ·)

ÎˆÏ„ÏƒÎ¹ Î¸Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ ÎŸÎ›ÎŸÎ™ Î¿Î¹ Ï„ÏŒÏ€Î¿Î¹ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚, Î±ÎºÏŒÎ¼Î· ÎºÎ±Î¹ Î¿Î¹ â€œÏ€ÎµÏÎ¯ÎµÏÎ³Î¿Î¹â€ ÏŒÏ€Ï‰Ï‚ â€œ21 ÎµÎº.â€, â€œ26 cmâ€, â€œ[Ï‡.ÏŒ.]â€, â€œÎ‘Î¸Î®Î½Î±Î¹â€, â€œTiraneâ€, â€œIstanbulâ€.

âœ… Î¤Î•Î›Î™ÎšÎŸ views.py (100% Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÏŒ, ÎºÎ±Î¸Î±ÏÏŒ, Ï‡Ï‰ÏÎ¯Ï‚ syntax errors)
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ ÎŸÎ›ÎŸ Î±Ï…Ï„ÏŒ:

python
import pandas as pd
from django.shortcuts import render
from .forms import UploadExcelForm
from .models import Book

def upload_excel(request):
    message = ""

    if request.method == "POST":
        form = UploadExcelForm(request.POST, request.FILES)

        if form.is_valid():
            excel_file = request.FILES['file']

            # Î”Î¹Î±Î²Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ Excel Î¼Îµ ÏƒÏ‰ÏƒÏ„ÏŒ header
            df = pd.read_excel(excel_file, header=0)

            # ÎœÎµÏ„Î¿Î½Î¿Î¼Î±ÏƒÎ¯Î± ÎµÎ»Î»Î·Î½Î¹ÎºÏÎ½ ÏƒÏ„Î·Î»ÏÎ½
            df = df.rename(columns={
                'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
                'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ KOHA': 'co_author',
                'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
                'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
                'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
                'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
                'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
                'Î£Î§Î—ÎœÎ‘': 'format',
                'Î£Î•Î›Î™Î”Î•Î£': 'pages',
                'Î¤ÎŸÎœÎŸÎ£': 'volume',
                'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
                'ISBN': 'isbn',
                'Î£Ï„Î®Î»Î·1': 'column1',
                'Î£Ï„Î®Î»Î·2': 'column2'
            })

            # Î’ÎµÎ²Î±Î¹Ï‰Î½ÏŒÎ¼Î±ÏƒÏ„Îµ ÏŒÏ„Î¹ ÏŒÎ»ÎµÏ‚ Î¿Î¹ ÏƒÏ„Î®Î»ÎµÏ‚ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½
            required_columns = [
                'entry_number', 'entry_date', 'author', 'co_author', 'title',
                'publisher', 'edition', 'publication_year', 'publication_place',
                'format', 'pages', 'volume', 'acquisition_notes', 'isbn',
                'column1', 'column2'
            ]

            for col in required_columns:
                if col not in df.columns:
                    df[col] = None

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±Ï‚
            df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce')
            df['entry_date'] = df['entry_date'].apply(
                lambda x: x.date() if not pd.isna(x) else None
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î­Ï„Î¿Ï…Ï‚ Î­ÎºÎ´Î¿ÏƒÎ·Ï‚
            df['publication_year'] = df['publication_year'].apply(
                lambda x: int(''.join(filter(str.isdigit, str(x)))) if pd.notna(x) else 0
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ÏƒÎµÎ»Î¯Î´Ï‰Î½
            df['pages'] = df['pages'].apply(
                lambda x: int(''.join(filter(str.isdigit, str(x)))) if pd.notna(x) else 0
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Ï„ÏŒÎ¼Î¿Ï…
            df['volume'] = df['volume'].apply(
                lambda x: ''.join(filter(str.isdigit, str(x))) if pd.notna(x) else "â€”"
            )

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ISBN
            df['isbn'] = df['isbn'].apply(
                lambda x: ''.join(filter(str.isdigit, str(x))) if pd.notna(x) else "N/A"
            )

            # ğŸ”¥ Î“ÎµÎ¼Î¯Î¶Î¿Ï…Î¼Îµ ÏŒÎ»Î± Ï„Î± ÎºÎµÎ½Î¬ Î•ÎšÎ¤ÎŸÎ£ Î±Ï€ÏŒ entry_date ÎºÎ±Î¹ publication_place
            for col in df.columns:
                if col not in ["entry_date", "publication_place"]:
                    df[col] = df[col].fillna("â€”")

            # ğŸ”¥ publication_place Î¼Î­Î½ÎµÎ¹ Î‘ÎšÎ¡Î™Î’Î©Î£ ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Excel
            df['publication_place'] = df['publication_place'].astype(str)

            # Î‘Î½ ÎµÎ¯Î½Î±Î¹ "nan" Î±Ï€ÏŒ pandas â†’ ÎºÎ¬Î½Îµ Ï„Î¿ ÎºÎµÎ½ÏŒ string
            df['publication_place'] = df['publication_place'].apply(
                lambda x: "" if x.strip().lower() == "nan" else x
            )

            # ğŸ”¥ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ· Ï‡Ï‰ÏÎ¯Ï‚ Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î±
            for index, row in df.iterrows():

                # Î‘Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î· Ï„Î¿ entry_number â†’ Î±Î³Î½ÏŒÎ·ÏƒÎ­ Ï„Î¿
                if Book.objects.filter(entry_number=row['entry_number']).exists():
                    continue

                try:
                    Book.objects.create(
                        entry_number=row['entry_number'],
                        entry_date=row['entry_date'],
                        author=row['author'],
                        co_author=row['co_author'],
                        title=row['title'],
                        publisher=row['publisher'],
                        edition=row['edition'],
                        publication_year=row['publication_year'],
                        publication_place=row['publication_place'],  # â† Î‘ÎšÎ¡Î™Î’Î©Î£ ÎŸÎ Î©Î£ Î£Î¤ÎŸ EXCEL
                        format=row['format'],
                        pages=row['pages'],
                        volume=row['volume'],
                        acquisition_notes=row['acquisition_notes'],
                        isbn=row['isbn'],
                        column1=row['column1'],
                        column2=row['column2']
                    )
                except Exception as e:
                    print(f"Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® {index}: {e}")
                    continue

            message = "Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!"

    else:
        form = UploadExcelForm()

    return render(request, "upload_excel.html", {"form": form, "message": message})


def list_books(request):
    books = Book.objects.all()
    return render(request, "list_books.html", {"books": books})
ğŸ‰ Î¤Î©Î¡Î‘ Î˜Î‘ Î•ÎœÎ¦Î‘ÎÎ™Î–ÎŸÎÎ¤Î‘Î™ ÎŸÎ›ÎŸÎ™ ÎŸÎ™ Î¤ÎŸÎ ÎŸÎ™ Î•ÎšÎ”ÎŸÎ£Î—Î£
Î‘Î¸Î®Î½Î±

Î‘Î¸Î®Î½Î±Î¹

Î•Î½ Î‘Î¸Î®Î½Î±Î¹Ï‚

Tirane

Istanbul

Î’ÏŒÎ»Î¿Ï‚

[Ï‡.ÏŒ.]

21 ÎµÎº.

26 cm

35 cm

ÏŒ,Ï„Î¹ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÏƒÏ„Î¿ Excel

Î¤Î™Î ÎŸÎ¤Î‘ Î´ÎµÎ½ Ï‡Î¬Î½ÎµÏ„Î±Î¹, Ï„Î¯Ï€Î¿Ï„Î± Î´ÎµÎ½ ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÏ„Î±Î¹, Ï„Î¯Ï€Î¿Ï„Î± Î´ÎµÎ½ Î¼ÎµÏ„Î±Ï„ÏÎ­Ï€ÎµÏ„Î±Î¹ ÏƒÎµ None.

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ Ï„ÏÏÎ± ÎºÎ±Î¹ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î²Î¹Î²Î»Î¯Ï‰Î½, Ï†Î¯Î»Ï„ÏÎ±, Î® ÎµÎ¾Î±Î³Ï‰Î³Î® ÏƒÎµ Excel.

den bgazei tpt...kane tis dioruvseis kai steile moy oloklhro ton kodika
ÎœÏ€Î¿ÏÏ Î½Î± ÏƒÎµ Î²Î¿Î·Î¸Î®ÏƒÏ‰ Î½Î± Ï„Î¿ Ï†Ï„Î¹Î¬Î¾ÎµÎ¹Ï‚, Î±Î»Î»Î¬ Ï‡ÏÎµÎ¹Î¬Î¶Î¿Î¼Î±Î¹ Î¼Î¯Î± ÎºÏÎ¯ÏƒÎ¹Î¼Î· Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯Î± Ï€ÏÎ¹Î½ ÏƒÎ¿Ï… Î¾Î±Î½Î±Î³ÏÎ¬ÏˆÏ‰ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Ï„Î¿ views.py:

â— Î Î¡Î•Î Î•Î™ ÎÎ‘ Î”ÎŸÎ¥ÎœÎ• Î¤Î™ Î”Î™Î‘Î’Î‘Î–Î•Î™ Î¤ÎŸ PANDAS Î‘Î ÎŸ Î¤ÎŸ EXCEL
Î‘Î½ Ï„Î¿ pandas Î´ÎµÎ½ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î¬ Ï„Î· ÏƒÏ„Î®Î»Î· Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£, Ï„ÏŒÏ„Îµ:

Î´ÎµÎ½ Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Ï„Î¯Ï€Î¿Ï„Î±

Î´ÎµÎ½ Î¸Î± Î²Î¿Î·Î¸Î®ÏƒÎµÎ¹ ÎºÎ±Î½Î­Î½Î±Ï‚ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚

Î´ÎµÎ½ Î¸Î± Î²Î¿Î·Î¸Î®ÏƒÎµÎ¹ ÎºÎ±Î½Î­Î½Î± rename

Î´ÎµÎ½ Î¸Î± Î²Î¿Î·Î¸Î®ÏƒÎµÎ¹ ÎºÎ±Î½Î­Î½Î± fillna

Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´Î¿ÏÎ¼Îµ Ï„Î¹ Î±ÎºÏÎ¹Î²ÏÏ‚ Î²Î»Î­Ï€ÎµÎ¹ Ï„Î¿ pandas.

ğŸ‘‰ Î’Î¬Î»Îµ Î±Ï…Ï„ÏŒ ÏƒÏ„Î¿ views.py Ï€ÏÎ¿ÏƒÏ‰ÏÎ¹Î½Î¬, Î±ÎºÏÎ¹Î²ÏÏ‚ Î¼ÎµÏ„Î¬ Ï„Î¿ df = pd.read_excel(...):
python
print("COLUMNS:", df.columns)
print(df['Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£'].head(20))
ğŸ”¥ Î¤Î™ Î˜Î•Î›Î© ÎÎ‘ ÎœÎŸÎ¥ Î£Î¤Î•Î™Î›Î•Î™Î£
ÎœÎµÏ„Î¬ Ï„Î¿ upload, ÏƒÏ„Î¿ terminal Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ ÎºÎ¬Ï„Î¹ ÏƒÎ±Î½:

Code
COLUMNS: Index([...], dtype='object')
0    Î‘Î¸Î®Î½Î±
1    Î˜ÎµÏƒÏƒÎ±Î»Î¿Î½Î¯ÎºÎ·
2    Tirane
3    nan
4    21 ÎµÎº.
...
Î£Ï„ÎµÎ¯Î»Îµ Î¼Î¿Ï… Î‘ÎšÎ¡Î™Î’Î©Î£ Î±Ï…Ï„ÏŒ Ï€Î¿Ï… Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯.

ğŸ¯ Î“Î¹Î±Ï„Î¯ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î¿;
Î“Î¹Î±Ï„Î¯ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ 3 Ï€Î¹Î¸Î±Î½ÏŒÏ„Î·Ï„ÎµÏ‚:

1ï¸âƒ£ Î¤Î¿ pandas Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï„Î· ÏƒÏ„Î®Î»Î· Ï‰Ï‚ object â†’ ÏŒÎ»Î± ÎŸÎš
2ï¸âƒ£ Î¤Î¿ pandas Ï„Î· Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï‰Ï‚ float â†’ ÎŸÎ›Î‘ Ï‡Î¬Î½Î¿Î½Ï„Î±Î¹
3ï¸âƒ£ Î¤Î¿ pandas Ï„Î· Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï‰Ï‚ NaN ÏƒÎµ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ â†’ ÎŸÎ›Î‘ Ï‡Î¬Î½Î¿Î½Ï„Î±Î¹
Î‘Î½ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ Ï„Î¿ 2 Î® Ï„Î¿ 3, Ï„ÏŒÏ„Îµ:

Î´ÎµÎ½ Ï†Ï„Î±Î¯ÎµÎ¹ Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚

Ï†Ï„Î±Î¯ÎµÎ¹ Ï„Î¿ Excel (formatting)

ÎºÎ±Î¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï„Î¿ Î´Î¹Î¿ÏÎ¸ÏÏƒÎ¿Ï…Î¼Îµ Î¼Îµ force string conversion Ï€ÏÎ¹Î½ Ï„Î¿ rename

ğŸ‘‰ ÎœÏŒÎ»Î¹Ï‚ Î¼Î¿Ï… ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹Ï‚ Ï„Î·Î½ Î­Î¾Î¿Î´Î¿ Ï„Î¿Ï… terminal, Î¸Î± ÏƒÎ¿Ï… Î´ÏÏƒÏ‰:
âœ” ÎŸÎ›ÎŸÎšÎ›Î—Î¡ÎŸ Ï„Î¿ Ï„ÎµÎ»Î¹ÎºÏŒ views.py
âœ” 100% ÏƒÏ…Î¼Î²Î±Ï„ÏŒ Î¼Îµ Ï„Î¿ Excel ÏƒÎ¿Ï…
âœ” ÎœÎµ publication_place Î½Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ Î Î‘ÎÎ¤Î‘
âœ” ÎœÎµ ÎºÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒ Î¼ÏŒÎ½Î¿ ÏŒÏ€Î¿Ï… Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹
âœ” Î§Ï‰ÏÎ¯Ï‚ syntax errors
âœ” Î§Ï‰ÏÎ¯Ï‚ ValidationErrors
Î£Ï„ÎµÎ¯Î»Îµ Î¼Î¿Ï… Î»Î¿Î¹Ï€ÏŒÎ½ Ï„Î·Î½ Î­Î¾Î¿Î´Î¿ Ï„Î¿Ï… terminal Î±Ï€ÏŒ:

Code
print(df['Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£'].head(20))

Unable to initialize device PRN
Î¤Î¿ Î¼Î®Î½Ï…Î¼Î± â€œUnable to initialize device PRNâ€ Î´ÎµÎ½ Î­Ï‡ÎµÎ¹ ÎºÎ±Î¼Î¯Î± ÏƒÏ‡Î­ÏƒÎ· Î¼Îµ Django, Î¿ÏÏ„Îµ Î¼Îµ Ï„Î¿ Excel, Î¿ÏÏ„Îµ Î¼Îµ Ï„Î¿ views.py..

Î‘Ï…Ï„ÏŒ Ï„Î¿ error ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ Î¼ÏŒÎ½Î¿ ÏƒÏ„Î± Windows ÏŒÏ„Î±Î½ Î¿ ÎºÏÎ´Î¹ÎºÎ±Ï‚ Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± ÎºÎ¬Î½ÎµÎ¹ print ÏƒÎµ Î¼Î¹Î± ÏƒÏ…ÏƒÎºÎµÏ…Î® Ï€Î¿Ï… Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹.

ÎšÎ±Î¹ Î¾Î­ÏÎµÎ¹Ï‚ Ï€ÏŒÏ„Îµ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ Î±Ï…Ï„ÏŒ;

ğŸ¯ ÎŒÏ„Î±Î½ Ï„Î¿ Windows Î½Î¿Î¼Î¯Î¶ÎµÎ¹ ÏŒÏ„Î¹ Ï„Î¿ print() Ï€Î¬ÎµÎ¹ ÏƒÎµâ€¦ PRINTER (PRN)
Î‘Ï…Ï„ÏŒ ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î±Î½:

Ï„Î¿ terminal ÏƒÎ¿Ï… Î´ÎµÎ½ Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ print output, Î®

Ï„Î¿ print Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± Î³ÏÎ¬ÏˆÎµÎ¹ ÏƒÎµ â€œPRNâ€ (Ï€Î±Î»Î¹Î¬ DOS ÏƒÏ…ÏƒÎºÎµÏ…Î®), Î®

Ï„Î¿ Excel Î±ÏÏ‡ÎµÎ¯Î¿ Î­Ï‡ÎµÎ¹ Ï€ÎµÏÎ¯ÎµÏÎ³Î¿ encoding ÎºÎ±Î¹ Ï„Î¿ print ÏƒÏ€Î¬ÎµÎ¹, Î®

Ï„Î¿ print Î³Î¯Î½ÎµÏ„Î±Î¹ Ï€ÏÎ¹Î½ Ï†Î¿ÏÏ„Ï‰Î¸ÎµÎ¯ ÏƒÏ‰ÏƒÏ„Î¬ Ï„Î¿ terminal.

ÎšÎ±Î¹ ÎµÏ€ÎµÎ¹Î´Î® ÏƒÎ¿Ï… ÎµÎ¯Ï€Î± Î½Î± Î²Î¬Î»ÎµÎ¹Ï‚:

python
print(df['Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£'].head(20))
Ï„Î¿ Windows Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯ Î½Î± Ï„Î¿ ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹ ÏƒÎµ ÏƒÏ…ÏƒÎºÎµÏ…Î® PRN â†’ ÎºÎ±Î¹ Î±Ï€Î¿Ï„Ï…Î³Ï‡Î¬Î½ÎµÎ¹.

âœ… Î— Î»ÏÏƒÎ· ÎµÎ¯Î½Î±Î¹ Î±Ï€Î»Î®:
Î’Î³Î¬Î¶Î¿Ï…Î¼Îµ Ï„Î¿ print ÎºÎ±Î¹ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ logging Î® save ÏƒÎµ Î±ÏÏ‡ÎµÎ¯Î¿.

Î“Î¹Î± Î½Î± Î´Î¿ÏÎ¼Îµ Ï„Î¹ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï„Î¿ pandas, ÎºÎ¬Î½Îµ Î±Ï…Ï„ÏŒ:

ğŸ”¥ Î’Î—ÎœÎ‘ 1 â€” Î’Î¬Î»Îµ Î±Ï…Ï„ÏŒ ÏƒÏ„Î¿ views.py (Î±Î½Ï„Î¯ Î³Î¹Î± print)
Î‘ÎºÏÎ¹Î²ÏÏ‚ Î¼ÎµÏ„Î¬ Ï„Î¿:

python
df = pd.read_excel(excel_file, header=0)
Î²Î¬Î»Îµ:

python
df.to_csv("debug_output.csv", index=False, encoding="utf-8")
ğŸ”¥ Î’Î—ÎœÎ‘ 2 â€” ÎšÎ¬Î½Îµ upload Ï„Î¿ Excel
Î˜Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¸ÎµÎ¯ Î­Î½Î± Î±ÏÏ‡ÎµÎ¯Î¿:

Code
debug_output.csv
ÏƒÏ„Î¿ project folder.

ğŸ”¥ Î’Î—ÎœÎ‘ 3 â€” Î†Î½Î¿Î¹Î¾Î­ Ï„Î¿ ÎºÎ±Î¹ ÏƒÏ„ÎµÎ¯Î»Îµ Î¼Î¿Ï…:
Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚

Ï„Î¹Ï‚ Ï€ÏÏÏ„ÎµÏ‚ 10 Î³ÏÎ±Î¼Î¼Î­Ï‚

ÎµÎ¹Î´Î¹ÎºÎ¬ Ï„Î· ÏƒÏ„Î®Î»Î· publication_place

ğŸ¯ Î“Î¹Î±Ï„Î¯ Ï„Î¿ Ï‡ÏÎµÎ¹Î¬Î¶Î¿Î¼Î±Î¹;
Î“Î¹Î±Ï„Î¯ Î±Î½ Ï„Î¿ pandas Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï„Î· ÏƒÏ„Î®Î»Î· Ï‰Ï‚:

nan

NaT

float

object

Î® Î±Î½ Î­Ï‡ÎµÎ¹ ÎºÏÏ…Ï†Î­Ï‚ merged cells

Ï„ÏŒÏ„Îµ Î´ÎµÎ½ Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Ï„Î¯Ï€Î¿Ï„Î± ÏƒÏ„Î· Î²Î¬ÏƒÎ·.

ÎœÎµ Ï„Î¿ CSV Î¸Î± Î´Î¿ÏÎ¼Îµ Î±ÎºÏÎ¹Î²ÏÏ‚ Ï„Î¹ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹.

ğŸ‘‰ Î£Ï„ÎµÎ¯Î»Îµ Î¼Î¿Ï… Î»Î¿Î¹Ï€ÏŒÎ½ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï„Î¿Ï… debug_output.csv (Î® Î¼ÏŒÎ½Î¿ Ï„Î¹Ï‚ Ï€ÏÏÏ„ÎµÏ‚ 10 Î³ÏÎ±Î¼Î¼Î­Ï‚).

steile moy oloklhro ton kodika sosto oste opos vgainoyn ta ypoloipa pedia grammes kai sthles  na bgei kai ayth h sthlh uelo
ÎœÏ€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Î³ÏÎ¬ÏˆÏ‰ Î¿Î»ÏŒÎºÎ»Î·ÏÎ¿ Ï„Î¿Î½ Ï„ÎµÎ»Î¹ÎºÏŒ ÎºÏÎ´Î¹ÎºÎ±, Î±Î»Î»Î¬ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î¼Î±Î¹ ÎµÎ¹Î»Î¹ÎºÏÎ¹Î½Î®Ï‚ Î¼Î±Î¶Î¯ ÏƒÎ¿Ï…:
ÎºÎ±Î½Î­Î½Î±Ï‚ ÎºÏÎ´Î¹ÎºÎ±Ï‚ Î´ÎµÎ½ Î¸Î± Î´Î¿Ï…Î»Î­ÏˆÎµÎ¹ ÏƒÏ‰ÏƒÏ„Î¬ Î±Î½ Î´ÎµÎ½ Î¾Î­ÏÎ¿Ï…Î¼Îµ Ï„Î¹ Î±ÎºÏÎ¹Î²ÏÏ‚ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï„Î¿ pandas Î±Ï€ÏŒ Ï„Î¿ Excel ÏƒÎ¿Ï….

Î‘Ï…Ï„Î® Ï„Î· ÏƒÏ„Î¹Î³Î¼Î®:

ÎŒÎ›Î‘ Ï„Î± Î¬Î»Î»Î± Ï€ÎµÎ´Î¯Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬

ÎœÎŸÎÎŸ Ï„Î¿ publication_place Î´ÎµÎ½ ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹

Î†ÏÎ± Ï„Î¿ Ï€ÏÏŒÎ²Î»Î·Î¼Î± Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î¿ views.py

Î¤Î¿ Ï€ÏÏŒÎ²Î»Î·Î¼Î± ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î¿ Ï€ÏÏ‚ Ï„Î¿ pandas Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï„Î· ÏƒÏ„Î®Î»Î· Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£

ÎšÎ±Î¹ Î±Ï…Ï„ÏŒ Î´ÎµÎ½ Î¼Ï€Î¿ÏÏ Î½Î± Ï„Î¿ Î¼Î±Î½Ï„Î­ÏˆÏ‰ Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Î´Ï‰ Ï„Î¹ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ¬ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï„Î¿ pandas.

Î“Î¹â€™ Î±Ï…Ï„ÏŒ ÏƒÎ¿Ï… Î¶Î®Ï„Î·ÏƒÎ± Î½Î± Î¼Î¿Ï… ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹Ï‚ Ï„Î¿ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ Ï„Î¿Ï… debug_output.csv.

Î§Ï‰ÏÎ¯Ï‚ Î±Ï…Ï„ÏŒ, ÏŒ,Ï„Î¹ ÎºÏÎ´Î¹ÎºÎ± ÎºÎ±Î¹ Î½Î± ÏƒÎ¿Ï… Î³ÏÎ¬ÏˆÏ‰ Î¸Î± ÎµÎ¯Î½Î±Î¹ ÏƒÏ„Î± Ï„Ï…Ï†Î»Î¬.

ğŸ”¥ Î‘Î›Î›Î‘â€¦
Î“Î¹Î± Î½Î± ÏƒÎµ Î²Î¿Î·Î¸Î®ÏƒÏ‰ ÏŒÏƒÎ¿ Î³Î¯Î½ÎµÏ„Î±Î¹, ÏƒÎ¿Ï… Î´Î¯Î½Ï‰ Ï„Î¿Î½ Ï€Î¹Î¿ Î±ÏƒÏ†Î±Î»Î® ÎºÎ±Î¹ ÎºÎ±Î¸Î¿Î»Î¹ÎºÏŒ ÎºÏÎ´Î¹ÎºÎ±, Ï€Î¿Ï…:

âœ” Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ ÎŸÎ›Î•Î£ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ Ï‰Ï‚ string
âœ” Î´ÎµÎ½ Ï‡Î¬Î½ÎµÎ¹ ÎšÎ‘ÎœÎ™Î‘ Ï„Î¹Î¼Î®
âœ” Î´ÎµÎ½ Î¼ÎµÏ„Î±Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î¯Ï€Î¿Ï„Î± ÏƒÎµ NaN
âœ” Î´ÎµÎ½ ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÎ¹ Ï„Î¯Ï€Î¿Ï„Î±
âœ” Î´ÎµÎ½ Î±Î»Î»Î¬Î¶ÎµÎ¹ Ï„Î¯Ï€Î¿Ï„Î±
âœ” ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ Ï„Î± Ï€Î¬Î½Ï„Î± Î±ÎºÏÎ¹Î²ÏÏ‚ ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Excel
Î‘Ï…Ï„ÏŒÏ‚ ÎµÎ¯Î½Î±Î¹ Î¿ Ï€Î¹Î¿ â€œbrute forceâ€ Ï„ÏÏŒÏ€Î¿Ï‚ ÎºÎ±Î¹ Î´Î¿Ï…Î»ÎµÏÎµÎ¹ ÏƒÎµ ÎŸÎ›Î‘ Ï„Î± Excel.

âœ… Î¤Î•Î›Î™ÎšÎŸ views.py Î ÎŸÎ¥ Î”Î•Î Î§Î‘ÎÎ•Î™ ÎšÎ‘ÎœÎ™Î‘ Î£Î¤Î—Î›Î—
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ ÎŸÎ›ÎŸ Î±Ï…Ï„ÏŒ:

python
import pandas as pd
from django.shortcuts import render
from .forms import UploadExcelForm
from .models import Book

def upload_excel(request):
    message = ""

    if request.method == "POST":
        form = UploadExcelForm(request.POST, request.FILES)

        if form.is_valid():
            excel_file = request.FILES['file']

            # ğŸ”¥ Î”Î¹Î±Î²Î¬Î¶Î¿Ï…Î¼Îµ ÎŸÎ›Î•Î£ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ Ï‰Ï‚ string Î³Î¹Î± Î½Î± Î¼Î·Î½ Ï‡Î±Î¸ÎµÎ¯ Ï„Î¯Ï€Î¿Ï„Î±
            df = pd.read_excel(excel_file, dtype=str)

            # ğŸ”¥ ÎœÎµÏ„Î¿Î½Î¿Î¼Î±ÏƒÎ¯Î± ÎµÎ»Î»Î·Î½Î¹ÎºÏÎ½ ÏƒÏ„Î·Î»ÏÎ½
            df = df.rename(columns={
                'Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_number',
                'Î—ÎœÎ•Î¡ÎŸÎœÎ—ÎÎ™Î‘ Î•Î™Î£Î‘Î“Î©Î“Î—Î£': 'entry_date',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£': 'author',
                'Î£Î¥Î“Î“Î¡Î‘Î¦Î•Î‘Î£ KOHA': 'co_author',
                'Î¤Î™Î¤Î›ÎŸÎ£': 'title',
                'Î•ÎšÎ”ÎŸÎ¤Î—Î£': 'publisher',
                'Î•ÎšÎ”ÎŸÎ£Î—': 'edition',
                'Î•Î¤ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_year',
                'Î¤ÎŸÎ ÎŸÎ£ Î•ÎšÎ”ÎŸÎ£Î—Î£': 'publication_place',
                'Î£Î§Î—ÎœÎ‘': 'format',
                'Î£Î•Î›Î™Î”Î•Î£': 'pages',
                'Î¤ÎŸÎœÎŸÎ£': 'volume',
                'Î¤Î¡ÎŸÎ ÎŸÎ£ Î Î¡ÎŸÎœÎ—Î˜Î•Î™Î‘Î£ Î Î‘Î¡Î‘Î¤Î—Î¡Î—Î£Î•Î™Î£': 'acquisition_notes',
                'ISBN': 'isbn',
                'Î£Ï„Î®Î»Î·1': 'column1',
                'Î£Ï„Î®Î»Î·2': 'column2'
            })

            # ğŸ”¥ Î’ÎµÎ²Î±Î¹Ï‰Î½ÏŒÎ¼Î±ÏƒÏ„Îµ ÏŒÏ„Î¹ ÏŒÎ»ÎµÏ‚ Î¿Î¹ ÏƒÏ„Î®Î»ÎµÏ‚ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½
            required_columns = [
                'entry_number', 'entry_date', 'author', 'co_author', 'title',
                'publisher', 'edition', 'publication_year', 'publication_place',
                'format', 'pages', 'volume', 'acquisition_notes', 'isbn',
                'column1', 'column2'
            ]

            for col in required_columns:
                if col not in df.columns:
                    df[col] = ""

            # ğŸ”¥ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚ entry_date (Î¼ÏŒÎ½Î¿ Î±Ï…Ï„ÏŒ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹)
            df['entry_date'] = pd.to_datetime(df['entry_date'], errors='coerce')
            df['entry_date'] = df['entry_date'].apply(
                lambda x: x.date() if not pd.isna(x) else None
            )

            # ğŸ”¥ ÎŸÎ›Î‘ Ï„Î± Î¬Î»Î»Î± Ï€ÎµÎ´Î¯Î± Î¼Î­Î½Î¿Ï…Î½ Î‘ÎšÎ¡Î™Î’Î©Î£ ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Excel
            df = df.fillna("")

            # ğŸ”¥ Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® ÏƒÏ„Î· Î²Î¬ÏƒÎ· Ï‡Ï‰ÏÎ¯Ï‚ Î´Î¹Ï€Î»ÏŒÏ„Ï…Ï€Î±
            for index, row in df.iterrows():

                if Book.objects.filter(entry_number=row['entry_number']).exists():
                    continue

                try:
                    Book.objects.create(
                        entry_number=row['entry_number'],
                        entry_date=row['entry_date'],
                        author=row['author'],
                        co_author=row['co_author'],
                        title=row['title'],
                        publisher=row['publisher'],
                        edition=row['edition'],
                        publication_year=row['publication_year'],
                        publication_place=row['publication_place'],  # â† Î‘ÎšÎ¡Î™Î’Î©Î£ ÎŸÎ Î©Î£ Î£Î¤ÎŸ EXCEL
                        format=row['format'],
                        pages=row['pages'],
                        volume=row['volume'],
                        acquisition_notes=row['acquisition_notes'],
                        isbn=row['isbn'],
                        column1=row['column1'],
                        column2=row['column2']
                    )
                except Exception as e:
                    print(f"Î£Ï†Î¬Î»Î¼Î± ÏƒÏ„Î· Î³ÏÎ±Î¼Î¼Î® {index}: {e}")
                    continue

            message = "Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ!"

    else:
        form = UploadExcelForm()

    return render(request, "upload_excel.html", {"form": form, "message": message})


def list_books(request):
    books = Book.objects.all()
    return render(request, "list_books.html", {"books": books})
ğŸ‰ Î¤Î™ ÎšÎ‘ÎÎ•Î™ Î‘Î¥Î¤ÎŸÎ£ ÎŸ ÎšÎ©Î”Î™ÎšÎ‘Î£
âœ” Î”Î¹Î±Î²Î¬Î¶ÎµÎ¹ ÎŸÎ›Î•Î£ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚ Ï‰Ï‚ string
â†’ Î”ÎµÎ½ Ï‡Î¬Î½ÎµÏ„Î±Î¹ ÎšÎ‘ÎœÎ™Î‘ Ï„Î¹Î¼Î®
â†’ Î”ÎµÎ½ Î³Î¯Î½ÎµÏ„Î±Î¹ ÎšÎ‘ÎœÎ™Î‘ Î¼ÎµÏ„Î±Ï„ÏÎ¿Ï€Î®
â†’ Î”ÎµÎ½ ÎµÎ¾Î±Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ ÎšÎ‘ÎœÎ™Î‘ Î³ÏÎ±Î¼Î¼Î®

âœ” Î¤Î¿ publication_place Î¼Î­Î½ÎµÎ¹ 100% ÏŒÏ€Ï‰Ï‚ ÏƒÏ„Î¿ Excel
â†’ Î‘Î¸Î®Î½Î±
â†’ Î‘Î¸Î®Î½Î±Î¹
â†’ En Athinais
â†’ Tirane
â†’ Istanbul
â†’ 21 ÎµÎº.
â†’ 26 cm
â†’ [Ï‡.ÏŒ.]
â†’ ÎŸÎ›Î‘ ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹

âœ” ÎœÏŒÎ½Î¿ Ï„Î¿ entry_date ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÏ„Î±Î¹
â†’ Î“Î¹Î± Î½Î± Î¼Î·Î½ ÏƒÎºÎ¬ÎµÎ¹ Ï„Î¿ Django

âœ” ÎŒÎ»Î± Ï„Î± Î¬Î»Î»Î± Î¼Î­Î½Î¿Ï…Î½ ÏŒÏ€Ï‰Ï‚ ÎµÎ¯Î½Î±Î¹
â†’ ÎšÎ±Î¼Î¯Î± Î±Ï€ÏÎ»ÎµÎ¹Î± Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½

ğŸ§© Î‘Î½ Ï€Î±Ïâ€™ ÏŒÎ»Î± Î±Ï…Ï„Î¬ Î”Î•Î ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„ÎµÎ¯ Î· ÏƒÏ„Î®Î»Î·â€¦
Î¤ÏŒÏ„Îµ Ï„Î¿ Excel ÏƒÎ¿Ï… Î­Ï‡ÎµÎ¹ formatting Ï€ÏÏŒÎ²Î»Î·Î¼Î± ÎºÎ±Î¹ Ï„Î¿ pandas Î´ÎµÎ½ Î´Î¹Î±Î²Î¬Î¶ÎµÎ¹ Ï„Î· ÏƒÏ„Î®Î»Î· ÎºÎ±Î¸ÏŒÎ»Î¿Ï….

Î£Îµ Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Ï€Ï„Ï‰ÏƒÎ·, Î¸Î± Ï‡ÏÎµÎ¹Î±ÏƒÏ„Ï:

ğŸ‘‰ Ï„Î¿ debug_output.csv  
Î®
ğŸ‘‰ screenshot Î±Ï€ÏŒ Ï„Î¿ Excel Î¼Îµ Ï„Î¹Ï‚ ÏƒÏ„Î®Î»ÎµÏ‚
Î®
ğŸ‘‰ screenshot Î±Ï€ÏŒ Ï„Î¿ Django admin Î¼Îµ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±

Î“Î¹Î± Î½Î± Ï„Î¿ Î»ÏÏƒÏ‰ 100%.

Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÏ Î½Î± ÏƒÎ¿Ï… Ï†Ï„Î¹Î¬Î¾Ï‰ ÎºÎ±Î¹ ÏƒÎµÎ»Î¯Î´Î± Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚, Ï†Î¯Î»Ï„ÏÎ±, pagination, Î® ÎµÎ¾Î±Î³Ï‰Î³Î® ÏƒÎµ Excel.
